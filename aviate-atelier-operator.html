<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aviate Atelier ‚Äî Operator Portal</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2">async function sendPilotRequest(){
  var dep  = (document.getElementById('prm-dep')?.value || '').trim().toUpperCase() || 'OPF';
  var arr  = (document.getElementById('prm-arr')?.value || '').trim().toUpperCase() || 'TEB';
  var date = document.getElementById('prm-date')?.value || new Date().toISOString().split('T')[0];
  var days = parseInt(document.getElementById('prm-days')?.value) || 1;
  var rate = parseFloat(document.getElementById('prm-rate')?.value) || 0;
  var name = _reqPilot ? _reqPilot.name : 'Pilot';

  closePilotModal();

  if (_opRecord && _reqPilot) {
    _sb.from('pilots').select('id').ilike('first_name', (_reqPilot.name || '').split(' ')[0]).limit(1)
      .then(function(res) {
        var pilotId = res.data && res.data.length > 0 ? res.data[0].id : null;
        if (pilotId) {
          _sb.from('pilot_requests').insert({
            operator_id: _opRecord.id,
            pilot_id: pilotId,
            dep_airport: dep,
            arr_airport: arr,
            departure_date: date,
            days: days,
            offered_rate: rate,
            status: 'pending',
            expires_at: new Date(Date.now() + 45000).toISOString()
          }).then(function(r) {
            if (r.error) console.warn('Pilot request:', r.error.message);
          });
        }
      });
  }

  if (typeof showToast === 'function') {
    showToast('success', 'üì°', 'Request Sent to ' + name, dep + ' ‚Üí ' + arr + ' ¬∑ $' + rate + '/day ¬∑ Pilot notified');
  }
  if (typeof logActivity === 'function') {
    logActivity('team', 'Pilot request sent to ' + name + ' ¬∑ ' + dep + ' ‚Üí ' + arr);
  }
}
</script>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;1,400;1,600&family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
:root {
  --navy: #0B1D3A; --navy2: #1A3460;
  --gold: #C8912A; --gold2: #E5A83C; --gold-lt: #FDF3E0;
  --green: #1A7A4A; --green2: #4FD080; --green-lt: #E6F5EE;
  --blue: #1D5FAB; --blue-lt: #EAF1FB;
  --red: #C0392B;
  --bg: #080D14; --bg2: #0D1117; --bg3: #161B22;
  --card: #161B22; --card2: #1C2333;
  --border: #21262D; --border2: #30363D;
  --text: #E6EDF3; --text2: #8B949E; --text3: #6E7681;
  --lt-bg: #F8FAFC; --lt-card: #FFFFFF;
  --lt-border: #E2E8F0; --lt-text: #1A202C; --lt-muted: #718096;
}
body { background: var(--bg); font-family: 'DM Sans', sans-serif; color: var(--text); min-height: 100vh; overflow-x: hidden; }

/* NAV */
.top-nav { height: 60px; background: rgba(13,17,23,0.97); backdrop-filter: blur(16px); border-bottom: 1px solid var(--border); display: flex; align-items: center; padding: 0 32px; gap: 16px; position: sticky; top: 0; z-index: 100; }
.nav-logo { font-family: 'Playfair Display', serif; font-size: 20px; font-weight: 600; color: var(--text); font-style: italic; letter-spacing: 0.01em; }
.nav-logo span { color: var(--gold2); font-style: normal; font-weight: 500; letter-spacing: 0.06em; margin-left: 4px; }
.nav-divider { width: 1px; height: 20px; background: var(--border2); }
.nav-section { font-size: 11px; font-weight: 600; letter-spacing: 0.12em; text-transform: uppercase; color: var(--text3); }
.nav-spacer { flex: 1; }
.nav-status { display: flex; align-items: center; gap: 8px; font-size: 11px; color: var(--text3); }
.nav-status-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--green2); animation: pulse 1.4s infinite; }
@keyframes pulse { 0%{box-shadow:0 0 0 0 rgba(79,208,128,.5)} 70%{box-shadow:0 0 0 6px rgba(79,208,128,0)} 100%{box-shadow:0 0 0 0 rgba(79,208,128,0)} }

/* VIEWS */
.view { display: none; }
.view.active { display: block; }

/* LANDING ‚Äî choose path */
.landing { min-height: calc(100vh - 60px); display: flex; align-items: center; justify-content: center; padding: 48px 24px; }
.landing-inner { max-width: 800px; width: 100%; text-align: center; }
.landing-eyebrow { font-size: 10px; font-weight: 700; letter-spacing: 0.2em; text-transform: uppercase; color: var(--gold2); margin-bottom: 16px; }
.landing-title { font-family: 'Playfair Display', serif; font-size: 48px; font-weight: 600; color: var(--text); line-height: 1.15; margin-bottom: 16px; }
.landing-title em { color: var(--gold2); font-style: italic; }
.landing-sub { font-size: 16px; color: var(--text2); line-height: 1.7; margin-bottom: 48px; max-width: 520px; margin-left: auto; margin-right: auto; }
.path-cards { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 32px; }
.path-card { background: var(--card); border: 1.5px solid var(--border); border-radius: 20px; padding: 32px; transition: all 0.25s; text-align: left; cursor: pointer; }
.path-card:hover { transform: translateY(-3px); }
.path-card.client-card:hover { border-color: rgba(88,166,255,0.4); box-shadow: 0 16px 48px rgba(88,166,255,0.1); }
.path-card.operator-card:hover { border-color: rgba(229,168,60,0.4); box-shadow: 0 16px 48px rgba(229,168,60,0.1); }
.path-icon { width: 52px; height: 52px; border-radius: 16px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; font-size: 24px; }
.path-icon.blue { background: rgba(88,166,255,0.12); border: 1px solid rgba(88,166,255,0.25); }
.path-icon.gold { background: rgba(229,168,60,0.12); border: 1px solid rgba(229,168,60,0.25); }
.path-title { font-family: 'Playfair Display', serif; font-size: 22px; font-weight: 600; color: var(--text); margin-bottom: 8px; }
.path-desc { font-size: 13px; color: var(--text2); line-height: 1.7; margin-bottom: 20px; }
.path-features { display: flex; flex-direction: column; gap: 6px; margin-bottom: 24px; }
.path-feature { font-size: 12px; color: var(--text3); display: flex; align-items: center; gap: 8px; }
.path-feature::before { content: '‚úì'; color: var(--green2); font-weight: 700; font-size: 11px; }
.path-btn { width: 100%; height: 48px; border-radius: 12px; border: none; font-family: 'DM Sans', sans-serif; font-size: 14px; font-weight: 700; cursor: pointer; transition: all 0.2s; position: relative; z-index: 2; }
.path-btn.blue-btn { background: #58A6FF; color: var(--bg); }
.path-btn.blue-btn:hover { background: #79B8FF; }
.path-btn.gold-btn { background: linear-gradient(135deg, var(--gold) 0%, var(--gold2) 100%); color: var(--bg); box-shadow: 0 8px 24px rgba(201,168,76,0.25); }
.path-btn.gold-btn:hover { transform: translateY(-1px); }
.landing-signin { font-size: 13px; color: var(--text3); }
.landing-signin a { color: var(--gold2); text-decoration: none; cursor: pointer; }

/* ONBOARDING */
.onboard-wrap { max-width: 680px; margin: 0 auto; padding: 48px 24px 80px; }
.stepper { display: flex; align-items: center; margin-bottom: 48px; position: relative; }
.stepper::before { content: ''; position: absolute; top: 18px; left: 18px; right: 18px; height: 2px; background: var(--border); z-index: 0; }
.step-item { display: flex; flex-direction: column; align-items: center; flex: 1; position: relative; z-index: 1; cursor: pointer; }
.step-circle { width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 700; margin-bottom: 6px; transition: all 0.3s; border: 2px solid var(--border); background: var(--bg2); color: var(--text3); font-family: 'DM Mono', monospace; }
.step-item.done .step-circle { background: var(--green); border-color: var(--green); color: white; }
.step-item.active .step-circle { background: var(--gold2); border-color: var(--gold2); color: var(--bg); box-shadow: 0 0 0 4px rgba(229,168,60,0.15); }
.step-label { font-size: 9px; font-weight: 600; letter-spacing: 0.1em; text-transform: uppercase; color: var(--text3); text-align: center; white-space: nowrap; }
.step-item.active .step-label { color: var(--gold2); }
.step-item.done .step-label { color: var(--green2); }
.ob-step { display: none; animation: stepIn 0.3s ease; }
.ob-step.active { display: block; }
@keyframes stepIn { from{opacity:0;transform:translateX(20px)} to{opacity:1;transform:none} }
.ob-eyebrow { font-size: 10px; font-weight: 700; letter-spacing: 0.18em; text-transform: uppercase; color: var(--gold2); margin-bottom: 8px; }
.ob-title { font-family: 'Playfair Display', serif; font-size: 32px; font-weight: 600; color: var(--text); margin-bottom: 8px; line-height: 1.2; }
.ob-sub { font-size: 14px; color: var(--text2); line-height: 1.7; margin-bottom: 32px; max-width: 560px; }

/* FORM */
.field-group { margin-bottom: 20px; }
.field-label { font-size: 11px; font-weight: 600; letter-spacing: 0.1em; text-transform: uppercase; color: var(--text2); margin-bottom: 0; min-height: 30px; display: flex; align-items: flex-end; padding-bottom: 6px; line-height: 1.3; gap: 8px; }
.field-required { font-size: 9px; background: rgba(201,168,76,0.15); color: var(--gold2); padding: 2px 7px; border-radius: 5px; font-weight: 700; }
.field-input { width: 100%; height: 52px; background: var(--card); border: 1.5px solid var(--border); border-radius: 12px; padding: 0 16px; font-family: 'DM Sans', sans-serif; font-size: 15px; color: var(--text); outline: none; transition: all 0.2s; }
.field-input:focus { border-color: var(--gold2); box-shadow: 0 0 0 3px rgba(229,168,60,0.1); }
.field-input::placeholder { color: var(--text3); }
.field-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
.field-row-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 14px; }
.field-select { width: 100%; height: 52px; background: var(--card); border: 1.5px solid var(--border); border-radius: 12px; padding: 0 16px; font-family: 'DM Sans', sans-serif; font-size: 15px; color: var(--text); outline: none; appearance: none; transition: all 0.2s; cursor: pointer; }
.field-select:focus { border-color: var(--gold2); }
.field-hint { font-size: 11px; color: var(--text3); margin-top: 6px; line-height: 1.5; }
.field-error { font-size: 11px; color: #FF6B6B; margin-top: 6px; display: none; }
.field-error.show { display: block; }

/* UPLOAD */
.upload-zone { background: var(--card); border: 2px dashed var(--border2); border-radius: 14px; padding: 24px; text-align: center; cursor: pointer; transition: all 0.2s; margin-bottom: 12px; }
.upload-zone:hover { border-color: var(--gold2); background: rgba(229,168,60,0.04); }
.upload-zone.done { border-color: var(--green2); border-style: solid; background: rgba(79,208,128,0.05); }
.upload-icon { font-size: 28px; margin-bottom: 8px; }
.upload-title { font-size: 13px; font-weight: 600; color: var(--text); margin-bottom: 4px; }
.upload-sub { font-size: 11px; color: var(--text3); }
.upload-done-badge { display: inline-flex; align-items: center; gap: 6px; background: rgba(79,208,128,0.15); color: var(--green2); font-size: 11px; font-weight: 700; padding: 4px 12px; border-radius: 20px; margin-top: 8px; }

/* CERT CARDS */
.cert-required-card { background: rgba(229,168,60,0.06); border: 1px solid rgba(229,168,60,0.2); border-radius: 14px; padding: 16px; margin-bottom: 14px; }
.cert-req-title { font-size: 13px; font-weight: 700; color: var(--gold2); margin-bottom: 4px; display: flex; align-items: center; gap: 8px; }
.cert-req-desc { font-size: 12px; color: var(--text2); line-height: 1.6; }
.cert-req-badge { display: inline-block; font-size: 9px; font-weight: 800; letter-spacing: 0.1em; text-transform: uppercase; padding: 3px 9px; border-radius: 6px; margin-top: 8px; }
.cert-req-badge.required { background: rgba(201,168,76,0.2); color: var(--gold2); }
.cert-req-badge.optional { background: rgba(88,166,255,0.15); color: #58A6FF; }

/* ROLE CARDS */
.role-cards { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px; }
.role-card { background: var(--card); border: 2px solid var(--border); border-radius: 16px; padding: 20px; cursor: pointer; transition: all 0.2s; position: relative; }
.role-card:hover { border-color: var(--border2); }
.role-card.selected { border-color: var(--gold2); background: rgba(229,168,60,0.05); }
.role-card.selected::after { content: '‚úì'; position: absolute; top: 12px; right: 14px; width: 22px; height: 22px; background: var(--gold2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 800; color: var(--bg); }
.role-icon { font-size: 28px; margin-bottom: 10px; }
.role-name { font-size: 15px; font-weight: 700; color: var(--text); margin-bottom: 4px; }
.role-desc { font-size: 12px; color: var(--text3); line-height: 1.5; }

/* OSA */
.osa-scroll { background: var(--lt-bg); border: 1px solid var(--border); border-radius: 16px; height: 400px; overflow-y: auto; padding: 32px; margin-bottom: 20px; scrollbar-width: thin; scrollbar-color: var(--border2) transparent; }
.osa-scroll::-webkit-scrollbar { width: 5px; }
.osa-scroll::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 3px; }
.osa-header { text-align: center; margin-bottom: 28px; padding-bottom: 20px; border-bottom: 2px solid var(--lt-border); }
.osa-logo-text { font-family: 'Playfair Display', serif; font-size: 22px; font-weight: 700; color: var(--navy); font-style: italic; }
.osa-logo-text span { color: var(--gold); font-style: normal; }
.osa-doc-title { font-size: 14px; font-weight: 700; color: var(--lt-text); margin-top: 8px; letter-spacing: 0.04em; text-transform: uppercase; }
.osa-doc-sub { font-size: 11px; color: var(--lt-muted); margin-top: 4px; }
.osa-body { color: var(--lt-text); }
.osa-section { margin-bottom: 22px; }
.osa-section-title { font-size: 11px; font-weight: 800; letter-spacing: 0.16em; text-transform: uppercase; color: var(--navy); margin-bottom: 8px; padding-bottom: 6px; border-bottom: 1.5px solid var(--lt-border); }
.osa-body p { font-size: 12px; line-height: 1.8; color: #374151; margin-bottom: 8px; }
.osa-body strong { color: var(--lt-text); }
.osa-highlight { background: rgba(79,208,128,0.06); border-left: 3px solid var(--green); border-radius: 0 8px 8px 0; padding: 12px 14px; margin: 12px 0; font-size: 12px; color: #374151; line-height: 1.7; }
.osa-warning { background: rgba(201,168,76,0.08); border-left: 3px solid var(--gold); border-radius: 0 8px 8px 0; padding: 12px 14px; margin: 12px 0; font-size: 12px; color: #374151; line-height: 1.7; }
.schedule-a { background: white; border: 1.5px solid var(--lt-border); border-radius: 10px; overflow: hidden; margin: 12px 0; }
.schedule-a-header { background: var(--navy); padding: 10px 16px; font-size: 11px; font-weight: 700; letter-spacing: 0.12em; text-transform: uppercase; color: rgba(255,255,255,0.8); }
.schedule-row { display: grid; grid-template-columns: 2fr 1fr 1fr 2fr; padding: 10px 16px; border-bottom: 1px solid var(--lt-border); font-size: 11px; align-items: center; }
.schedule-row:last-child { border-bottom: none; }
.schedule-row.head { background: #F8FAFC; font-weight: 700; font-size: 10px; letter-spacing: 0.08em; text-transform: uppercase; color: var(--lt-muted); }
.schedule-row.beta-row { background: rgba(79,208,128,0.05); }
.s-rate { font-weight: 800; }
.s-rate.free { color: var(--green); }
.s-rate.low { color: #D97706; }
.s-rate.mid { color: var(--blue); }
.s-rate.full { color: var(--navy); }

/* CHECKBOXES */
.ob-checkbox { display: flex; gap: 12px; align-items: flex-start; margin-bottom: 12px; cursor: pointer; }
.ob-check { width: 22px; height: 22px; border-radius: 6px; flex-shrink: 0; background: var(--bg3); border: 2px solid var(--border); transition: all .2s; display: flex; align-items: center; justify-content: center; margin-top: 1px; }
.ob-check.checked { background: var(--gold2); border-color: var(--gold2); }
.ob-check-label { font-size: 13px; color: var(--text2); line-height: 1.6; }
.ob-check-label a { color: var(--gold2); text-decoration: none; }
.scroll-prompt { font-size: 11px; color: #D97706; font-weight: 600; display: flex; align-items: center; gap: 6px; margin-bottom: 12px; }

/* SIGNATURE */
.sig-section { background: var(--card); border: 1.5px solid var(--border); border-radius: 16px; padding: 24px; margin-bottom: 20px; }
.sig-input { width: 100%; height: 60px; background: var(--bg3); border: 2px solid var(--border); border-radius: 12px; padding: 0 20px; font-family: 'Playfair Display', serif; font-size: 22px; font-style: italic; color: var(--text); outline: none; transition: all 0.2s; }
.sig-input:focus { border-color: var(--gold2); box-shadow: 0 0 0 3px rgba(229,168,60,0.1); }
.sig-line { height: 1px; background: var(--border2); margin: 4px 20px 0; }
.sig-name-label { font-size: 10px; color: var(--text3); margin-top: 4px; padding: 0 20px; }

/* BUTTONS */
.ob-btn { height: 56px; border-radius: 14px; font-family: 'DM Sans', sans-serif; font-size: 15px; font-weight: 700; cursor: pointer; border: none; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 10px; width: 100%; }
.ob-btn.primary { background: linear-gradient(135deg, var(--gold) 0%, var(--gold2) 100%); color: var(--bg); box-shadow: 0 8px 24px rgba(201,168,76,0.25); }
.ob-btn.primary:hover { transform: translateY(-1px); box-shadow: 0 12px 32px rgba(201,168,76,0.3); }
.ob-btn.primary:disabled { opacity: 0.4; pointer-events: none; }
.ob-btn.ghost { background: var(--card2); color: var(--text2); border: 1px solid var(--border); }
.ob-btn.ghost:hover { color: var(--text); border-color: var(--border2); }
.ob-btn-row { display: grid; grid-template-columns: 1fr 2fr; gap: 12px; margin-top: 24px; }
.ob-btn.loading { opacity: 0.7; pointer-events: none; }

/* SUCCESS */
.success-screen { text-align: center; padding: 48px 24px; }
.success-glow { width: 100px; height: 100px; border-radius: 50%; background: rgba(79,208,128,0.12); border: 1px solid rgba(79,208,128,0.3); display: flex; align-items: center; justify-content: center; margin: 0 auto 24px; box-shadow: 0 0 60px rgba(79,208,128,0.15); animation: successPop .5s cubic-bezier(0.34,1.6,0.64,1); }
@keyframes successPop { from{opacity:0;transform:scale(0.5)} to{opacity:1;transform:scale(1)} }

/* DASHBOARD */
.dashboard-wrap { display: grid; grid-template-columns: 220px 1fr; min-height: calc(100vh - 60px); }
.sidebar { background: var(--bg2); border-right: 1px solid var(--border); padding: 20px 0; position: sticky; top: 60px; height: calc(100vh - 60px); overflow-y: auto; }
.sidebar-company { padding: 0 18px 16px; border-bottom: 1px solid var(--border); margin-bottom: 12px; }
.sidebar-company-name { font-size: 14px; font-weight: 700; color: var(--text); }
.sidebar-cert { display: inline-flex; align-items: center; gap: 5px; background: rgba(107,79,187,0.12); border: 1px solid rgba(107,79,187,0.25); color: #9B7EFF; font-size: 9px; font-weight: 800; letter-spacing: .08em; padding: 3px 8px; border-radius: 6px; margin-top: 6px; }
.sidebar-role { display: inline-flex; align-items: center; gap: 5px; background: rgba(88,166,255,0.1); border: 1px solid rgba(88,166,255,0.2); color: #58A6FF; font-size: 9px; font-weight: 700; padding: 3px 8px; border-radius: 6px; margin-top: 4px; margin-left: 4px; }
.sidebar-nav { padding: 0 10px; }
.sidebar-group-label { font-size: 9px; font-weight: 700; letter-spacing: .16em; text-transform: uppercase; color: var(--text3); padding: 14px 8px 6px; }
.sidebar-item { display: flex; align-items: center; gap: 10px; padding: 9px 12px; border-radius: 9px; cursor: pointer; font-size: 13px; color: var(--text2); font-weight: 500; transition: all .15s; margin-bottom: 2px; }
.sidebar-item:hover { background: var(--card); color: var(--text); }
.sidebar-item.active { background: rgba(229,168,60,0.1); color: var(--gold2); }
.sidebar-item svg { width: 16px; height: 16px; opacity: .7; flex-shrink: 0; }
.sidebar-item.active svg { opacity: 1; }
.sidebar-badge { margin-left: auto; background: var(--red); color: white; font-size: 9px; font-weight: 800; padding: 2px 6px; border-radius: 8px; }
.sidebar-badge.gold { background: rgba(229,168,60,0.2); color: var(--gold2); }
.main-content { padding: 28px; overflow-y: auto; }
.page-title { font-family: 'Playfair Display', serif; font-size: 26px; font-weight: 600; color: var(--text); margin-bottom: 4px; }
.page-sub { font-size: 13px; color: var(--text2); margin-bottom: 24px; }
.stats-grid { display: grid; grid-template-columns: repeat(4,1fr); gap: 14px; margin-bottom: 24px; }
.stat-card { background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 18px; }
.stat-label { font-size: 10px; font-weight: 700; letter-spacing: .12em; text-transform: uppercase; color: var(--text3); margin-bottom: 8px; }
.stat-value { font-family: 'Playfair Display', serif; font-size: 28px; font-weight: 600; color: var(--text); line-height: 1; }
.stat-value.green { color: var(--green2); }
.stat-value.gold { color: var(--gold2); }
.stat-value.blue { color: #58A6FF; }
.stat-sub { font-size: 11px; color: var(--text3); margin-top: 5px; }
.section-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 14px; }
.section-title { font-size: 13px; font-weight: 700; color: var(--text); }
.section-action { font-size: 12px; color: var(--gold2); cursor: pointer; font-weight: 600; }
.req-card { background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 18px; margin-bottom: 12px; transition: border-color .2s; }
.req-card.new-req { border-color: rgba(88,166,255,0.4); box-shadow: 0 0 0 1px rgba(88,166,255,0.1); }
.req-top { display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 12px; }
.req-route { font-family: 'Playfair Display', serif; font-size: 24px; font-weight: 600; color: var(--text); }
.req-meta { font-size: 11px; color: var(--text3); margin-top: 2px; }
.req-badge { font-size: 9px; font-weight: 800; letter-spacing: .1em; text-transform: uppercase; padding: 4px 10px; border-radius: 8px; display: flex; align-items: center; gap: 5px; }
.req-badge.new-b { background: rgba(88,166,255,0.1); border: 1px solid rgba(88,166,255,0.3); color: #58A6FF; }
.req-badge.quoted-b { background: rgba(79,208,128,0.1); border: 1px solid rgba(79,208,128,0.3); color: var(--green2); }
.req-details { display: grid; grid-template-columns: repeat(4,1fr); gap: 12px; margin-bottom: 14px; }
.req-detail-label { font-size: 9px; font-weight: 700; letter-spacing: .1em; text-transform: uppercase; color: var(--text3); margin-bottom: 3px; }
.req-detail-value { font-size: 13px; color: var(--text); font-weight: 600; }
.req-actions { display: flex; gap: 8px; }
.req-btn { flex: 1; height: 40px; border-radius: 10px; font-family: 'DM Sans', sans-serif; font-size: 12px; font-weight: 700; cursor: pointer; border: none; transition: all .2s; display: flex; align-items: center; justify-content: center; gap: 6px; }
.req-btn.quote-btn { background: #58A6FF; color: var(--bg); }
.req-btn.quote-btn:hover { background: #79B8FF; }
.req-btn.decline-btn { background: var(--border); color: var(--text3); }
.payout-clean { background: rgba(79,208,128,0.06); border: 1px solid rgba(79,208,128,0.2); border-radius: 12px; padding: 14px 16px; margin-top: 10px; }
.payout-row { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
.payout-row:last-child { border-bottom: none; }
.payout-label { font-size: 11px; color: var(--text3); }
.payout-value { font-size: 13px; font-weight: 700; color: var(--text); }
.payout-value.green { color: var(--green2); font-size: 17px; }
.empty-state { text-align: center; padding: 48px 32px; }
.empty-icon { width: 64px; height: 64px; border-radius: 18px; background: var(--card2); border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; margin: 0 auto 16px; }
.empty-title { font-size: 16px; font-weight: 700; color: var(--text); margin-bottom: 6px; }
.empty-sub { font-size: 13px; color: var(--text3); line-height: 1.6; max-width: 280px; margin: 0 auto; }

/* MODAL */
.modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.75); backdrop-filter: blur(6px); z-index: 500; display: none; align-items: center; justify-content: center; }
.modal-overlay.show { display: flex; }
.modal { background: var(--card2); border: 1px solid var(--border2); border-radius: 20px; padding: 28px; width: 480px; max-width: 95vw; box-shadow: 0 32px 80px rgba(0,0,0,0.6); animation: modalIn .25s cubic-bezier(0.34,1.3,.64,1); }
@keyframes modalIn { from{opacity:0;transform:scale(.93)} to{opacity:1;transform:scale(1)} }
.modal-title { font-family: 'Playfair Display', serif; font-size: 22px; font-weight: 600; color: var(--text); margin-bottom: 4px; }
.modal-sub { font-size: 12px; color: var(--text3); margin-bottom: 22px; }
.modal-label { font-size: 10px; font-weight: 700; letter-spacing: .14em; text-transform: uppercase; color: var(--text3); margin-bottom: 7px; }
.modal-input { width: 100%; height: 54px; background: var(--bg2); border: 2px solid var(--border); border-radius: 12px; padding: 0 18px; font-family: 'DM Mono', monospace; font-size: 22px; font-weight: 500; color: var(--text); outline: none; margin-bottom: 16px; transition: all .2s; }
.modal-input:focus { border-color: var(--gold2); }
.modal-row-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px; }
.modal-select { width: 100%; height: 46px; background: var(--bg2); border: 2px solid var(--border); border-radius: 12px; padding: 0 14px; font-family: 'DM Sans', sans-serif; font-size: 13px; color: var(--text); outline: none; appearance: none; }
.settlement-preview { background: rgba(79,208,128,0.07); border: 1px solid rgba(79,208,128,0.2); border-radius: 12px; padding: 14px 16px; margin-bottom: 18px; }
.sp-row { display: flex; justify-content: space-between; font-size: 12px; padding: 5px 0; }
.sp-label { color: var(--text3); }
.sp-value { color: var(--text); font-weight: 700; }
.sp-row.total .sp-label { color: var(--green2); font-weight: 700; font-size: 13px; }
.sp-row.total .sp-value { font-family: 'Playfair Display', serif; font-size: 20px; color: var(--green2); }
.sp-note { font-size: 10px; color: var(--text3); margin-top: 8px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.05); line-height: 1.5; }
.modal-btns { display: flex; gap: 10px; }
.modal-cancel { flex: 1; height: 48px; background: var(--border); color: var(--text3); border: none; border-radius: 12px; font-family: 'DM Sans', sans-serif; font-size: 13px; font-weight: 700; cursor: pointer; }
.modal-submit { flex: 2; height: 48px; background: #58A6FF; color: var(--bg); border: none; border-radius: 12px; font-family: 'DM Sans', sans-serif; font-size: 14px; font-weight: 800; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; transition: background .2s; }
.modal-submit:hover { background: #79B8FF; }
.modal-submit.loading { opacity: 0.7; pointer-events: none; }

/* TOAST */
.toast { position: fixed; bottom: 28px; right: 28px; z-index: 2000; background: var(--card2); border: 1px solid var(--border2); border-radius: 14px; padding: 14px 18px; box-shadow: 0 8px 32px rgba(0,0,0,0.5); display: flex; align-items: flex-start; gap: 12px; min-width: 280px; max-width: 360px; transform: translateY(120%); transition: transform .35s cubic-bezier(0.34,1.3,.64,1); }
.toast.show { transform: translateY(0); }
.toast.success { border-color: rgba(79,208,128,0.4); }
.toast.error { border-color: rgba(192,57,43,0.4); }
.toast-icon-wrap { width: 36px; height: 36px; border-radius: 10px; background: rgba(79,208,128,0.1); display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
.toast-icon-wrap.error { background: rgba(192,57,43,0.1); }
.toast-title { font-size: 13px; font-weight: 700; color: var(--text); margin-bottom: 3px; }
.toast-sub { font-size: 11px; color: var(--text3); line-height: 1.4; }

/* LOGIN */
.login-wrap { min-height: calc(100vh - 60px); display: flex; align-items: center; justify-content: center; padding: 48px 24px; }
.login-card { background: var(--card); border: 1px solid var(--border); border-radius: 24px; padding: 40px; width: 100%; max-width: 420px; }
.login-title { font-family: 'Playfair Display', serif; font-size: 28px; font-weight: 600; color: var(--text); margin-bottom: 6px; }
.login-sub { font-size: 13px; color: var(--text2); margin-bottom: 28px; line-height: 1.6; }
.login-divider { display: flex; align-items: center; gap: 12px; margin: 20px 0; }
.login-divider::before, .login-divider::after { content: ''; flex: 1; height: 1px; background: var(--border); }
.login-divider span { font-size: 11px; color: var(--text3); font-weight: 600; }
.login-footer { font-size: 12px; color: var(--text3); text-align: center; margin-top: 20px; }
.login-footer a { color: var(--gold2); text-decoration: none; cursor: pointer; }

@media (max-width: 900px) {
  .dashboard-wrap { grid-template-columns: 1fr; }
  .sidebar { display: none; }
  .stats-grid { grid-template-columns: 1fr 1fr; }
  .path-cards { grid-template-columns: 1fr; }
}

/* AIRPORT DROPDOWN */
.airport-dropdown { position:absolute; top:calc(100% + 4px); left:0; right:0; background:var(--card2); border:1.5px solid var(--border2); border-radius:12px; z-index:200; max-height:220px; overflow-y:auto; box-shadow:0 12px 40px rgba(0,0,0,0.5); }
.airport-option { padding:10px 14px; cursor:pointer; border-bottom:1px solid var(--border); transition:background .15s; }
.airport-option:last-child { border-bottom:none; }
.airport-option:hover { background:rgba(229,168,60,0.08); }
.airport-code { font-family:'DM Mono',monospace; font-size:14px; font-weight:700; color:var(--gold2); display:inline-block; width:42px; }
.airport-name { font-size:13px; color:var(--text); }
.airport-city { font-size:11px; color:var(--text3); margin-top:1px; }

/* PREF CHIPS */
.pref-chip { background:var(--card2); border:1.5px solid var(--border); border-radius:12px; padding:10px 12px; font-size:12px; font-weight:600; color:var(--text2); cursor:pointer; text-align:center; transition:all .2s; user-select:none; }
.pref-chip:hover { border-color:var(--border2); color:var(--text); }
.pref-chip.selected { background:rgba(229,168,60,0.1); border-color:var(--gold2); color:var(--gold2); }



/* ‚îÄ‚îÄ AIRCRAFT CARD ALIGNMENT FIX ‚îÄ‚îÄ */
.field-group { display:flex; flex-direction:column; }
.field-group 
.aircraft-grid-4 { display:grid; grid-template-columns:1fr 1fr 1fr 1fr; gap:12px; margin-bottom:16px; align-items:end; }
.aircraft-grid-3 { display:grid; grid-template-columns:1fr 1fr 1fr; gap:12px; margin-bottom:16px; align-items:end; }
.aircraft-grid-2 { display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-bottom:16px; align-items:end; }
.aircraft-section-label {
  font-size:10px; font-weight:800; letter-spacing:.12em; text-transform:uppercase;
  color:var(--text3); margin-bottom:10px; padding-top:4px;
  border-top:1px solid var(--border2); margin-top:4px;
}
.aircraft-section-label:first-child { border-top:none; margin-top:0; }


    .modal-submit:disabled { opacity: 0.4; cursor: not-allowed; }
    #qc-cards { grid-template-columns: 1fr 1fr; }
    @media (max-width: 500px) { #qc-cards { grid-template-columns: 1fr; } }

    </style>
</head>
<body>
<div class="top-nav">
  <div class="nav-logo">Aviate <span>Atelier</span></div>
  <div class="nav-divider"></div>
  <div class="nav-section" id="nav-section-label">Operator Portal</div>
  <div class="nav-spacer"></div>
  <div class="nav-status" id="nav-status" style="display:none">
    <div class="nav-status-dot"></div>
    <span id="nav-user-name">Loading...</span>
  </div>
  <button id="nav-logout-btn" onclick="logout()" style="display:none;height:32px;padding:0 14px;background:var(--border);border:none;border-radius:8px;font-family:'DM Sans',sans-serif;font-size:11px;font-weight:700;color:var(--text3);cursor:pointer;margin-left:12px">Sign Out</button>
</div>

<div class="view active" id="view-landing">
  <div style="min-height:calc(100vh - 60px);display:flex;align-items:center;justify-content:center;padding:48px 24px">
    <div style="max-width:520px;width:100%;text-align:center">
      <div style="font-size:10px;font-weight:700;letter-spacing:.2em;text-transform:uppercase;color:#E5A83C;margin-bottom:16px">Operator Portal</div>
      <div style="font-family:'Playfair Display',serif;font-size:44px;font-weight:600;color:#E6EDF3;line-height:1.15;margin-bottom:16px">Grow your charter<br><em style="color:#E5A83C">business with us</em></div>
      <div style="font-size:15px;color:#8B949E;line-height:1.7;margin-bottom:40px">Join Aviate Atelier and receive direct booking requests from qualified clients. No broker. No middleman. Just direct access to a premium client base.</div>
      <button onclick="showView('view-operator-onboard')" style="width:100%;height:56px;border-radius:14px;border:none;background:linear-gradient(135deg,#C8912A,#E5A83C);color:#080D14;font-family:'DM Sans',sans-serif;font-size:16px;font-weight:800;cursor:pointer;margin-bottom:14px">Join as an Operator</button>
      <div style="font-size:13px;color:#6E7681">
        Already registered?
        <button onclick="showView('view-operator-login')" style="background:none;border:none;color:#E5A83C;cursor:pointer;font-size:13px;font-weight:700;padding:0 4px">Operator Sign In</button>
      </div>
      <div style="margin-top:16px;padding-top:16px;border-top:1px solid rgba(255,255,255,0.07)">
        <button onclick="loadDemoMode()" style="width:100%;height:42px;border-radius:11px;border:1.5px solid rgba(229,168,60,0.3);background:rgba(229,168,60,0.06);color:#E5A83C;font-family:'DM Sans',sans-serif;font-size:13px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px" onmouseover="this.style.background='rgba(229,168,60,0.12)'" onmouseout="this.style.background='rgba(229,168,60,0.06)'">
          <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 2l5 5-5 5"/></svg>
          Preview Dashboard &mdash; No Sign In Required
        </button>
        <div style="font-size:10px;color:#3D4450;text-align:center;margin-top:7px;letter-spacing:.04em">Sample data &middot; Not connected to a live account</div>
      </div>
    </div>
  </div>
</div>
<div class="view" id="view-operator-login">
  <div class="login-wrap">
    <div class="login-card">
      <div class="login-title">Operator Sign In</div>
      <div class="login-sub">Access your Aviate Atelier operator dashboard.</div>
      <div class="field-group">
        <div class="field-label">Company Email</div>
        <input class="field-input" type="email" id="op-login-email" placeholder="ops@yourcompany.com">
      </div>
      <div class="field-group">
        <div class="field-label">Password</div>
        <input class="field-input" type="password" id="op-login-pass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" onkeydown="if(event.key==='Enter')operatorLogin()">
      </div>
      <div class="field-error show" id="op-login-error" style="display:none;margin-bottom:12px"></div>
      <button class="ob-btn primary" onclick="operatorLogin()" id="op-login-btn">
        Sign In to Dashboard
      </button>
      <div class="login-footer" style="margin-top:16px">
        New operator? <a onclick="showView('view-operator-onboard')">Join the platform</a> ¬∑ <a onclick="showView('view-landing')">Back to home</a>
      </div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê CLIENT LOGIN ‚ïê‚ïê -->

<div class="view" id="view-operator-onboard">
<div class="onboard-wrap">
  <div class="stepper" id="stepper">
    <div class="step-item active" id="si-0"><div class="step-circle">01</div><div class="step-label">Company</div></div>
    <div class="step-item" id="si-1"><div class="step-circle">02</div><div class="step-label">Certificates</div></div>
    <div class="step-item" id="si-2"><div class="step-circle">03</div><div class="step-label">Fleet</div></div>
    <div class="step-item" id="si-3"><div class="step-circle">04</div><div class="step-label">Team Access</div></div>
    <div class="step-item" id="si-4"><div class="step-circle">05</div><div class="step-label">Agreement</div></div>
    <div class="step-item" id="si-5"><div class="step-circle">06</div><div class="step-label">Confirmed</div></div>
  </div>

  <!-- STEP 1: Company -->
  <div class="ob-step active" id="step-0">
    <div class="ob-eyebrow">Step 1 of 6</div>
    <div class="ob-title">Welcome to Aviate Atelier</div>
    <div class="ob-sub">Let's get your charter operation set up. This takes about 10 minutes. You'll need your FAA Part 135 certificate number and ARGUS or Wyvern rating on hand.</div>
    <div class="field-group">
      <div class="field-label">Legal Company Name <span class="field-required">Required</span></div>
      <input class="field-input" placeholder="Legal Company Name" id="f-company">
    </div>
    <div class="field-row">
      <div class="field-group">
        <div class="field-label">Trading / DBA Name</div>
        <input class="field-input" placeholder="Same as legal name" id="f-trading">
      </div>
      <div class="field-group">
        <div class="field-label">EIN / Tax ID <span class="field-required">Required</span></div>
        <input class="field-input" placeholder="XX-XXXXXXX" id="f-ein">
      </div>
    </div>
    <div class="field-row">
      <div class="field-group">
        <div class="field-label">Primary State / Country of Operations</div>
        <select class="field-select" id="f-state">
          <option value="">-- Select Region --</option>
          <optgroup label="United States"><option value="AL">Alabama</option><option value="AK">Alaska</option><option value="AZ">Arizona</option><option value="AR">Arkansas</option><option value="CA">California</option><option value="CO">Colorado</option><option value="CT">Connecticut</option><option value="DE">Delaware</option><option value="FL">Florida</option><option value="GA">Georgia</option><option value="HI">Hawaii</option><option value="ID">Idaho</option><option value="IL">Illinois</option><option value="IN">Indiana</option><option value="IA">Iowa</option><option value="KS">Kansas</option><option value="KY">Kentucky</option><option value="LA">Louisiana</option><option value="ME">Maine</option><option value="MD">Maryland</option><option value="MA">Massachusetts</option><option value="MI">Michigan</option><option value="MN">Minnesota</option><option value="MS">Mississippi</option><option value="MO">Missouri</option><option value="MT">Montana</option><option value="NE">Nebraska</option><option value="NV">Nevada</option><option value="NH">New Hampshire</option><option value="NJ">New Jersey</option><option value="NM">New Mexico</option><option value="NY">New York</option><option value="NC">North Carolina</option><option value="ND">North Dakota</option><option value="OH">Ohio</option><option value="OK">Oklahoma</option><option value="OR">Oregon</option><option value="PA">Pennsylvania</option><option value="RI">Rhode Island</option><option value="SC">South Carolina</option><option value="SD">South Dakota</option><option value="TN">Tennessee</option><option value="TX">Texas</option><option value="UT">Utah</option><option value="VT">Vermont</option><option value="VA">Virginia</option><option value="WA">Washington</option><option value="WV">West Virginia</option><option value="WI">Wisconsin</option><option value="WY">Wyoming</option><option value="DC">Washington D.C.</option><option value="PR">Puerto Rico</option><option value="GU">Guam</option><option value="VI">U.S. Virgin Islands</option></optgroup>
          <optgroup label="Canada"><option value="AB">Alberta</option><option value="BC">British Columbia</option><option value="MB">Manitoba</option><option value="NB">New Brunswick</option><option value="NL">Newfoundland & Labrador</option><option value="NS">Nova Scotia</option><option value="ON">Ontario</option><option value="PE">Prince Edward Island</option><option value="QC">Quebec</option><option value="SK">Saskatchewan</option><option value="NT">Northwest Territories</option><option value="NU">Nunavut</option><option value="YT">Yukon</option></optgroup>
          <optgroup label="United Kingdom"><option value="ENG">England</option><option value="SCT">Scotland</option><option value="WLS">Wales</option><option value="NIR">Northern Ireland</option></optgroup>
          <optgroup label="Australia"><option value="NSW">New South Wales</option><option value="VIC">Victoria</option><option value="QLD">Queensland</option><option value="WA">Western Australia</option><option value="SA">South Australia</option><option value="TAS">Tasmania</option><option value="ACT">Australian Capital Territory</option><option value="NT">Northern Territory</option></optgroup>
          <optgroup label="Other Countries"><option value="Mexico">Mexico</option><option value="France">France</option><option value="Germany">Germany</option><option value="Italy">Italy</option><option value="Spain">Spain</option><option value="Portugal">Portugal</option><option value="Netherlands">Netherlands</option><option value="Belgium">Belgium</option><option value="Switzerland">Switzerland</option><option value="Austria">Austria</option><option value="Sweden">Sweden</option><option value="Norway">Norway</option><option value="Denmark">Denmark</option><option value="Finland">Finland</option><option value="Greece">Greece</option><option value="Turkey">Turkey</option><option value="UAE">UAE</option><option value="Saudi Arabia">Saudi Arabia</option><option value="Qatar">Qatar</option><option value="Bahrain">Bahrain</option><option value="Kuwait">Kuwait</option><option value="Israel">Israel</option><option value="India">India</option><option value="Singapore">Singapore</option><option value="Hong Kong">Hong Kong</option><option value="Japan">Japan</option><option value="South Korea">South Korea</option><option value="Australia">Australia</option><option value="New Zealand">New Zealand</option><option value="Brazil">Brazil</option><option value="Argentina">Argentina</option><option value="Colombia">Colombia</option><option value="Panama">Panama</option><option value="Bahamas">Bahamas</option><option value="Cayman Islands">Cayman Islands</option><option value="Turks & Caicos">Turks & Caicos</option><option value="Barbados">Barbados</option><option value="Trinidad & Tobago">Trinidad & Tobago</option><option value="Jamaica">Jamaica</option><option value="Mexico">Mexico</option><option value="South Africa">South Africa</option><option value="Kenya">Kenya</option><option value="Morocco">Morocco</option><option value="Egypt">Egypt</option><option value="Nigeria">Nigeria</option><option value="Ghana">Ghana</option></optgroup>
        </select>
      </div>
      <div class="field-group">
        <div class="field-label">Home FBO / Base Airport</div>
        <input class="field-input" placeholder="OPF, TEB, VNY‚Ä¶" id="f-fbo">
      </div>
    </div>
    <div class="field-group">
      <div class="field-label">Business Address <span class="field-required">Required</span></div>
      <input class="field-input" placeholder="Street Address" id="f-address" style="margin-bottom:10px">
      <div class="field-row">
        <input class="field-input" placeholder="City" id="f-city">
        <input class="field-input" placeholder="ZIP" id="f-zip">
      </div>
    </div>
    <div class="field-group">
      <div class="field-label">Company Email <span class="field-required">Required</span></div>
      <input class="field-input" type="email" placeholder="ops@yourcompany.com" id="f-email">
    </div>
    <div class="field-group">
      <div class="field-label">Password <span class="field-required">Required</span></div>
      <input class="field-input" type="password" placeholder="Minimum 8 characters" id="f-password">
      <div class="field-hint">You'll use this to log into the operator dashboard.</div>
    </div>
    <div class="field-error" id="step0-error"></div>
    <div class="ob-btn-row">
      <button class="ob-btn ghost" onclick="showView('view-landing')">‚Üê Back</button>
      <button class="ob-btn primary" onclick="goStep(1)">Continue ‚Äî Certifications ‚Üí</button>
    </div>
  </div>

  <!-- STEP 2: Certificates -->
  <div class="ob-step" id="step-1">
    <div class="ob-eyebrow">Step 2 of 6</div>
    <div class="ob-title">FAA & Safety Certifications</div>
    <div class="ob-sub">Aviate Atelier requires all operators to hold a valid FAA Part 135 Air Carrier Certificate and at minimum an ARGUS Gold or Wyvern Wingman / PASS rating.</div>
    <div class="field-group">
      <div class="field-label">FAA Part 135 Certificate Number <span class="field-required">Required</span></div>
      <input class="field-input" placeholder="e.g. A3J912" id="f-cert" style="font-family:'DM Mono',monospace;font-size:18px;letter-spacing:.08em">
    </div>
    <div class="cert-required-card">
      <div class="cert-req-title">üõ° ARGUS Rating <span class="cert-req-badge required">Required ‚Äî Gold or higher</span></div>
      <div class="cert-req-desc">ARGUS conducts independent biennial audits of your operations, safety management, crew training, and incident history.</div>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px">
      <div class="upload-zone" id="uz-argus" onclick="markUploaded('uz-argus','argus')">
        <div class="upload-icon">üõ°Ô∏è</div>
        <div class="upload-title">Upload ARGUS Certificate</div>
        <div class="upload-sub">PDF or image ¬∑ Must be current</div>
      </div>
      <div style="background:var(--card);border:1.5px solid var(--border);border-radius:14px;padding:14px">
        <div class="field-label" style="margin-bottom:8px">ARGUS Rating Level</div>
        <select class="field-select" id="f-argus">
          <option>ARGUS Platinum</option><option>ARGUS Gold</option><option>No ARGUS Rating</option>
        </select>
      </div>
    </div>
    <div class="cert-required-card" style="background:rgba(88,166,255,0.04);border-color:rgba(88,166,255,0.2)">
      <div class="cert-req-title" style="color:#58A6FF">‚ú¶ Wyvern Certification <span class="cert-req-badge optional">Optional</span></div>
      <div class="cert-req-desc">Wyvern Wingman or PASS certification demonstrates additional independent SMS verification.</div>
    </div>
    <div class="upload-zone" id="uz-wyvern" onclick="markUploaded('uz-wyvern','wyvern')" style="margin-bottom:16px">
      <div class="upload-icon">‚ú¶</div>
      <div class="upload-title">Upload Wyvern Certificate (Optional)</div>
      <div class="upload-sub">PDF or image ¬∑ Wingman or PASS</div>
    </div>
    <div class="field-row">
      <div class="field-group">
        <div class="field-label">IS-BAO Registration</div>
        <select class="field-select" id="f-isbao">
          <option>Not Registered</option><option>Stage 1</option><option>Stage 2</option><option>Stage 3</option>
        </select>
      </div>
      <div class="field-group">
        <div class="field-label">Liability Insurance</div>
        <select class="field-select" id="f-insurance">
          <option>$250M+ Combined (Required)</option><option>$100M‚Äì$250M (Review required)</option>
        </select>
      </div>
    </div>
    <div class="ob-btn-row">
      <button class="ob-btn ghost" onclick="goStep(0)">‚Üê Back</button>
      <button class="ob-btn primary" onclick="goStep(2)">Continue ‚Äî Fleet ‚Üí</button>
    </div>
  </div>

  <!-- STEP 3: Fleet -->
  <div class="ob-step" id="step-2">
    <div class="ob-eyebrow">Step 3 of 6</div>
    <div class="ob-title">Register Your Fleet</div>
    <div class="ob-sub">Select each aircraft from the database. Details auto-fill ‚Äî just confirm and add your tail number.</div>
    <div id="fleet-list"></div>
    <button onclick="addAircraftCard()" style="width:100%;height:46px;background:transparent;border:1.5px dashed var(--border2);border-radius:12px;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:13px;font-weight:700;cursor:pointer;margin-bottom:24px" onmouseover="this.style.borderColor='var(--gold2)';this.style.color='var(--gold2)'" onmouseout="this.style.borderColor='var(--border2)';this.style.color='var(--text3)'">+ Add Another Aircraft</button>
    <div class="ob-btn-row">
      <button class="ob-btn ghost" onclick="goStep(1)">Back</button>
      <button class="ob-btn primary" onclick="goStep(3)">Continue ‚Äî Team Access</button>
    </div>
  </div>

  <!-- STEP 4: Team Access -->
  <div class="ob-step" id="step-3">
    <div class="ob-eyebrow">Step 4 of 6</div>
    <div class="ob-title">Set Up Team Access</div>
    <div class="ob-sub">Choose your own role. Role levels control what financial information is visible inside the dashboard.</div>
    <div style="background:var(--card);border:1px solid var(--border2);border-radius:16px;padding:18px;margin-bottom:20px">
      <div class="field-label" style="margin-bottom:14px">Your Role on This Account</div>
      <div style="margin-bottom:8px;font-size:10px;font-weight:800;color:var(--gold2);letter-spacing:.1em;text-transform:uppercase;padding-left:2px">Leadership ‚Äî Full Authority (Part 135)</div>
      <div class="role-cards" style="margin-bottom:14px">
        <div class="role-card selected" id="role-owner" onclick="selectRole('owner')">
          <div class="role-icon">üëë</div>
          <div class="role-name">Owner</div>
          <div class="role-desc">Full access including financial terms, commission, and team management.</div>
        </div>
        <div class="role-card" id="role-director_ops" onclick="selectRole('director_ops')">
          <div class="role-icon">‚ö°</div>
          <div class="role-name">Director of Operations</div>
          <div class="role-desc">FAA authority to initiate &amp; cancel flights. Full ops access. No financial terms.</div>
        </div>
        <div class="role-card" id="role-chief_pilot" onclick="selectRole('chief_pilot')">
          <div class="role-icon">‚úà</div>
          <div class="role-name">Chief Pilot</div>
          <div class="role-desc">FAA authority to initiate &amp; cancel flights. Fleet &amp; status management.</div>
        </div>
      </div>
      <div style="margin-bottom:8px;font-size:10px;font-weight:800;color:var(--text3);letter-spacing:.1em;text-transform:uppercase;padding-left:2px">Operations Staff</div>
      <div class="role-cards" style="grid-template-columns:1fr">
        <div class="role-card" id="role-dispatcher" onclick="selectRole('dispatcher')">
          <div class="role-icon">üéß</div>
          <div class="role-name">Dispatcher / Flight Scheduler</div>
          <div class="role-desc">Manages booking requests, quotes, manifests, aircraft availability and daily scheduling. No financial or commission access.</div>
        </div>
      </div>
    </div>
    <div class="field-row" style="margin-bottom:24px">
      <div class="field-group">
        <div class="field-label">Your Full Name <span class="field-required">Required</span></div>
        <input class="field-input" placeholder="Full legal name" id="f-owner-name">
      </div>
      <div class="field-group">
        <div class="field-label">Your Title</div>
        <input class="field-input" placeholder="Owner / Director of Operations" id="f-owner-title">
      </div>
    </div>
    <div class="ob-btn-row">
      <button class="ob-btn ghost" onclick="goStep(2)">‚Üê Back</button>
      <button class="ob-btn primary" onclick="goStep(4)">Continue ‚Äî Review Agreement ‚Üí</button>
    </div>
  </div>

  <!-- STEP 5: OSA -->
  <div class="ob-step" id="step-4">
    <div class="ob-eyebrow">Step 5 of 6 ¬∑ Legal Agreement</div>
    <div class="ob-title">Operator Services Agreement</div>
    <div class="ob-sub">Please read the full Operator Services Agreement below before activating your account. By signing, you confirm you have read and agreed to all terms and conditions governing your use of the Aviate Atelier platform.</div>
    <div class="osa-scroll" id="osa-scroll" onscroll="checkScroll()">
      <div class="osa-header">
        <div class="osa-logo-text">Aviate <span>Atelier</span></div>
        <div class="osa-doc-title">Operator Services Agreement</div>
        <div class="osa-doc-sub">Version 1.0 ¬∑ Effective Date: Upon Execution ¬∑ Aviate Atelier Inc. ("Platform")</div>
      </div>
      <div class="osa-body">
        <div class="osa-section">
          <div class="osa-section-title">1. Parties and Definitions</div>
          <p><strong>1.1</strong> This Operator Services Agreement ("Agreement") is entered into between <strong>Aviate Atelier Inc.</strong>, a technology marketplace platform ("Aviate Atelier," "Platform," or "we"), and the charter operator entity identified during onboarding ("Operator," "you," or "your").</p>
          <p><strong>1.2</strong> "Booking" means any confirmed charter flight transaction originated through the Aviate Atelier platform between a client and Operator.</p>
          <p><strong>1.3</strong> "Gross Charter Value" or "GCV" means the total amount paid by an Aviate Atelier client for a charter flight, inclusive of all fees, surcharges, and landing fees as quoted by the Operator.</p>
          <p><strong>1.4</strong> "Settlement Amount" means the amount remitted to Operator following deduction of any applicable Platform Service Fee from the Gross Charter Value.</p>
          <p><strong>1.5</strong> "Platform Service Fee" means the commission deducted by Aviate Atelier from the Gross Charter Value per the schedule outlined in Section 5 and Schedule A of this Agreement.</p>
          <p><strong>1.6</strong> "Beta Period" means the initial period commencing on the Operator's account activation date and lasting for six (6) calendar months, during which no Platform Service Fee is charged.</p>
        </div>
        <div class="osa-section">
          <div class="osa-section-title">2. Nature of the Platform</div>
          <p><strong>2.1</strong> Aviate Atelier is a technology marketplace that connects charter clients with FAA Part 135 certified operators. Aviate Atelier operates as a charter broker under DOT 14 CFR Part 295 on behalf of clients.</p>
          <p><strong>2.2</strong> Aviate Atelier does not operate aircraft, employ pilots, or assume operational control of any flight. All aviation operations remain solely the responsibility of the Operator.</p>
          <p><strong>2.3</strong> The contractual relationship for each flight exists directly between the Operator and the client. Aviate Atelier facilitates the connection and processes payment on behalf of both parties.</p>
        </div>
        <div class="osa-section">
          <div class="osa-section-title">3. Operator Obligations</div>
          <p><strong>3.1</strong> Operator must maintain a valid FAA Part 135 Air Carrier Certificate at all times.</p>
          <p><strong>3.2</strong> Operator must maintain a minimum ARGUS Gold rating or Wyvern Wingman / PASS certification.</p>
          <p><strong>3.3</strong> Operator must maintain combined hull and liability insurance of no less than $250,000,000 per occurrence. Aviate Atelier must be named as an additional insured.</p>
          <p><strong>3.4</strong> Operator agrees to respond to incoming booking requests within four (4) hours during business hours.</p>
        </div>
        <div class="osa-section">
          <div class="osa-section-title">4. Beta Period</div>
          <div class="osa-highlight"><strong>4.1</strong> For the first six (6) calendar months following account activation, Aviate Atelier will charge <strong>zero (0%) Platform Service Fee</strong> on all Bookings. Operator receives 100% of all Gross Charter Value during this period.</div>
          <p><strong>4.2</strong> The Beta Period will not renew. Upon expiration, the Fee Transition Schedule outlined in Section 5 and Schedule A automatically activates without further notice beyond this Agreement.</p>
          <p><strong>4.3</strong> By executing this Agreement, Operator acknowledges that the Beta Period is temporary and that Platform Service Fees will activate upon its expiration as described herein.</p>
        </div>
        <div class="osa-section">
          <div class="osa-section-title">5. Platform Service Fee & Transition Schedule</div>
          <div class="osa-warning"><strong>Important:</strong> The fee schedule below is pre-disclosed and agreed to at onboarding. Fee transitions activate automatically per Schedule A without additional notice.</div>
          <p><strong>5.1</strong> Platform Service Fees activate automatically upon expiration of the Beta Period.</p>
          <p><strong>5.2</strong> A minimum Platform Service Fee of $250 USD applies per Booking from Month 7 onward.</p>
          <p><strong>5.3</strong> Platform Service Fee amounts are available to the Operator Account Owner through the Owner Admin portal. Operational team members see only Settlement Amounts.</p>
          <p><strong>5.4</strong> Aviate Atelier may amend the fee schedule beyond Month 13 with sixty (60) days written notice.</p>
          <div class="osa-section-title" style="margin-top:20px">Schedule A ‚Äî Platform Service Fee Schedule</div>
          <div class="schedule-a">
            <div class="schedule-a-header">Aviate Atelier Inc. ¬∑ Operator Services Agreement ¬∑ Schedule A</div>
            <div class="schedule-row head"><div>Period</div><div>Months</div><div>Rate</div><div>Booking Value</div></div>
            <div class="schedule-row beta-row"><div style="font-weight:700">Beta Period</div><div>1‚Äì6</div><div class="s-rate free">0% Free</div><div style="font-size:10px;color:#6E7681">All booking values</div></div>
            <div class="schedule-row"><div style="font-weight:700">Introductory</div><div>7‚Äì9</div><div class="s-rate low">2.0%</div><div style="font-size:10px;color:#6E7681">All values ¬∑ Min $250</div></div>
            <div class="schedule-row"><div style="font-weight:700">Growth</div><div>10‚Äì12</div><div class="s-rate mid">3.5%</div><div style="font-size:10px;color:#6E7681">All values ¬∑ Min $250</div></div>
            <div class="schedule-row"><div style="font-weight:700;font-size:11px">Standard Tiered</div><div>13+</div><div class="s-rate full">8% / 6% / 4% / 3%</div><div style="font-size:10px;color:#6E7681">&lt;$20K / $20‚Äì75K / $75‚Äì150K / $150K+</div></div>
          </div>
        </div>
        <div class="osa-section">
          <div class="osa-section-title">6. Payments & Settlement</div>
          <p><strong>6.1</strong> Aviate Atelier collects full payment from clients at time of booking. Settlement to Operator occurs within two (2) business days of flight completion, net of applicable Platform Service Fees.</p>
          <p><strong>6.2</strong> Monthly settlement statements are provided to the Operator Account Owner.</p>
        </div>
        <div class="osa-section">
          <div class="osa-section-title">7. Termination</div>
          <p><strong>7.1</strong> Either party may terminate this Agreement with thirty (30) days written notice.</p>
          <p><strong>7.2</strong> Aviate Atelier may immediately suspend Operator access if FAA certificate lapses, safety rating lapses, or insurance drops below required minimums.</p>
        </div>
        <div class="osa-section">
          <div class="osa-section-title">8. Confidentiality</div>
          <p><strong>8.1</strong> The commercial terms of this Agreement are confidential between Aviate Atelier and the Operator Account Owner. Operator agrees not to disclose fee structures to clients or third parties.</p>
          <p><strong>8.2</strong> Operator shall not use platform data to solicit Aviate Atelier clients directly outside the Platform during the term and for twelve (12) months following termination.</p>
        </div>
        <div class="osa-section">
          <div class="osa-section-title">9. Governing Law</div>
          <p>This Agreement shall be governed by the laws of the State of Delaware. Disputes resolved through binding arbitration under JAMS rules in New York, New York.</p>
        </div>
      </div>
    </div>
    <div class="scroll-prompt" id="scroll-prompt">‚Üì Please scroll to the bottom of the agreement before signing</div>
    <div id="agreement-checks" style="opacity:0.4;transition:opacity .4s">
      <div class="ob-checkbox" onclick="toggleCheck('c1')"><div class="ob-check" id="c1"></div><div class="ob-check-label">I confirm I am the legal Owner or authorized signatory and have authority to execute this Agreement on behalf of the Operator company.</div></div>
      <div class="ob-checkbox" onclick="toggleCheck('c2')"><div class="ob-check" id="c2"></div><div class="ob-check-label">I have read <strong>Section 4 (Beta Period)</strong> and confirm the 0% commission-free period lasts six (6) months and fees activate automatically upon expiration.</div></div>
      <div class="ob-checkbox" onclick="toggleCheck('c3')"><div class="ob-check" id="c3"></div><div class="ob-check-label">I have reviewed <strong>Schedule A</strong> and agree to the fee transition: 0% (Months 1‚Äì6) ‚Üí 2% (Months 7‚Äì9) ‚Üí 3.5% (Months 10‚Äì12) ‚Üí Standard Tiered (Month 13+).</div></div>
      <div class="ob-checkbox" onclick="toggleCheck('c4')"><div class="ob-check" id="c4"></div><div class="ob-check-label">I agree to the full <strong>Aviate Atelier Operator Services Agreement</strong> including all Sections and Schedule A, and to the Platform Terms of Service.</div></div>
    </div>
    <div class="sig-section" style="margin-top:20px">
      <div style="font-size:14px;font-weight:700;color:var(--text);margin-bottom:4px">Electronic Signature</div>
      <div style="font-size:12px;color:var(--text2);margin-bottom:16px;line-height:1.5">Type your full legal name as your electronic signature.</div>
      <input class="sig-input" placeholder="Your full legal name" id="sig-name" oninput="checkSigReady()">
      <div class="sig-line"></div>
      <div class="sig-name-label">Authorized Signature ¬∑ <span id="sig-date-display"></span></div>
    </div>
    <div class="ob-btn-row">
      <button class="ob-btn ghost" onclick="goStep(3)">‚Üê Back</button>
      <button class="ob-btn primary" id="sign-btn" onclick="executeAgreement()" disabled>
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M2 8l4 4 8-8"/></svg>
        Execute Agreement & Activate Account
      </button>
    </div>
  </div>

  <!-- STEP 6: Success -->
  <div class="ob-step" id="step-5">
    <div class="success-screen">
      <div class="success-glow">
        <svg width="44" height="44" viewBox="0 0 44 44" fill="none" stroke="var(--green2)" stroke-width="3"><path d="M8 22l8 8 20-20"/></svg>
      </div>
      <div style="font-family:'Playfair Display',serif;font-size:32px;font-weight:600;color:var(--text);margin-bottom:8px">You're Live on Aviate Atelier</div>
      <div style="font-size:14px;color:var(--text2);line-height:1.7;margin-bottom:32px;max-width:480px;margin-left:auto;margin-right:auto">Your operator account is active and under verification. You'll start receiving booking requests as soon as your credentials are confirmed. Welcome to the platform.</div>
      <div style="background:var(--card);border:1px solid var(--border);border-radius:16px;padding:20px;margin-bottom:24px;display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px;text-align:left">
        <div><div style="font-size:10px;font-weight:700;letter-spacing:.12em;text-transform:uppercase;color:var(--text3);margin-bottom:4px">Company</div><div style="font-size:14px;font-weight:600;color:var(--text)" id="success-company">‚Äî</div></div>
        <div><div style="font-size:10px;font-weight:700;letter-spacing:.12em;text-transform:uppercase;color:var(--text3);margin-bottom:4px">Account Status</div><div style="font-size:14px;font-weight:600;color:var(--green2)">Active ‚úì</div></div>
        <div><div style="font-size:10px;font-weight:700;letter-spacing:.12em;text-transform:uppercase;color:var(--text3);margin-bottom:4px">Verification</div><div style="font-size:14px;font-weight:600;color:var(--gold2)">In Progress</div></div>
      </div>
      <button class="ob-btn primary" style="max-width:360px;margin:0 auto" onclick="goToDashboard()">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 8h12M8 3l5 5-5 5"/></svg>
        Go to My Dashboard
      </button>
    </div>
  </div>
</div>
</div>

<!-- ‚ïê‚ïê OPERATOR DASHBOARD ‚ïê‚ïê -->

<div class="view" id="view-dashboard">
  <div class="dashboard-wrap">
    <div class="sidebar">
      <div class="sidebar-company">
        <div class="sidebar-company-name" id="db-company-name">Loading...</div>
        <div>
          <div class="sidebar-cert" id="db-cert-badge">üõ° ARGUS</div>
          <div class="sidebar-role" id="db-role-badge">üëë Owner</div>
        </div>
      </div>
      <div class="sidebar-nav">
        <div class="sidebar-group-label">Operations</div>
        <div class="sidebar-item active" onclick="switchDashTab('requests')">
          <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M2 13L8 3L14 13"/><line x1="2" y1="14.5" x2="14" y2="14.5"/></svg>
          New Requests
          <div class="sidebar-badge" id="sb-badge" style="display:none">0</div>
        </div>
        <div class="sidebar-item" onclick="switchDashTab('bookings')">
          <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.8"><rect x="2" y="3" width="12" height="11" rx="2"/><line x1="5" y1="7" x2="11" y2="7"/><line x1="5" y1="10" x2="8" y2="10"/></svg>
          Active Bookings
        </div>
        <div class="sidebar-item" onclick="switchDashTab('fleet')">
          <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M2 11L8 3L14 11"/><line x1="2" y1="12.5" x2="14" y2="12.5"/></svg>
          Fleet & Certs
        </div>
        <div class="sidebar-item" id="sidebar-status-item" onclick="switchDashTab('status')">
          <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.8"><circle cx="8" cy="8" r="6"/><circle cx="8" cy="8" r="2.5" fill="currentColor" stroke="none"/></svg>
          Fleet Status
        </div>
        <div class="sidebar-item" id="sidebar-activity-item" onclick="switchDashTab('activity')">
          <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M2 4h12M2 8h8M2 12h10"/></svg>
          Activity Log
        </div>
            <div class="sidebar-item" onclick="switchDashTab('pilots')" id="sb-item-pilots">
              <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="6" cy="5" r="2.5"/><path d="M1 13c0-2.8 2.2-5 5-5s5 2.2 5 5"/><circle cx="12.5" cy="5" r="2"/><path d="M14 13h-3"/></svg>
              Pilot Roster
            </div>
        <div class="sidebar-group-label" id="sidebar-account-group">Account</div>
        <div class="sidebar-item" id="sidebar-osa-item" onclick="switchDashTab('osa')" style="display:none">
          <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M4 2h8a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V4a2 2 0 012-2z"/><line x1="5" y1="6" x2="11" y2="6"/><line x1="5" y1="9" x2="8" y2="9"/></svg>
          My Agreement
        </div>
      </div>
    </div>
    <div class="main-content">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px">
        <div>
          <div class="page-title" id="dash-page-title">New Requests</div>
          <div class="page-sub" id="dash-page-sub">Incoming booking requests matching your fleet</div>
        </div>
        <div style="font-size:12px;color:var(--text3)">Welcome back, <span id="db-owner-name" style="color:var(--gold2);font-weight:700">‚Äî</span></div>
      </div>

      <!-- REQUESTS TAB -->
      <div id="dtab-requests">
        <div class="stats-grid">
          <div class="stat-card" style="border-color:rgba(88,166,255,0.3)">
            <div class="stat-label">New Requests</div>
            <div class="stat-value blue" id="d-stat-req">0</div>
            <div class="stat-sub">awaiting response</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Quotes Sent</div>
            <div class="stat-value" id="d-stat-quotes">0</div>
            <div class="stat-sub">this session</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Confirmed</div>
            <div class="stat-value green" id="d-stat-confirmed">0</div>
            <div class="stat-sub">bookings</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Settlement Total</div>
            <div class="stat-value gold" id="d-stat-revenue">$0</div>
            <div class="stat-sub">this session</div>
          </div>
        </div>
        <div class="section-header">
          <div class="section-title">Incoming Requests</div>
          <div class="section-action" onclick="loadRequests()">‚Üª Refresh</div>
        </div>
        <div id="requests-list">
          <div class="empty-state">
            <div class="empty-icon"><svg width="28" height="28" viewBox="0 0 28 28" fill="none" stroke="var(--text3)" stroke-width="1.5"><path d="M4 20L14 6L24 20"/><line x1="4" y1="23" x2="24" y2="23"/></svg></div>
            <div class="empty-title">No requests yet</div>
            <div class="empty-sub">New client requests will appear here. Use the client portal to submit a test booking.</div>
          </div>
        </div>
      </div>

      <!-- BOOKINGS TAB -->
      <div id="dtab-bookings" style="display:none">
        <div id="bookings-list">
          <div class="empty-state">
            <div class="empty-icon"><svg width="28" height="28" viewBox="0 0 28 28" fill="none" stroke="var(--text3)" stroke-width="1.5"><rect x="3" y="3" width="22" height="22" rx="4"/><line x1="9" y1="11" x2="19" y2="11"/><line x1="9" y1="16" x2="14" y2="16"/></svg></div>
            <div class="empty-title">No active bookings</div>
            <div class="empty-sub">Confirmed bookings appear here after a client accepts your quote.</div>
          </div>
        </div>
      </div>

      <!-- FLEET TAB -->
      <div id="dtab-fleet" style="display:none">

        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
          <div>
            <div style="font-family:'Playfair Display',serif;font-size:22px;font-weight:600;color:var(--text)">Fleet &amp; Certifications</div>
            <div style="font-size:12px;color:var(--text3);margin-top:3px">Manage aircraft, crew, and compliance documents</div>
          </div>
          <button id="fleet-add-btn" onclick="openAddAircraftModal()" style="height:38px;padding:0 16px;background:linear-gradient(135deg,var(--gold),var(--gold2));color:var(--bg);border:none;border-radius:10px;font-family:'DM Sans',sans-serif;font-size:12px;font-weight:800;cursor:pointer">+ Add Aircraft</button>
        </div>

        <div style="display:flex;gap:0;margin-bottom:20px;border-bottom:1px solid var(--border)">
          <button id="fst-aircraft" onclick="showFleetSubTab('aircraft')" style="height:38px;padding:0 18px;background:none;border:none;border-bottom:2.5px solid var(--gold2);color:var(--gold2);font-family:'DM Sans',sans-serif;font-size:13px;font-weight:700;cursor:pointer;margin-bottom:-1px">Aircraft</button>
          <button id="fst-certs" onclick="showFleetSubTab('certs')" style="height:38px;padding:0 18px;background:none;border:none;border-bottom:2.5px solid transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:13px;font-weight:700;cursor:pointer;margin-bottom:-1px">Certifications</button>
          <button id="fst-docs" onclick="showFleetSubTab('docs')" style="height:38px;padding:0 18px;background:none;border:none;border-bottom:2.5px solid transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:13px;font-weight:700;cursor:pointer;margin-bottom:-1px">Documents</button>
          <button id="fst-crew" onclick="showFleetSubTab('crew')" style="height:38px;padding:0 18px;background:none;border:none;border-bottom:2.5px solid transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:13px;font-weight:700;cursor:pointer;margin-bottom:-1px">Crew</button>
        </div>

        <div id="fst-content-aircraft">
          <div id="fleet-display">
            <div class="empty-state">
              <div class="empty-icon"><svg width="28" height="28" viewBox="0 0 28 28" fill="none" stroke="var(--text3)" stroke-width="1.5"><path d="M4 20L14 6L24 20"/><line x1="4" y1="23" x2="24" y2="23"/></svg></div>
              <div class="empty-title">No aircraft registered</div>
              <div class="empty-sub">Add your fleet to start receiving matching booking requests.</div>
              <button onclick="openAddAircraftModal()" style="margin-top:16px;height:40px;padding:0 20px;background:var(--gold2);color:var(--bg);border:none;border-radius:10px;font-family:'DM Sans',sans-serif;font-size:13px;font-weight:800;cursor:pointer">+ Add Your First Aircraft</button>
            </div>
          </div>
        </div>

        <div id="fst-content-certs" style="display:none">
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px"><div style="background:var(--card);border:1px solid var(--border2);border-radius:14px;padding:18px"><div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px"><div><div style="font-size:13px;font-weight:700;color:var(--text)">ARGUS Rating</div><div style="font-size:11px;color:var(--text3);margin-top:2px">Platinum, Gold, Gold+, or Not Rated</div></div><div id="cert-badge-argus" style="font-size:10px;font-weight:800;padding:4px 10px;border-radius:7px;background:var(--bg3);border:1px solid var(--border);color:var(--text3)">Not Filed</div></div><div style="display:flex;gap:8px"><button onclick="uploadCert('argus')" style="flex:1;height:34px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text2);font-family:'DM Sans',sans-serif;font-size:11px;font-weight:700;cursor:pointer">Upload</button><button onclick="setCertExpiry('argus')" style="height:34px;padding:0 12px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:11px;cursor:pointer">Set Expiry</button></div></div><div style="background:var(--card);border:1px solid var(--border2);border-radius:14px;padding:18px"><div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px"><div><div style="font-size:13px;font-weight:700;color:var(--text)">Wyvern Wingman</div><div style="font-size:11px;color:var(--text3);margin-top:2px">PASS or Registered status</div></div><div id="cert-badge-wyvern" style="font-size:10px;font-weight:800;padding:4px 10px;border-radius:7px;background:var(--bg3);border:1px solid var(--border);color:var(--text3)">Not Filed</div></div><div style="display:flex;gap:8px"><button onclick="uploadCert('wyvern')" style="flex:1;height:34px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text2);font-family:'DM Sans',sans-serif;font-size:11px;font-weight:700;cursor:pointer">Upload</button><button onclick="setCertExpiry('wyvern')" style="height:34px;padding:0 12px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:11px;cursor:pointer">Set Expiry</button></div></div><div style="background:var(--card);border:1px solid var(--border2);border-radius:14px;padding:18px"><div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px"><div><div style="font-size:13px;font-weight:700;color:var(--text)">IS-BAO</div><div style="font-size:11px;color:var(--text3);margin-top:2px">Stage 1, 2, or 3 certification</div></div><div id="cert-badge-isbao" style="font-size:10px;font-weight:800;padding:4px 10px;border-radius:7px;background:var(--bg3);border:1px solid var(--border);color:var(--text3)">Not Filed</div></div><div style="display:flex;gap:8px"><button onclick="uploadCert('isbao')" style="flex:1;height:34px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text2);font-family:'DM Sans',sans-serif;font-size:11px;font-weight:700;cursor:pointer">Upload</button><button onclick="setCertExpiry('isbao')" style="height:34px;padding:0 12px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:11px;cursor:pointer">Set Expiry</button></div></div><div style="background:var(--card);border:1px solid var(--border2);border-radius:14px;padding:18px"><div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px"><div><div style="font-size:13px;font-weight:700;color:var(--text)">Air Charter Safety Foundation</div><div style="font-size:11px;color:var(--text3);margin-top:2px">ACSF Member status</div></div><div id="cert-badge-acsf" style="font-size:10px;font-weight:800;padding:4px 10px;border-radius:7px;background:var(--bg3);border:1px solid var(--border);color:var(--text3)">Not Filed</div></div><div style="display:flex;gap:8px"><button onclick="uploadCert('acsf')" style="flex:1;height:34px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text2);font-family:'DM Sans',sans-serif;font-size:11px;font-weight:700;cursor:pointer">Upload</button><button onclick="setCertExpiry('acsf')" style="height:34px;padding:0 12px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:11px;cursor:pointer">Set Expiry</button></div></div><div style="background:var(--card);border:1px solid var(--border2);border-radius:14px;padding:18px"><div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px"><div><div style="font-size:13px;font-weight:700;color:var(--text)">FAA Part 135 Certificate</div><div style="font-size:11px;color:var(--text3);margin-top:2px">Air carrier operating certificate</div></div><div id="cert-badge-faa135" style="font-size:10px;font-weight:800;padding:4px 10px;border-radius:7px;background:var(--bg3);border:1px solid var(--border);color:var(--text3)">Not Filed</div></div><div style="display:flex;gap:8px"><button onclick="uploadCert('faa135')" style="flex:1;height:34px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text2);font-family:'DM Sans',sans-serif;font-size:11px;font-weight:700;cursor:pointer">Upload</button><button onclick="setCertExpiry('faa135')" style="height:34px;padding:0 12px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:11px;cursor:pointer">Set Expiry</button></div></div><div style="background:var(--card);border:1px solid var(--border2);border-radius:14px;padding:18px"><div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px"><div><div style="font-size:13px;font-weight:700;color:var(--text)">FAA Drug & Alcohol Program</div><div style="font-size:11px;color:var(--text3);margin-top:2px">DOT/FAA compliance certificate</div></div><div id="cert-badge-dap" style="font-size:10px;font-weight:800;padding:4px 10px;border-radius:7px;background:var(--bg3);border:1px solid var(--border);color:var(--text3)">Not Filed</div></div><div style="display:flex;gap:8px"><button onclick="uploadCert('dap')" style="flex:1;height:34px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text2);font-family:'DM Sans',sans-serif;font-size:11px;font-weight:700;cursor:pointer">Upload</button><button onclick="setCertExpiry('dap')" style="height:34px;padding:0 12px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:11px;cursor:pointer">Set Expiry</button></div></div><div style="background:var(--card);border:1px solid var(--border2);border-radius:14px;padding:18px"><div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px"><div><div style="font-size:13px;font-weight:700;color:var(--text)">Insurance Certificate</div><div style="font-size:11px;color:var(--text3);margin-top:2px">Liability and hull coverage</div></div><div id="cert-badge-insurance" style="font-size:10px;font-weight:800;padding:4px 10px;border-radius:7px;background:var(--bg3);border:1px solid var(--border);color:var(--text3)">Not Filed</div></div><div style="display:flex;gap:8px"><button onclick="uploadCert('insurance')" style="flex:1;height:34px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text2);font-family:'DM Sans',sans-serif;font-size:11px;font-weight:700;cursor:pointer">Upload</button><button onclick="setCertExpiry('insurance')" style="height:34px;padding:0 12px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:11px;cursor:pointer">Set Expiry</button></div></div><div style="background:var(--card);border:1px solid var(--border2);border-radius:14px;padding:18px"><div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px"><div><div style="font-size:13px;font-weight:700;color:var(--text)">TSA Security Program</div><div style="font-size:11px;color:var(--text3);margin-top:2px">Twelve-Five or full program</div></div><div id="cert-badge-tsa" style="font-size:10px;font-weight:800;padding:4px 10px;border-radius:7px;background:var(--bg3);border:1px solid var(--border);color:var(--text3)">Not Filed</div></div><div style="display:flex;gap:8px"><button onclick="uploadCert('tsa')" style="flex:1;height:34px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text2);font-family:'DM Sans',sans-serif;font-size:11px;font-weight:700;cursor:pointer">Upload</button><button onclick="setCertExpiry('tsa')" style="height:34px;padding:0 12px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:11px;cursor:pointer">Set Expiry</button></div></div><div style="background:var(--card);border:1px solid var(--border2);border-radius:14px;padding:18px"><div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px"><div><div style="font-size:13px;font-weight:700;color:var(--text)">SMS Documentation</div><div style="font-size:11px;color:var(--text3);margin-top:2px">Safety Management System records</div></div><div id="cert-badge-sms" style="font-size:10px;font-weight:800;padding:4px 10px;border-radius:7px;background:var(--bg3);border:1px solid var(--border);color:var(--text3)">Not Filed</div></div><div style="display:flex;gap:8px"><button onclick="uploadCert('sms')" style="flex:1;height:34px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text2);font-family:'DM Sans',sans-serif;font-size:11px;font-weight:700;cursor:pointer">Upload</button><button onclick="setCertExpiry('sms')" style="height:34px;padding:0 12px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:11px;cursor:pointer">Set Expiry</button></div></div><div style="background:var(--card);border:1px solid var(--border2);border-radius:14px;padding:18px"><div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px"><div><div style="font-size:13px;font-weight:700;color:var(--text)">Maintenance Release</div><div style="font-size:11px;color:var(--text3);margin-top:2px">Current airworthiness documentation</div></div><div id="cert-badge-maint" style="font-size:10px;font-weight:800;padding:4px 10px;border-radius:7px;background:var(--bg3);border:1px solid var(--border);color:var(--text3)">Not Filed</div></div><div style="display:flex;gap:8px"><button onclick="uploadCert('maint')" style="flex:1;height:34px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text2);font-family:'DM Sans',sans-serif;font-size:11px;font-weight:700;cursor:pointer">Upload</button><button onclick="setCertExpiry('maint')" style="height:34px;padding:0 12px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:11px;cursor:pointer">Set Expiry</button></div></div>          </div>
        </div>

        <div id="fst-content-docs" style="display:none">
          <div style="background:var(--card);border:1px solid var(--border2);border-radius:14px;padding:20px">
            <div style="font-size:13px;font-weight:700;color:var(--text);margin-bottom:4px">Document Vault</div>
            <div style="font-size:12px;color:var(--text3);margin-bottom:16px">Upload compliance, regulatory, or operational documents</div>
            <div id="docs-list"><div style="font-size:12px;color:var(--text3);padding:20px 0;text-align:center">No documents uploaded yet</div></div>
            <button onclick="uploadDoc()" style="width:100%;height:42px;border:1.5px dashed var(--border2);background:transparent;border-radius:10px;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:13px;font-weight:700;cursor:pointer;margin-top:12px">+ Upload Document</button>
          </div>
        </div>

        <div id="fst-content-crew" style="display:none">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
            <div style="font-size:13px;color:var(--text2)">Pilots, dispatchers, and schedulers on your account</div>
            <button onclick="inviteCrew()" style="height:36px;padding:0 14px;background:var(--gold2);color:var(--bg);border:none;border-radius:9px;font-family:'DM Sans',sans-serif;font-size:12px;font-weight:800;cursor:pointer">+ Invite Crew</button>
          </div>
          <div id="crew-list"><div style="font-size:12px;color:var(--text3);padding:20px 0;text-align:center">No crew members added yet</div></div>
        </div>

      </div>

      <!-- OSA TAB -->
      <div id="dtab-osa" style="display:none" style="display:none">
        <!-- OSA Header -->
        <div style="background:var(--card);border:1px solid var(--border);border-radius:16px;padding:20px;display:flex;align-items:center;gap:16px;margin-bottom:20px">
          <div style="width:48px;height:48px;background:rgba(79,208,128,0.1);border:1px solid rgba(79,208,128,0.25);border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--green2)" stroke-width="2.5"><path d="M3 12l5 5 11-11"/></svg>
          </div>
          <div style="flex:1">
            <div style="font-size:15px;font-weight:700;color:var(--text)">Operator Services Agreement ‚Äî Executed</div>
            <div style="font-size:11px;color:var(--text3);margin-top:3px">Signed on account activation ¬∑ Aviate Atelier Inc. ¬∑ Version 1.0 ¬∑ 5% starting rate ¬∑ Tiered</div>
          </div>
          <div style="background:rgba(79,208,128,0.1);border:1px solid rgba(79,208,128,0.3);color:var(--green2);font-size:11px;font-weight:800;padding:6px 14px;border-radius:8px">Signed ‚úì</div>
        </div>
        <!-- Commission Summary Card -->
        <div style="background:rgba(229,168,60,0.06);border:1px solid rgba(229,168,60,0.2);border-radius:14px;padding:18px;margin-bottom:20px">
          <div style="font-size:11px;font-weight:700;letter-spacing:.1em;text-transform:uppercase;color:var(--gold2);margin-bottom:14px">Current Fee Schedule</div>
          <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:12px">
            <div style="background:var(--card);border-radius:10px;padding:14px;text-align:center">
              <div style="font-size:28px;font-weight:800;color:var(--gold2)">5%</div>
              <div style="font-size:10px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.06em;margin-top:4px">Starting Rate</div>
              <div style="font-size:10px;color:var(--text3);margin-top:2px">Decreases at volume</div>
            </div>
            <div style="background:var(--card);border-radius:10px;padding:14px;text-align:center">
              <div style="font-size:28px;font-weight:800;color:var(--text)">2 days</div>
              <div style="font-size:10px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.06em;margin-top:4px">Settlement</div>
              <div style="font-size:10px;color:var(--text3);margin-top:2px">At payment</div>
            </div>
            <div style="background:var(--card);border-radius:10px;padding:14px;text-align:center">
              <div style="font-size:28px;font-weight:800;color:var(--text)">30</div>
              <div style="font-size:10px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.06em;margin-top:4px">Day Notice</div>
              <div style="font-size:10px;color:var(--text3);margin-top:2px">Before rate changes</div>
            </div>
          </div>
          <div style="font-size:11px;color:var(--gold2);background:rgba(229,168,60,0.08);border-radius:8px;padding:10px 12px;line-height:1.6">
            ‚ö† <strong>Rate Advisory:</strong> The current marketplace fee starts at <strong>5%</strong> and decreases for higher-value bookings ‚Äî your settlement is always shown before you submit a quote. As Aviate Atelier grows and service quality improves, commission rates may be revised. You will receive a minimum <strong>30 days written notice</strong> before any rate change. Rates will never be applied retroactively to confirmed bookings.
          </div>
        </div>
        <!-- Full Agreement Text -->
        <div style="background:var(--card);border:1px solid var(--border2);border-radius:14px;overflow:hidden">
          <div style="padding:16px 20px;border-bottom:1px solid var(--border2);display:flex;justify-content:space-between;align-items:center">
            <div style="font-size:13px;font-weight:700;color:var(--text)">Full Agreement Text</div>
            <div style="font-size:10px;color:var(--text3)">Version 1.0 ¬∑ Effective on account activation</div>
          </div>
          <div style="padding:20px;font-size:12px;color:var(--text2);line-height:1.9;max-height:420px;overflow-y:auto">
            <div style="font-size:14px;font-weight:700;color:var(--text);margin-bottom:6px">AVIATE ATELIER ‚Äî OPERATOR SERVICES AGREEMENT</div>
            <div style="color:var(--text3);margin-bottom:18px">This agreement governs the relationship between Aviate Atelier Inc. ("Platform") and the registered operator ("Operator").</div>

            <div style="font-size:11px;font-weight:800;letter-spacing:.08em;text-transform:uppercase;color:var(--gold2);margin-bottom:6px">1. Platform Services</div>
            <div style="margin-bottom:16px">Aviate Atelier provides a digital marketplace connecting FAA Part 135 certified charter operators with qualified charter clients. The Platform facilitates quote requests, quote delivery, passenger manifest collection, and booking management. The Operator retains full operational control and PIC authority over all flights.</div>

            <div style="font-size:11px;font-weight:800;letter-spacing:.08em;text-transform:uppercase;color:var(--gold2);margin-bottom:6px">2. Commission & Settlement</div>
            <div style="margin-bottom:16px">The Platform charges a <strong>marketplace service fee</strong> on the total quoted price for each completed booking, deducted at settlement. The fee starts at <strong>5%</strong> and decreases for higher-value bookings; the exact settlement amount is always displayed transparently in the operator dashboard before any quote is submitted. The Platform collects full payment from the client at the time of booking. Operator settlement is transferred within two (2) business days of confirmed flight completion. The Platform reserves the right to revise commission rates as the platform matures and service quality improves, with a minimum <strong>thirty (30) calendar days' written notice</strong> via email to the registered account address. Rate changes will not apply retroactively to quotes already submitted or bookings already confirmed at the time of notice. Operators may terminate this agreement without penalty within the 30-day notice window if they do not accept revised rates.</div>

            <div style="font-size:11px;font-weight:800;letter-spacing:.08em;text-transform:uppercase;color:var(--gold2);margin-bottom:6px">3. Operator Obligations</div>
            <div style="margin-bottom:16px">The Operator agrees to: (a) maintain valid FAA Part 135 certification at all times; (b) carry liability insurance of at minimum $100,000,000 per occurrence; (c) respond to booking requests within 24 hours; (d) ensure all quoted aircraft are airworthy and available on the confirmed departure date; (e) maintain accurate passenger manifests per FAA and TSA requirements; (f) not directly solicit clients introduced through the Platform outside of the Platform for a period of 24 months.</div>

            <div style="font-size:11px;font-weight:800;letter-spacing:.08em;text-transform:uppercase;color:var(--gold2);margin-bottom:6px">4. Regulatory Compliance</div>
            <div style="margin-bottom:16px">The Operator is solely responsible for compliance with all applicable FAA regulations, TSA requirements, CUSTOMS and CBP clearances for international operations, and any applicable state or local regulations. The Platform is a marketplace intermediary and does not hold an FAA operating certificate. The Platform does not assume any liability for flight operations, safety of flight, or regulatory violations by the Operator.</div>

            <div style="font-size:11px;font-weight:800;letter-spacing:.08em;text-transform:uppercase;color:var(--gold2);margin-bottom:6px">5. Cancellation Policy &amp; Commission Protection</div>
            <div style="margin-bottom:8px"><strong style="color:var(--text)">5.1 Aviate Atelier Commission is Non-Refundable.</strong> The Platform's marketplace service fee is earned in full at the moment of client payment confirmation and booking acceptance. The commission is not subject to refund, reversal, or offset under any cancellation scenario, regardless of which party initiates the cancellation or the reason cited. This applies whether the client receives a full refund, partial refund, or no refund from the Operator.</div>
            <div style="margin-bottom:8px"><strong style="color:var(--text)">5.2 Operator-Initiated Cancellations.</strong> The Operator acknowledges that Aviate Atelier's commission is fully earned and non-refundable in the event the Operator cancels a confirmed booking for any reason, including but not limited to:</div>
            <div style="margin-bottom:12px;padding-left:14px;color:var(--text2);line-height:2.1;font-size:11.5px">
              (a) <strong>Meteorological &amp; Environmental</strong> ‚Äî adverse weather conditions, thunderstorms, icing, low visibility, high winds, volcanic ash, or any meteorological advisory issued by the NWS, NOAA, or FAA;<br>
              (b) <strong>Aircraft Mechanical / Maintenance</strong> ‚Äî unscheduled maintenance, AOG (Aircraft on Ground) status, avionics failure, airworthiness directive compliance, engine issues, hydraulic or systems failure, or any condition that renders the aircraft unairworthy per FAA standards;<br>
              (c) <strong>Crew Availability</strong> ‚Äî pilot illness or medical incapacity, failed FAA medical examination, crew rest violations under FAR Part 117, scheduling conflicts, pilot resignation or termination, unavailability of a qualified co-pilot or required crew member;<br>
              (d) <strong>Regulatory &amp; Compliance</strong> ‚Äî FAA enforcement action, certificate suspension or revocation, TSA security directive, customs or CBP clearance denial, failure to obtain required overflight permits;<br>
              (e) <strong>Operational &amp; Logistical</strong> ‚Äî airport closure, runway unavailability, FBO capacity or slot restriction, ground stop, NOTAM affecting departure or destination, fuel unavailability;<br>
              (f) <strong>Insurance &amp; Financial</strong> ‚Äî lapse in required liability coverage, failure to maintain minimum insurance thresholds, insolvency, or inability to meet financial obligations;<br>
              (g) <strong>Force Majeure</strong> ‚Äî acts of God, natural disasters, earthquakes, wildfires, pandemic restrictions, government-mandated travel restrictions, military or national emergency declarations, acts of terrorism, or any event beyond reasonable human control;<br>
              (h) <strong>Security</strong> ‚Äî credible security threat to aircraft, crew, or passengers; TSA or law enforcement instruction to ground the aircraft;<br>
              (i) <strong>Administrative</strong> ‚Äî operator error in booking confirmation, double-booking of aircraft, failure to verify passenger manifest requirements, or any internal scheduling error.
            </div>
            <div style="margin-bottom:8px"><strong style="color:var(--text)">5.3 Client-Initiated Cancellations.</strong> The Platform's commission is equally non-refundable in the event a client cancels a confirmed booking for any reason, including but not limited to:</div>
            <div style="margin-bottom:12px;padding-left:14px;color:var(--text2);line-height:2.1;font-size:11.5px">
              (a) <strong>Personal &amp; Schedule</strong> ‚Äî change of plans, schedule conflict, rescheduling request, personal preference, or voluntary decision not to travel;<br>
              (b) <strong>Medical &amp; Emergency</strong> ‚Äî client or passenger illness, medical emergency, hospitalization, or death of a client, passenger, or immediate family member;<br>
              (c) <strong>Financial</strong> ‚Äî inability to pay, payment dispute, credit card decline, insolvency, or business financial circumstances;<br>
              (d) <strong>Weather (Client-Perceived)</strong> ‚Äî client's personal concern about weather conditions, regardless of whether the flight is cleared to operate;<br>
              (e) <strong>Destination Changes</strong> ‚Äî client's decision to change destination, routing, or aircraft type after booking confirmation;<br>
              (f) <strong>No-Show</strong> ‚Äî failure of the client or passengers to arrive at the departure FBO within the agreed departure window;<br>
              (g) <strong>Group or Event Cancellation</strong> ‚Äî cancellation of the event, meeting, sporting event, or purpose for which the charter was arranged;<br>
              (h) <strong>Legal or Regulatory</strong> ‚Äî court order, government-mandated travel restriction, visa or customs denial affecting the client or passengers;<br>
              (i) <strong>Duplicate Booking</strong> ‚Äî client arranged alternative transportation before cancelling this booking;<br>
              (j) <strong>Dissatisfaction Prior to Flight</strong> ‚Äî client's dissatisfaction with quoted price, aircraft selection, terms, or any pre-flight communication.
            </div>
            <div style="margin-bottom:16px;background:rgba(229,168,60,0.07);border:1px solid rgba(229,168,60,0.2);border-radius:10px;padding:12px 14px;font-size:11.5px;line-height:1.8;color:var(--text2)">
              <strong style="color:var(--gold2)">5.4 Refund Arrangements Between Operator and Client.</strong> Any refund issued by the Operator to the client ‚Äî whether full or partial ‚Äî is solely a matter between the Operator and the client. Aviate Atelier is not a party to such refund arrangements and its commission shall not be deducted from, reduced by, or offset against any refund amount. The Operator agrees that it shall not seek reimbursement of the Platform commission from Aviate Atelier under any cancellation or refund scenario.
            </div>

            <div style="font-size:11px;font-weight:800;letter-spacing:.08em;text-transform:uppercase;color:var(--gold2);margin-bottom:6px">6. Termination</div>
            <div style="margin-bottom:16px">Either party may terminate this agreement with thirty (30) days' written notice. The Platform reserves the right to suspend or terminate access immediately for breach of regulatory compliance, fraud, or material misrepresentation. Outstanding settlements for completed flights will be honoured within the standard settlement period regardless of termination.</div>

            <div style="font-size:11px;font-weight:800;letter-spacing:.08em;text-transform:uppercase;color:var(--gold2);margin-bottom:6px">7. Amendments</div>
            <div style="margin-bottom:8px">The Platform may update this agreement from time to time. Material changes will be communicated with at least 30 days' notice. Continued use of the Platform following the notice period constitutes acceptance of the revised terms. For enquiries or amendments, contact <span style="color:var(--gold2)">partnerships@aviateatelier.com</span>.</div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>
      <!-- STATUS TAB -->
      <div id="dtab-status" style="display:none">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
          <div>
            <div style="font-family:'Playfair Display',serif;font-size:22px;font-weight:600;color:var(--text)">Fleet Status Board</div>
            <div style="font-size:12px;color:var(--text3);margin-top:3px">Real-time status for every registered aircraft</div>
          </div>
          <div style="display:flex;gap:8px;flex-wrap:wrap"><div style="display:flex;align-items:center;gap:5px;padding:4px 10px;border-radius:7px;background:rgba(255,255,255,0.03);border:1px solid var(--border2)"><div style="width:7px;height:7px;border-radius:50%;background:#4FD080"></div><span style="font-size:10px;color:var(--text3);font-weight:600">Available</span></div><div style="display:flex;align-items:center;gap:5px;padding:4px 10px;border-radius:7px;background:rgba(255,255,255,0.03);border:1px solid var(--border2)"><div style="width:7px;height:7px;border-radius:50%;background:#58A6FF"></div><span style="font-size:10px;color:var(--text3);font-weight:600">In Flight</span></div><div style="display:flex;align-items:center;gap:5px;padding:4px 10px;border-radius:7px;background:rgba(255,255,255,0.03);border:1px solid var(--border2)"><div style="width:7px;height:7px;border-radius:50%;background:var(--gold2)"></div><span style="font-size:10px;color:var(--text3);font-weight:600">Scheduled</span></div><div style="display:flex;align-items:center;gap:5px;padding:4px 10px;border-radius:7px;background:rgba(255,255,255,0.03);border:1px solid var(--border2)"><div style="width:7px;height:7px;border-radius:50%;background:#FF6B6B"></div><span style="font-size:10px;color:var(--text3);font-weight:600">Maintenance</span></div><div style="display:flex;align-items:center;gap:5px;padding:4px 10px;border-radius:7px;background:rgba(255,255,255,0.03);border:1px solid var(--border2)"><div style="width:7px;height:7px;border-radius:50%;background:#FF3B30"></div><span style="font-size:10px;color:var(--text3);font-weight:600">AOG</span></div><div style="display:flex;align-items:center;gap:5px;padding:4px 10px;border-radius:7px;background:rgba(255,255,255,0.03);border:1px solid var(--border2)"><div style="width:7px;height:7px;border-radius:50%;background:#FF9F43"></div><span style="font-size:10px;color:var(--text3);font-weight:600">Ferry</span></div>
          </div>
        </div>

        <!-- Live Tracking Banner -->
        <div style="background:rgba(88,166,255,0.06);border:1px solid rgba(88,166,255,0.2);border-radius:14px;padding:16px 20px;margin-bottom:20px;display:flex;align-items:center;gap:14px">
          <div style="width:40px;height:40px;background:rgba(88,166,255,0.1);border-radius:10px;display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:18px">üì°</div>
          <div style="flex:1">
            <div style="font-size:13px;font-weight:700;color:var(--text);margin-bottom:3px">Live ADS-B Tracking ‚Äî Coming Soon</div>
            <div style="font-size:12px;color:var(--text3)">Real-time GPS position, altitude, speed and route via ADS-B feed. Connect your FlightAware or FlightRadar24 API key in Settings to enable.</div>
          </div>
          <div style="font-size:10px;font-weight:800;padding:5px 12px;border-radius:8px;background:rgba(88,166,255,0.1);border:1px solid rgba(88,166,255,0.25);color:#58A6FF;white-space:nowrap">API Setup ‚Üí</div>
        </div>

        <div id="fleet-status-board" style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px">
          <div style="font-size:12px;color:var(--text3);padding:24px 0;text-align:center;grid-column:1/-1">No aircraft registered yet</div>
        </div>

        <!-- Demo seed for prototype -->
        <div style="margin-top:16px;text-align:center">
          <button onclick="seedDemoFleet()" style="height:34px;padding:0 16px;border:1px dashed var(--border2);background:transparent;border-radius:9px;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:11px;cursor:pointer">Load Demo Fleet</button>
        </div>
      </div>

      <!-- ACTIVITY LOG TAB -->
      <div id="dtab-activity" style="display:none">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
          <div>
            <div style="font-family:'Playfair Display',serif;font-size:22px;font-weight:600;color:var(--text)">Activity Log</div>
            <div style="font-size:12px;color:var(--text3);margin-top:3px">All actions by owner, directors, dispatchers and schedulers</div>
          </div>
          <button onclick="ACTIVITY_LOG=[];renderActivityLog();showToast('success','check','Log cleared','Activity log has been reset.')" style="height:34px;padding:0 14px;border:1px solid var(--border2);background:transparent;border-radius:9px;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:11px;cursor:pointer">Clear Log</button>
        </div>

        <div style="display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap">
          <button onclick="filterActivity('')" id="alog-all" style="height:30px;padding:0 12px;border-radius:8px;border:1px solid var(--gold2);background:rgba(229,168,60,0.1);color:var(--gold2);font-family:'DM Sans',sans-serif;font-size:11px;font-weight:700;cursor:pointer">All</button>
          <button onclick="filterActivity('booking')" id="alog-booking" style="height:30px;padding:0 12px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:11px;cursor:pointer">Bookings</button>
          <button onclick="filterActivity('fleet')" id="alog-fleet" style="height:30px;padding:0 12px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:11px;cursor:pointer">Fleet</button>
          <button onclick="filterActivity('team')" id="alog-team" style="height:30px;padding:0 12px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:11px;cursor:pointer">Team</button>
          <button onclick="filterActivity('quote')" id="alog-quote" style="height:30px;padding:0 12px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:11px;cursor:pointer">Quotes</button>
        </div>

        <div style="background:var(--card);border:1px solid var(--border2);border-radius:14px;padding:16px 20px">
          <div id="activity-log-list">
            <div style="font-size:12px;color:var(--text3);padding:24px 0;text-align:center">No activity recorded yet</div>
          </div>
        </div>
      </div>

<!-- CLIENT DASHBOARD -->

<!-- QUOTE MODAL -->
<div class="modal-overlay" id="quote-modal">
  <div class="modal" style="max-width:500px">
    <div class="modal-title">Submit a Quote</div>
    <div class="modal-sub" id="qm-sub">‚Äî</div>
    <div class="modal-label">Your All-In Quote Price (USD)</div>
    <input class="modal-input" type="number" id="qm-price" value="14800" oninput="updateSettle()">
    <div class="modal-row-2">
      <div>
        <div class="modal-label">Aircraft</div>
        <select class="modal-select" id="qm-ac"><option>Citation CJ3+</option><option>Hawker 800XP</option></select>
      </div>
      <div>
        <div class="modal-label">Est. Flight Time</div>
        <select class="modal-select" id="qm-time">
          <option>~1h 30m</option><option>~2h 00m</option><option selected>~2h 30m</option>
          <option>~3h 00m</option><option>~3h 30m</option><option>~4h 00m</option>
          <option>~5h 00m</option><option>~6h 00m</option><option>~7h+ (intl)</option>
        </select>
      </div>
    </div>
    <div class="modal-row-2" style="margin-bottom:12px">
      <div>
        <div class="modal-label">Quote Valid For</div>
        <select class="modal-select" id="qm-expiry">
          <option value="6">6 hours</option>
          <option value="12">12 hours</option>
          <option value="24" selected>24 hours</option>
          <option value="48">48 hours</option>
          <option value="72">72 hours</option>
        </select>
      </div>
    </div>
    <div style="margin-bottom:12px">
      <div class="modal-label">Note to Client (Optional)</div>
      <textarea id="qm-notes" placeholder="e.g. Catering included, WiFi onboard, departs from FBO North terminal..." style="width:100%;height:56px;background:var(--bg3);border:1.5px solid var(--border2);border-radius:10px;padding:10px 12px;font-family:'DM Sans',sans-serif;font-size:13px;color:var(--text);resize:none;outline:none;box-sizing:border-box"></textarea>
    </div>
    <div class="settlement-preview">
      <div style="font-size:10px;font-weight:700;letter-spacing:.1em;text-transform:uppercase;color:var(--text3);margin-bottom:10px">Your Payout Breakdown</div>
      <div class="sp-row"><div class="sp-label">Quote to client</div><div class="sp-value" id="sp-quote">$14,800</div></div>
      <div class="sp-row"><div class="sp-label">Platform fee</div><div class="sp-value" id="sp-fee" style="color:var(--text3)">‚Äî</div></div>
      <div class="sp-row total"><div class="sp-label">Your settlement</div><div class="sp-value" id="sp-net">$14,800</div></div>
      <div class="sp-note">Settlement within 2 business days of flight completion ¬∑ 2% platform fee</div>
    </div>
    <div class="modal-btns">
      <button class="modal-cancel" onclick="closeModal()">Cancel</button>
      <button class="modal-submit" id="qm-submit-btn" onclick="submitQuote()">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M2 8l4 4 8-8"/></svg>
        Send Quote to Client
      </button>
    </div>
  </div>
</div>

<!-- QUOTE COMPARISON MODAL (client side) -->
<div class="modal-overlay" id="quote-compare-modal">
  <div class="modal" style="max-width:560px;padding:0">
    <div style="padding:24px 24px 16px;border-bottom:1px solid var(--border2)">
      <div class="modal-title" style="margin-bottom:4px">Compare Quotes</div>
      <div style="font-size:12px;color:var(--text3)">Select the option that works best for you. Prices are all-inclusive.</div>
    </div>
    <div style="padding:20px;max-height:60vh;overflow-y:auto">
      <div id="qc-loading" style="text-align:center;padding:24px;color:var(--text3);font-size:13px">Loading quotes...</div>
      <div id="qc-cards" style="display:grid;grid-template-columns:1fr 1fr;gap:12px"></div>
    </div>
    <div style="padding:16px 24px;border-top:1px solid var(--border2);display:flex;justify-content:flex-end">
      <button onclick="closeQuoteComparison()" style="height:36px;padding:0 20px;border-radius:9px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:13px;cursor:pointer">Close</button>
    </div>
  </div>
</div>

<!-- PIC PRE-DEPARTURE CHECKLIST MODAL -->
<div class="modal-overlay" id="pic-checklist-modal">
  <div class="modal" style="max-width:460px">
    <div class="modal-title">Pre-Departure Checklist</div>
    <div class="modal-sub" id="pic-route-label">Flight Route</div>
    <div style="font-size:11px;color:var(--gold2);font-weight:700;margin-bottom:16px;background:rgba(229,168,60,0.08);border-radius:8px;padding:8px 12px">
      ‚ö† FAA Part 135 ‚Äî PIC must confirm all items before departure
    </div>
    <div style="display:flex;flex-direction:column;gap:10px;margin-bottom:20px">
      <label style="display:flex;align-items:center;gap:12px;padding:12px 14px;background:var(--bg3);border:1px solid var(--border2);border-radius:10px;cursor:pointer">
        <input type="checkbox" id="pic-chk-manifest" onchange="checkPicReady()" style="width:16px;height:16px;cursor:pointer">
        <div><div style="font-size:13px;font-weight:600;color:var(--text)">Passenger Manifest Verified</div><div style="font-size:11px;color:var(--text3)">All passenger IDs confirmed and on file</div></div>
      </label>
      <label style="display:flex;align-items:center;gap:12px;padding:12px 14px;background:var(--bg3);border:1px solid var(--border2);border-radius:10px;cursor:pointer">
        <input type="checkbox" id="pic-chk-fuel" onchange="checkPicReady()" style="width:16px;height:16px;cursor:pointer">
        <div><div style="font-size:13px;font-weight:600;color:var(--text)">Fuel Load Confirmed</div><div style="font-size:11px;color:var(--text3)">Required + reserves verified with dispatch</div></div>
      </label>
      <label style="display:flex;align-items:center;gap:12px;padding:12px 14px;background:var(--bg3);border:1px solid var(--border2);border-radius:10px;cursor:pointer">
        <input type="checkbox" id="pic-chk-wx" onchange="checkPicReady()" style="width:16px;height:16px;cursor:pointer">
        <div><div style="font-size:13px;font-weight:600;color:var(--text)">Weather Briefing Complete</div><div style="font-size:11px;color:var(--text3)">Departure, en-route and destination weather reviewed</div></div>
      </label>
      <label style="display:flex;align-items:center;gap:12px;padding:12px 14px;background:var(--bg3);border:1px solid var(--border2);border-radius:10px;cursor:pointer">
        <input type="checkbox" id="pic-chk-notam" onchange="checkPicReady()" style="width:16px;height:16px;cursor:pointer">
        <div><div style="font-size:13px;font-weight:600;color:var(--text)">NOTAMs Reviewed</div><div style="font-size:11px;color:var(--text3)">All applicable NOTAMs checked and noted</div></div>
      </label>
      <label style="display:flex;align-items:center;gap:12px;padding:12px 14px;background:var(--bg3);border:1px solid var(--border2);border-radius:10px;cursor:pointer">
        <input type="checkbox" id="pic-chk-preflight" onchange="checkPicReady()" style="width:16px;height:16px;cursor:pointer">
        <div><div style="font-size:13px;font-weight:600;color:var(--text)">Aircraft Preflight Complete</div><div style="font-size:11px;color:var(--text3)">Aircraft inspected, airworthy and ready for flight</div></div>
      </label>
      <label style="display:flex;align-items:center;gap:12px;padding:12px 14px;background:var(--bg3);border:1px solid var(--border2);border-radius:10px;cursor:pointer">
        <input type="checkbox" id="pic-chk-docs" onchange="checkPicReady()" style="width:16px;height:16px;cursor:pointer">
        <div><div style="font-size:13px;font-weight:600;color:var(--text)">Documents On Board</div><div style="font-size:11px;color:var(--text3)">A/W cert, registration, ops specs and manuals verified</div></div>
      </label>
    </div>
    <div class="modal-btns">
      <button class="modal-cancel" onclick="closePicChecklist()">Cancel</button>
      <button class="modal-submit" id="pic-confirm-btn" onclick="confirmPicDeparture()" disabled style="opacity:.5">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M2 8l4 4 8-8"/></svg>
        PIC Confirms ‚Äî Clear for Departure
      </button>
    </div>
  </div>
</div>



<div class="toast" id="toast">
  <div class="toast-icon-wrap" id="toast-icon-wrap">
    <svg id="toast-icon" width="18" height="18" viewBox="0 0 18 18" fill="none" stroke="var(--green2)" stroke-width="2"><path d="M3 9l5 5 7-8"/></svg>
  </div>
  <div><div class="toast-title" id="toast-title">Done</div><div class="toast-sub" id="toast-sub"></div>
<script>
// ‚îÄ‚îÄ SUPABASE CLIENT ‚îÄ‚îÄ
const _sb = supabase.createClient(
  'https://hkjldgjvxgrutnqzwfql.supabase.co',
  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhramxkZ2p2eGdydXRucXp3ZnFsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwNDMwOTYsImV4cCI6MjA4NzYxOTA5Nn0.aNICtFHRMeP5Xu9ssgLlziC6cbR6-WXcTCbM1UY1q3g'
);
var _opUser = null;
var _opRecord = null;

// Check session on load
(async function() {
  const { data: { session } } = await _sb.auth.getSession();
  if (session) {
    const { data: op } = await _sb.from('operators').select('*').eq('user_id', session.user.id).single();
    if (op) { _opRecord = op; _opUser = session.user; loadDashboard(); }
  }
})();

const AIRCRAFT_DB = [

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // VLJ ‚Äî VERY LIGHT JETS
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  { make:"Cirrus",        model:"Vision Jet G2+",         category:"VLJ",             pax:5,  range_nm:1200, speed_ktas:300, ceiling_ft:31000, engines:1, engine_type:"Turbofan",   baggage_cuft:15,  hourly_est:2800 },
  { make:"Honda",         model:"HondaJet Elite II",       category:"VLJ",             pax:5,  range_nm:1437, speed_ktas:422, ceiling_ft:43000, engines:2, engine_type:"Turbofan",   baggage_cuft:57,  hourly_est:3200 },
  { make:"Honda",         model:"HondaJet Elite S",        category:"VLJ",             pax:5,  range_nm:1400, speed_ktas:420, ceiling_ft:43000, engines:2, engine_type:"Turbofan",   baggage_cuft:57,  hourly_est:3100 },
  { make:"Eclipse",       model:"Eclipse 500",             category:"VLJ",             pax:4,  range_nm:1125, speed_ktas:370, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:20,  hourly_est:2200 },
  { make:"Eclipse",       model:"Eclipse 550",             category:"VLJ",             pax:4,  range_nm:1125, speed_ktas:375, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:20,  hourly_est:2500 },
  { make:"Adam",          model:"A700 AdamJet",            category:"VLJ",             pax:5,  range_nm:1400, speed_ktas:340, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:22,  hourly_est:2000 },
  { make:"Sino Swearingen", model:"SJ30-2",               category:"VLJ",             pax:6,  range_nm:2500, speed_ktas:480, ceiling_ft:49000, engines:2, engine_type:"Turbofan",   baggage_cuft:25,  hourly_est:2600 },

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // LIGHT JETS
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  { make:"Cessna",        model:"Citation Mustang",        category:"Light Jet",       pax:4,  range_nm:1150, speed_ktas:340, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:26,  hourly_est:2600 },
  { make:"Cessna",        model:"Citation M2 Gen2",        category:"Light Jet",       pax:7,  range_nm:1550, speed_ktas:400, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:26,  hourly_est:3200 },
  { make:"Cessna",        model:"Citation II",             category:"Light Jet",       pax:8,  range_nm:1622, speed_ktas:333, ceiling_ft:43000, engines:2, engine_type:"Turbofan",   baggage_cuft:50,  hourly_est:2400 },
  { make:"Cessna",        model:"Citation Bravo",          category:"Light Jet",       pax:8,  range_nm:1600, speed_ktas:381, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:59,  hourly_est:2600 },
  { make:"Cessna",        model:"Citation Encore",         category:"Light Jet",       pax:8,  range_nm:1630, speed_ktas:400, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:59,  hourly_est:2700 },
  { make:"Cessna",        model:"Citation Encore+",        category:"Light Jet",       pax:8,  range_nm:1700, speed_ktas:405, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:59,  hourly_est:2800 },
  { make:"Cessna",        model:"Citation CJ1+",           category:"Light Jet",       pax:6,  range_nm:1555, speed_ktas:380, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:40,  hourly_est:2900 },
  { make:"Cessna",        model:"Citation CJ2+",           category:"Light Jet",       pax:7,  range_nm:1613, speed_ktas:400, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:50,  hourly_est:3100 },
  { make:"Cessna",        model:"Citation CJ3+",           category:"Light Jet",       pax:8,  range_nm:2040, speed_ktas:416, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:60,  hourly_est:3500 },
  { make:"Cessna",        model:"Citation CJ4 Gen2",       category:"Light Jet",       pax:9,  range_nm:2165, speed_ktas:451, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:77,  hourly_est:3800 },
  { make:"Embraer",       model:"Phenom 100",              category:"Light Jet",       pax:4,  range_nm:1178, speed_ktas:390, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:53,  hourly_est:2700 },
  { make:"Embraer",       model:"Phenom 100EV",            category:"Light Jet",       pax:4,  range_nm:1178, speed_ktas:390, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:53,  hourly_est:2900 },
  { make:"Embraer",       model:"Phenom 300",              category:"Light Jet",       pax:8,  range_nm:1971, speed_ktas:450, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:84,  hourly_est:3500 },
  { make:"Embraer",       model:"Phenom 300E",             category:"Light Jet",       pax:8,  range_nm:2010, speed_ktas:453, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:84,  hourly_est:3700 },
  { make:"Pilatus",       model:"PC-24",                   category:"Light Jet",       pax:9,  range_nm:2000, speed_ktas:440, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:115, hourly_est:4200 },
  { make:"Bombardier",    model:"Learjet 31A",             category:"Light Jet",       pax:7,  range_nm:1520, speed_ktas:464, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:40,  hourly_est:2800 },
  { make:"Bombardier",    model:"Learjet 35A",             category:"Light Jet",       pax:8,  range_nm:2523, speed_ktas:464, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:40,  hourly_est:2600 },
  { make:"Bombardier",    model:"Learjet 36A",             category:"Light Jet",       pax:6,  range_nm:2795, speed_ktas:464, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:20,  hourly_est:2600 },
  { make:"Bombardier",    model:"Learjet 40XR",            category:"Light Jet",       pax:7,  range_nm:1640, speed_ktas:465, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:47,  hourly_est:3200 },
  { make:"Bombardier",    model:"Learjet 45XR",            category:"Light Jet",       pax:8,  range_nm:2120, speed_ktas:465, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:50,  hourly_est:3400 },
  { make:"Bombardier",    model:"Learjet 75 Liberty",      category:"Light Jet",       pax:8,  range_nm:2080, speed_ktas:465, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:55,  hourly_est:4000 },
  { make:"Beechcraft",    model:"Premier IA",              category:"Light Jet",       pax:6,  range_nm:1500, speed_ktas:461, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:57,  hourly_est:3300 },
  { make:"Beechcraft",    model:"Beechjet 400A",           category:"Light Jet",       pax:8,  range_nm:1634, speed_ktas:462, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:53,  hourly_est:2800 },
  { make:"Nextant",       model:"400XTi",                  category:"Light Jet",       pax:8,  range_nm:2200, speed_ktas:464, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:55,  hourly_est:3600 },
  { make:"IAI",           model:"Westwind 1124",           category:"Light Jet",       pax:7,  range_nm:2536, speed_ktas:447, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:40,  hourly_est:2400 },
  { make:"IAI",           model:"Westwind 1124A",          category:"Light Jet",       pax:7,  range_nm:2700, speed_ktas:447, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:40,  hourly_est:2500 },
  { make:"IAI",           model:"Astra SP",                category:"Light Jet",       pax:7,  range_nm:2993, speed_ktas:447, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:53,  hourly_est:2700 },
  { make:"IAI",           model:"Astra SPX",               category:"Light Jet",       pax:7,  range_nm:3496, speed_ktas:470, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:53,  hourly_est:3000 },

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // MIDSIZE JETS
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  { make:"Cessna",        model:"Citation Ultra",          category:"Midsize",         pax:9,  range_nm:1940, speed_ktas:430, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:58,  hourly_est:3600 },
  { make:"Cessna",        model:"Citation Excel",          category:"Midsize",         pax:9,  range_nm:2050, speed_ktas:433, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:78,  hourly_est:3800 },
  { make:"Cessna",        model:"Citation XLS",            category:"Midsize",         pax:9,  range_nm:2100, speed_ktas:441, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:78,  hourly_est:4000 },
  { make:"Cessna",        model:"Citation XLS Gen2",       category:"Midsize",         pax:9,  range_nm:2100, speed_ktas:441, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:78,  hourly_est:4200 },
  { make:"Cessna",        model:"Citation Latitude",       category:"Midsize",         pax:9,  range_nm:2700, speed_ktas:446, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:127, hourly_est:4800 },
  { make:"Cessna",        model:"Citation III",            category:"Midsize",         pax:9,  range_nm:2495, speed_ktas:462, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:57,  hourly_est:3200 },
  { make:"Cessna",        model:"Citation VI",             category:"Midsize",         pax:9,  range_nm:2495, speed_ktas:462, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:57,  hourly_est:3300 },
  { make:"Cessna",        model:"Citation VII",            category:"Midsize",         pax:9,  range_nm:2400, speed_ktas:472, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:57,  hourly_est:3400 },
  { make:"Cessna",        model:"Citation X",              category:"Midsize",         pax:8,  range_nm:3460, speed_ktas:525, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:76,  hourly_est:4500 },
  { make:"Cessna",        model:"Citation X+",             category:"Midsize",         pax:8,  range_nm:3460, speed_ktas:527, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:76,  hourly_est:4800 },
  { make:"Embraer",       model:"Legacy 450",              category:"Midsize",         pax:8,  range_nm:2904, speed_ktas:466, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:122, hourly_est:4800 },
  { make:"Embraer",       model:"Praetor 500",             category:"Midsize",         pax:9,  range_nm:3340, speed_ktas:466, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:122, hourly_est:5200 },
  { make:"Bombardier",    model:"Learjet 55",              category:"Midsize",         pax:8,  range_nm:2485, speed_ktas:460, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:50,  hourly_est:3000 },
  { make:"Bombardier",    model:"Learjet 60",              category:"Midsize",         pax:8,  range_nm:2405, speed_ktas:461, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:45,  hourly_est:3600 },
  { make:"Bombardier",    model:"Learjet 60 XR",           category:"Midsize",         pax:8,  range_nm:2405, speed_ktas:461, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:45,  hourly_est:4400 },
  { make:"Bombardier",    model:"Challenger 350",          category:"Midsize",         pax:10, range_nm:3200, speed_ktas:470, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:106, hourly_est:5500 },
  { make:"Hawker",        model:"Hawker 700A",             category:"Midsize",         pax:8,  range_nm:2516, speed_ktas:420, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:38,  hourly_est:3000 },
  { make:"Hawker",        model:"Hawker 750",              category:"Midsize",         pax:8,  range_nm:2800, speed_ktas:437, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:50,  hourly_est:3500 },
  { make:"Hawker",        model:"Hawker 800",              category:"Midsize",         pax:8,  range_nm:2650, speed_ktas:440, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:50,  hourly_est:3500 },
  { make:"Hawker",        model:"Hawker 800A",             category:"Midsize",         pax:8,  range_nm:2700, speed_ktas:440, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:50,  hourly_est:3700 },
  { make:"Hawker",        model:"Hawker 800XP",            category:"Midsize",         pax:8,  range_nm:2830, speed_ktas:448, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:50,  hourly_est:4200 },
  { make:"Hawker",        model:"Hawker 900XP",            category:"Midsize",         pax:9,  range_nm:2930, speed_ktas:448, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:50,  hourly_est:4400 },
  { make:"Hawker",        model:"Hawker 1000",             category:"Midsize",         pax:9,  range_nm:3150, speed_ktas:448, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:50,  hourly_est:4600 },
  { make:"Raytheon",      model:"Hawker 400XP",            category:"Midsize",         pax:8,  range_nm:1734, speed_ktas:462, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:53,  hourly_est:3200 },
  { make:"Dassault",      model:"Falcon 10",               category:"Midsize",         pax:6,  range_nm:1800, speed_ktas:480, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:35,  hourly_est:2800 },
  { make:"Dassault",      model:"Falcon 20",               category:"Midsize",         pax:8,  range_nm:2000, speed_ktas:469, ceiling_ft:42000, engines:2, engine_type:"Turbofan",   baggage_cuft:50,  hourly_est:3200 },
  { make:"Dassault",      model:"Falcon 50",               category:"Midsize",         pax:8,  range_nm:3080, speed_ktas:467, ceiling_ft:49000, engines:3, engine_type:"Turbofan",   baggage_cuft:55,  hourly_est:4000 },
  { make:"Dassault",      model:"Falcon 50EX",             category:"Midsize",         pax:8,  range_nm:3260, speed_ktas:467, ceiling_ft:49000, engines:3, engine_type:"Turbofan",   baggage_cuft:55,  hourly_est:5000 },
  { make:"Piaggio",       model:"P180 Avanti",             category:"Midsize",         pax:8,  range_nm:1500, speed_ktas:400, ceiling_ft:41000, engines:2, engine_type:"Turboprop",  baggage_cuft:46,  hourly_est:3200 },
  { make:"Piaggio",       model:"P180 Avanti II",          category:"Midsize",         pax:9,  range_nm:1550, speed_ktas:402, ceiling_ft:41000, engines:2, engine_type:"Turboprop",  baggage_cuft:46,  hourly_est:3500 },
  { make:"Piaggio",       model:"P180 Avanti EVO",         category:"Midsize",         pax:9,  range_nm:1600, speed_ktas:402, ceiling_ft:41000, engines:2, engine_type:"Turboprop",  baggage_cuft:46,  hourly_est:3600 },
  { make:"IAI",           model:"Galaxy",                  category:"Midsize",         pax:10, range_nm:3400, speed_ktas:469, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:60,  hourly_est:4800 },
  { make:"IAI",           model:"Gulfstream G100",         category:"Midsize",         pax:8,  range_nm:2950, speed_ktas:469, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:53,  hourly_est:4000 },
  { make:"IAI",           model:"Gulfstream G150",         category:"Midsize",         pax:8,  range_nm:3000, speed_ktas:470, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:53,  hourly_est:4200 },
  { make:"Textron",       model:"Citation Sovereign",      category:"Midsize",         pax:9,  range_nm:2847, speed_ktas:458, ceiling_ft:47000, engines:2, engine_type:"Turbofan",   baggage_cuft:135, hourly_est:5000 },
  { make:"Textron",       model:"Citation Sovereign+",     category:"Midsize",         pax:9,  range_nm:3200, speed_ktas:458, ceiling_ft:47000, engines:2, engine_type:"Turbofan",   baggage_cuft:135, hourly_est:5400 },

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // SUPER MIDSIZE JETS
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  { make:"Cessna",        model:"Citation Longitude",      category:"Super Midsize",   pax:12, range_nm:3500, speed_ktas:476, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:150, hourly_est:5800 },
  { make:"Embraer",       model:"Legacy 500",              category:"Super Midsize",   pax:12, range_nm:3125, speed_ktas:466, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:140, hourly_est:5500 },
  { make:"Embraer",       model:"Praetor 600",             category:"Super Midsize",   pax:12, range_nm:4018, speed_ktas:466, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:140, hourly_est:6200 },
  { make:"Bombardier",    model:"Challenger 300",          category:"Super Midsize",   pax:9,  range_nm:3100, speed_ktas:470, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:106, hourly_est:5200 },
  { make:"Bombardier",    model:"Challenger 3500",         category:"Super Midsize",   pax:10, range_nm:3400, speed_ktas:470, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:106, hourly_est:5600 },
  { make:"Dassault",      model:"Falcon 2000",             category:"Super Midsize",   pax:10, range_nm:3350, speed_ktas:482, ceiling_ft:47000, engines:2, engine_type:"Turbofan",   baggage_cuft:95,  hourly_est:5500 },
  { make:"Dassault",      model:"Falcon 2000EX",           category:"Super Midsize",   pax:10, range_nm:3900, speed_ktas:482, ceiling_ft:47000, engines:2, engine_type:"Turbofan",   baggage_cuft:95,  hourly_est:6000 },
  { make:"Dassault",      model:"Falcon 2000LX",           category:"Super Midsize",   pax:10, range_nm:4000, speed_ktas:482, ceiling_ft:47000, engines:2, engine_type:"Turbofan",   baggage_cuft:95,  hourly_est:6200 },
  { make:"Dassault",      model:"Falcon 2000LXS",          category:"Super Midsize",   pax:10, range_nm:4000, speed_ktas:482, ceiling_ft:47000, engines:2, engine_type:"Turbofan",   baggage_cuft:95,  hourly_est:6500 },
  { make:"Gulfstream",    model:"G200",                    category:"Super Midsize",   pax:10, range_nm:3400, speed_ktas:482, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:110, hourly_est:5400 },
  { make:"Gulfstream",    model:"G280",                    category:"Super Midsize",   pax:10, range_nm:3600, speed_ktas:482, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:120, hourly_est:5800 },

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // LARGE / HEAVY JETS
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  { make:"Gulfstream",    model:"GIV",                     category:"Heavy",           pax:14, range_nm:4220, speed_ktas:476, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:169, hourly_est:7500 },
  { make:"Gulfstream",    model:"GIV-SP",                  category:"Heavy",           pax:14, range_nm:4220, speed_ktas:476, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:169, hourly_est:7800 },
  { make:"Gulfstream",    model:"G300",                    category:"Heavy",           pax:14, range_nm:3850, speed_ktas:476, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:169, hourly_est:7200 },
  { make:"Gulfstream",    model:"G350",                    category:"Heavy",           pax:14, range_nm:3850, speed_ktas:476, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:169, hourly_est:7400 },
  { make:"Gulfstream",    model:"G400",                    category:"Heavy",           pax:14, range_nm:4200, speed_ktas:490, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:180, hourly_est:9000 },
  { make:"Gulfstream",    model:"G450",                    category:"Heavy",           pax:14, range_nm:4350, speed_ktas:476, ceiling_ft:45000, engines:2, engine_type:"Turbofan",   baggage_cuft:169, hourly_est:8500 },
  { make:"Gulfstream",    model:"G500",                    category:"Heavy",           pax:19, range_nm:5200, speed_ktas:516, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:235, hourly_est:9500 },
  { make:"Gulfstream",    model:"GV",                      category:"Heavy",           pax:16, range_nm:6500, speed_ktas:488, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:226, hourly_est:9000 },
  { make:"Gulfstream",    model:"GV-SP (G550)",            category:"Heavy",           pax:18, range_nm:6750, speed_ktas:488, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:226, hourly_est:9500 },
  { make:"Gulfstream",    model:"G600",                    category:"Heavy",           pax:19, range_nm:6500, speed_ktas:516, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:235, hourly_est:10500 },
  { make:"Bombardier",    model:"Challenger 600",          category:"Heavy",           pax:12, range_nm:3600, speed_ktas:454, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:115, hourly_est:5800 },
  { make:"Bombardier",    model:"Challenger 601-1A",       category:"Heavy",           pax:12, range_nm:4000, speed_ktas:454, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:115, hourly_est:6000 },
  { make:"Bombardier",    model:"Challenger 601-3A",       category:"Heavy",           pax:12, range_nm:4000, speed_ktas:454, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:115, hourly_est:6200 },
  { make:"Bombardier",    model:"Challenger 604",          category:"Heavy",           pax:12, range_nm:4112, speed_ktas:459, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:115, hourly_est:7000 },
  { make:"Bombardier",    model:"Challenger 605",          category:"Heavy",           pax:12, range_nm:4045, speed_ktas:459, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:115, hourly_est:7200 },
  { make:"Bombardier",    model:"Challenger 650",          category:"Heavy",           pax:12, range_nm:4000, speed_ktas:459, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:115, hourly_est:7500 },
  { make:"Bombardier",    model:"Global 5000",             category:"Heavy",           pax:16, range_nm:5200, speed_ktas:488, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:195, hourly_est:8500 },
  { make:"Bombardier",    model:"Global 5500",             category:"Heavy",           pax:16, range_nm:5900, speed_ktas:488, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:195, hourly_est:9000 },
  { make:"Bombardier",    model:"Global 6000",             category:"Heavy",           pax:17, range_nm:6000, speed_ktas:488, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:195, hourly_est:9500 },
  { make:"Bombardier",    model:"Global 6500",             category:"Heavy",           pax:17, range_nm:6600, speed_ktas:488, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:195, hourly_est:10000 },
  { make:"Dassault",      model:"Falcon 900B",             category:"Heavy",           pax:12, range_nm:4050, speed_ktas:480, ceiling_ft:51000, engines:3, engine_type:"Turbofan",   baggage_cuft:127, hourly_est:7500 },
  { make:"Dassault",      model:"Falcon 900C",             category:"Heavy",           pax:12, range_nm:4180, speed_ktas:480, ceiling_ft:51000, engines:3, engine_type:"Turbofan",   baggage_cuft:127, hourly_est:7700 },
  { make:"Dassault",      model:"Falcon 900EX",            category:"Heavy",           pax:14, range_nm:4535, speed_ktas:480, ceiling_ft:51000, engines:3, engine_type:"Turbofan",   baggage_cuft:127, hourly_est:8000 },
  { make:"Dassault",      model:"Falcon 900DX",            category:"Heavy",           pax:14, range_nm:3900, speed_ktas:480, ceiling_ft:51000, engines:3, engine_type:"Turbofan",   baggage_cuft:127, hourly_est:7800 },
  { make:"Dassault",      model:"Falcon 900LX",            category:"Heavy",           pax:14, range_nm:4750, speed_ktas:480, ceiling_ft:51000, engines:3, engine_type:"Turbofan",   baggage_cuft:127, hourly_est:8500 },
  { make:"Dassault",      model:"Falcon 6X",               category:"Heavy",           pax:16, range_nm:5500, speed_ktas:513, ceiling_ft:51000, engines:2, engine_type:"Turbofan",   baggage_cuft:140, hourly_est:11000 },

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // ULTRA LONG RANGE
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  { make:"Gulfstream",    model:"G650",                    category:"Ultra Long Range", pax:18, range_nm:7000, speed_ktas:516, ceiling_ft:51000, engines:2, engine_type:"Turbofan",  baggage_cuft:195, hourly_est:11000 },
  { make:"Gulfstream",    model:"G650ER",                  category:"Ultra Long Range", pax:19, range_nm:7500, speed_ktas:516, ceiling_ft:51000, engines:2, engine_type:"Turbofan",  baggage_cuft:195, hourly_est:11500 },
  { make:"Gulfstream",    model:"G700",                    category:"Ultra Long Range", pax:19, range_nm:7500, speed_ktas:516, ceiling_ft:51000, engines:2, engine_type:"Turbofan",  baggage_cuft:235, hourly_est:13000 },
  { make:"Gulfstream",    model:"G800",                    category:"Ultra Long Range", pax:19, range_nm:8000, speed_ktas:516, ceiling_ft:51000, engines:2, engine_type:"Turbofan",  baggage_cuft:235, hourly_est:14000 },
  { make:"Bombardier",    model:"Global 7500",             category:"Ultra Long Range", pax:19, range_nm:7700, speed_ktas:516, ceiling_ft:51000, engines:2, engine_type:"Turbofan",  baggage_cuft:231, hourly_est:12000 },
  { make:"Bombardier",    model:"Global 8000",             category:"Ultra Long Range", pax:19, range_nm:8000, speed_ktas:516, ceiling_ft:51000, engines:2, engine_type:"Turbofan",  baggage_cuft:231, hourly_est:14000 },
  { make:"Dassault",      model:"Falcon 7X",               category:"Ultra Long Range", pax:16, range_nm:5950, speed_ktas:482, ceiling_ft:51000, engines:3, engine_type:"Turbofan",  baggage_cuft:140, hourly_est:10500 },
  { make:"Dassault",      model:"Falcon 8X",               category:"Ultra Long Range", pax:16, range_nm:6450, speed_ktas:482, ceiling_ft:51000, engines:3, engine_type:"Turbofan",  baggage_cuft:140, hourly_est:11500 },
  { make:"Dassault",      model:"Falcon 10X",              category:"Ultra Long Range", pax:16, range_nm:7500, speed_ktas:516, ceiling_ft:51000, engines:2, engine_type:"Turbofan",  baggage_cuft:160, hourly_est:15000 },
  { make:"Airbus",        model:"ACJ318",                  category:"Ultra Long Range", pax:18, range_nm:4700, speed_ktas:470, ceiling_ft:41000, engines:2, engine_type:"Turbofan",  baggage_cuft:900, hourly_est:16000 },
  { make:"Airbus",        model:"ACJ319",                  category:"Ultra Long Range", pax:19, range_nm:6000, speed_ktas:470, ceiling_ft:41000, engines:2, engine_type:"Turbofan",  baggage_cuft:1000,hourly_est:17000 },
  { make:"Airbus",        model:"ACJ319neo",               category:"Ultra Long Range", pax:19, range_nm:6750, speed_ktas:470, ceiling_ft:41000, engines:2, engine_type:"Turbofan",  baggage_cuft:1000,hourly_est:18000 },
  { make:"Airbus",        model:"ACJ320neo",               category:"Ultra Long Range", pax:25, range_nm:6000, speed_ktas:470, ceiling_ft:41000, engines:2, engine_type:"Turbofan",  baggage_cuft:1200,hourly_est:20000 },
  { make:"Airbus",        model:"ACJ330",                  category:"Ultra Long Range", pax:50, range_nm:8000, speed_ktas:470, ceiling_ft:41000, engines:2, engine_type:"Turbofan",  baggage_cuft:3000,hourly_est:35000 },
  { make:"Boeing",        model:"BBJ 737-700",             category:"Ultra Long Range", pax:25, range_nm:6200, speed_ktas:470, ceiling_ft:41000, engines:2, engine_type:"Turbofan",  baggage_cuft:1000,hourly_est:20000 },
  { make:"Boeing",        model:"BBJ2 737-800",            category:"Ultra Long Range", pax:35, range_nm:5100, speed_ktas:470, ceiling_ft:41000, engines:2, engine_type:"Turbofan",  baggage_cuft:1200,hourly_est:22000 },
  { make:"Boeing",        model:"BBJ3 737-900ER",          category:"Ultra Long Range", pax:50, range_nm:4800, speed_ktas:470, ceiling_ft:41000, engines:2, engine_type:"Turbofan",  baggage_cuft:1500,hourly_est:25000 },
  { make:"Boeing",        model:"BBJ 787-8",               category:"Ultra Long Range", pax:40, range_nm:9800, speed_ktas:488, ceiling_ft:43000, engines:2, engine_type:"Turbofan",  baggage_cuft:3000,hourly_est:50000 },
  { make:"Embraer",       model:"Lineage 1000E",           category:"Ultra Long Range", pax:19, range_nm:4600, speed_ktas:470, ceiling_ft:41000, engines:2, engine_type:"Turbofan",  baggage_cuft:500, hourly_est:14000 },

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // REGIONAL JETS (Charter / ACMI)
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  { make:"Embraer",       model:"ERJ-135",                 category:"Regional Jet",    pax:37, range_nm:1600, speed_ktas:429, ceiling_ft:37000, engines:2, engine_type:"Turbofan",   baggage_cuft:400, hourly_est:5000 },
  { make:"Embraer",       model:"ERJ-145",                 category:"Regional Jet",    pax:50, range_nm:1550, speed_ktas:440, ceiling_ft:37000, engines:2, engine_type:"Turbofan",   baggage_cuft:600, hourly_est:6000 },
  { make:"Embraer",       model:"E175",                    category:"Regional Jet",    pax:80, range_nm:2200, speed_ktas:447, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:800, hourly_est:8000 },
  { make:"Bombardier",    model:"CRJ-200",                 category:"Regional Jet",    pax:50, range_nm:1650, speed_ktas:447, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:600, hourly_est:5500 },
  { make:"Bombardier",    model:"CRJ-700",                 category:"Regional Jet",    pax:70, range_nm:2050, speed_ktas:447, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:800, hourly_est:7000 },
  { make:"Bombardier",    model:"CRJ-900",                 category:"Regional Jet",    pax:90, range_nm:1900, speed_ktas:447, ceiling_ft:41000, engines:2, engine_type:"Turbofan",   baggage_cuft:900, hourly_est:8000 },
  { make:"Bombardier",    model:"Q400 (Dash 8-400)",       category:"Regional Jet",    pax:78, range_nm:1100, speed_ktas:360, ceiling_ft:25000, engines:2, engine_type:"Turboprop",  baggage_cuft:800, hourly_est:5500 },

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // TURBOPROPS ‚Äî SINGLE ENGINE
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  { make:"Pilatus",       model:"PC-12 NG",                category:"Turboprop",       pax:9,  range_nm:1845, speed_ktas:285, ceiling_ft:30000, engines:1, engine_type:"Turboprop",  baggage_cuft:60,  hourly_est:1700 },
  { make:"Pilatus",       model:"PC-12 NGX",               category:"Turboprop",       pax:9,  range_nm:1803, speed_ktas:290, ceiling_ft:30000, engines:1, engine_type:"Turboprop",  baggage_cuft:60,  hourly_est:1800 },
  { make:"Pilatus",       model:"PC-6 Porter",             category:"Turboprop",       pax:9,  range_nm:810,  speed_ktas:150, ceiling_ft:27000, engines:1, engine_type:"Turboprop",  baggage_cuft:60,  hourly_est:1100 },
  { make:"Cessna",        model:"Caravan 208",             category:"Turboprop",       pax:9,  range_nm:900,  speed_ktas:183, ceiling_ft:25000, engines:1, engine_type:"Turboprop",  baggage_cuft:70,  hourly_est:1100 },
  { make:"Cessna",        model:"Caravan 208B",            category:"Turboprop",       pax:13, range_nm:1070, speed_ktas:186, ceiling_ft:25000, engines:1, engine_type:"Turboprop",  baggage_cuft:80,  hourly_est:1200 },
  { make:"Cessna",        model:"Grand Caravan EX",        category:"Turboprop",       pax:14, range_nm:900,  speed_ktas:175, ceiling_ft:25000, engines:1, engine_type:"Turboprop",  baggage_cuft:80,  hourly_est:1200 },
  { make:"Cessna",        model:"Caravan 408 SkyCourier",  category:"Turboprop",       pax:19, range_nm:900,  speed_ktas:200, ceiling_ft:25000, engines:1, engine_type:"Turboprop",  baggage_cuft:100, hourly_est:1600 },
  { make:"Piper",         model:"M600/SLS",                category:"Turboprop",       pax:6,  range_nm:1484, speed_ktas:274, ceiling_ft:30000, engines:1, engine_type:"Turboprop",  baggage_cuft:40,  hourly_est:1500 },
  { make:"Daher",         model:"TBM 700",                 category:"Turboprop",       pax:6,  range_nm:1520, speed_ktas:300, ceiling_ft:31000, engines:1, engine_type:"Turboprop",  baggage_cuft:32,  hourly_est:1500 },
  { make:"Daher",         model:"TBM 850",                 category:"Turboprop",       pax:6,  range_nm:1665, speed_ktas:320, ceiling_ft:31000, engines:1, engine_type:"Turboprop",  baggage_cuft:32,  hourly_est:1600 },
  { make:"Daher",         model:"TBM 900",                 category:"Turboprop",       pax:6,  range_nm:1730, speed_ktas:330, ceiling_ft:31000, engines:1, engine_type:"Turboprop",  baggage_cuft:32,  hourly_est:1700 },
  { make:"Daher",         model:"TBM 940",                 category:"Turboprop",       pax:6,  range_nm:1730, speed_ktas:330, ceiling_ft:31000, engines:1, engine_type:"Turboprop",  baggage_cuft:32,  hourly_est:1700 },
  { make:"Daher",         model:"TBM 960",                 category:"Turboprop",       pax:6,  range_nm:1730, speed_ktas:330, ceiling_ft:31000, engines:1, engine_type:"Turboprop",  baggage_cuft:32,  hourly_est:1750 },
  { make:"Quest",         model:"Kodiak 100",              category:"Turboprop",       pax:9,  range_nm:1015, speed_ktas:183, ceiling_ft:25000, engines:1, engine_type:"Turboprop",  baggage_cuft:50,  hourly_est:1100 },
  { make:"Quest",         model:"Kodiak 900",              category:"Turboprop",       pax:9,  range_nm:1132, speed_ktas:210, ceiling_ft:27000, engines:1, engine_type:"Turboprop",  baggage_cuft:55,  hourly_est:1200 },

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // TURBOPROPS ‚Äî TWIN ENGINE
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  { make:"Beechcraft",    model:"King Air C90",            category:"Turboprop",       pax:7,  range_nm:990,  speed_ktas:248, ceiling_ft:30000, engines:2, engine_type:"Turboprop",  baggage_cuft:55,  hourly_est:1400 },
  { make:"Beechcraft",    model:"King Air C90GTx",         category:"Turboprop",       pax:7,  range_nm:1060, speed_ktas:270, ceiling_ft:30000, engines:2, engine_type:"Turboprop",  baggage_cuft:55,  hourly_est:1600 },
  { make:"Beechcraft",    model:"King Air 200",            category:"Turboprop",       pax:9,  range_nm:1580, speed_ktas:305, ceiling_ft:35000, engines:2, engine_type:"Turboprop",  baggage_cuft:55,  hourly_est:1800 },
  { make:"Beechcraft",    model:"King Air 250",            category:"Turboprop",       pax:8,  range_nm:1720, speed_ktas:312, ceiling_ft:35000, engines:2, engine_type:"Turboprop",  baggage_cuft:55,  hourly_est:2000 },
  { make:"Beechcraft",    model:"King Air 300",            category:"Turboprop",       pax:8,  range_nm:1730, speed_ktas:300, ceiling_ft:35000, engines:2, engine_type:"Turboprop",  baggage_cuft:55,  hourly_est:2000 },
  { make:"Beechcraft",    model:"King Air 350",            category:"Turboprop",       pax:11, range_nm:1806, speed_ktas:312, ceiling_ft:35000, engines:2, engine_type:"Turboprop",  baggage_cuft:55,  hourly_est:2200 },
  { make:"Beechcraft",    model:"King Air 350i",           category:"Turboprop",       pax:11, range_nm:1806, speed_ktas:312, ceiling_ft:35000, engines:2, engine_type:"Turboprop",  baggage_cuft:55,  hourly_est:2200 },
  { make:"Beechcraft",    model:"King Air 350ER",          category:"Turboprop",       pax:9,  range_nm:3185, speed_ktas:312, ceiling_ft:35000, engines:2, engine_type:"Turboprop",  baggage_cuft:55,  hourly_est:2400 },
  { make:"Beechcraft",    model:"King Air 360",            category:"Turboprop",       pax:11, range_nm:1806, speed_ktas:312, ceiling_ft:35000, engines:2, engine_type:"Turboprop",  baggage_cuft:55,  hourly_est:2400 },
  { make:"Beechcraft",    model:"1900D Airliner",          category:"Turboprop",       pax:19, range_nm:1600, speed_ktas:282, ceiling_ft:25000, engines:2, engine_type:"Turboprop",  baggage_cuft:100, hourly_est:2500 },
  { make:"Beechcraft",    model:"Super King Air B200",     category:"Turboprop",       pax:9,  range_nm:1580, speed_ktas:305, ceiling_ft:35000, engines:2, engine_type:"Turboprop",  baggage_cuft:55,  hourly_est:1900 },
  { make:"Piper",         model:"PA-42 Cheyenne III",      category:"Turboprop",       pax:9,  range_nm:1445, speed_ktas:290, ceiling_ft:35000, engines:2, engine_type:"Turboprop",  baggage_cuft:40,  hourly_est:1400 },
  { make:"Mitsubishi",    model:"MU-2 Marquise",           category:"Turboprop",       pax:9,  range_nm:1450, speed_ktas:315, ceiling_ft:31000, engines:2, engine_type:"Turboprop",  baggage_cuft:40,  hourly_est:1300 },
  { make:"Viking",        model:"Twin Otter Series 400",   category:"Turboprop",       pax:19, range_nm:750,  speed_ktas:182, ceiling_ft:25000, engines:2, engine_type:"Turboprop",  baggage_cuft:80,  hourly_est:1400 },
  { make:"Dornier",       model:"228-212",                 category:"Turboprop",       pax:19, range_nm:1100, speed_ktas:210, ceiling_ft:25000, engines:2, engine_type:"Turboprop",  baggage_cuft:80,  hourly_est:1400 },
  { make:"Dornier",       model:"328-100",                 category:"Turboprop",       pax:32, range_nm:830,  speed_ktas:335, ceiling_ft:25000, engines:2, engine_type:"Turboprop",  baggage_cuft:200, hourly_est:3000 },
  { make:"ATR",           model:"ATR 42-500",              category:"Turboprop",       pax:48, range_nm:930,  speed_ktas:300, ceiling_ft:25000, engines:2, engine_type:"Turboprop",  baggage_cuft:500, hourly_est:3800 },
  { make:"ATR",           model:"ATR 42-600",              category:"Turboprop",       pax:48, range_nm:1326, speed_ktas:300, ceiling_ft:25000, engines:2, engine_type:"Turboprop",  baggage_cuft:500, hourly_est:4000 },
  { make:"ATR",           model:"ATR 72-500",              category:"Turboprop",       pax:70, range_nm:850,  speed_ktas:275, ceiling_ft:25000, engines:2, engine_type:"Turboprop",  baggage_cuft:700, hourly_est:4800 },
  { make:"ATR",           model:"ATR 72-600",              category:"Turboprop",       pax:70, range_nm:900,  speed_ktas:275, ceiling_ft:25000, engines:2, engine_type:"Turboprop",  baggage_cuft:700, hourly_est:5000 },
  { make:"Jetstream",     model:"BAe Jetstream 31",        category:"Turboprop",       pax:19, range_nm:850,  speed_ktas:250, ceiling_ft:25000, engines:2, engine_type:"Turboprop",  baggage_cuft:100, hourly_est:1800 },
  { make:"Jetstream",     model:"BAe Jetstream 41",        category:"Turboprop",       pax:29, range_nm:700,  speed_ktas:280, ceiling_ft:26000, engines:2, engine_type:"Turboprop",  baggage_cuft:150, hourly_est:2200 },
  { make:"Saab",          model:"Saab 340B",               category:"Turboprop",       pax:35, range_nm:870,  speed_ktas:282, ceiling_ft:25000, engines:2, engine_type:"Turboprop",  baggage_cuft:250, hourly_est:3000 },
  { make:"Metroliner",    model:"Fairchild Metro III",      category:"Turboprop",       pax:19, range_nm:1015, speed_ktas:270, ceiling_ft:25000, engines:2, engine_type:"Turboprop",  baggage_cuft:80,  hourly_est:1600 },

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // PISTON ‚Äî SINGLE ENGINE
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  { make:"Cessna",        model:"172 Skyhawk",             category:"Piston",          pax:3,  range_nm:640,  speed_ktas:122, ceiling_ft:14000, engines:1, engine_type:"Piston",      baggage_cuft:15,  hourly_est:250  },
  { make:"Cessna",        model:"182 Skylane",             category:"Piston",          pax:3,  range_nm:915,  speed_ktas:145, ceiling_ft:18100, engines:1, engine_type:"Piston",      baggage_cuft:18,  hourly_est:320  },
  { make:"Cessna",        model:"T182T Turbo Skylane",     category:"Piston",          pax:3,  range_nm:990,  speed_ktas:162, ceiling_ft:20000, engines:1, engine_type:"Piston",      baggage_cuft:18,  hourly_est:380  },
  { make:"Cessna",        model:"T210 Centurion",          category:"Piston",          pax:5,  range_nm:970,  speed_ktas:172, ceiling_ft:23000, engines:1, engine_type:"Piston",      baggage_cuft:22,  hourly_est:380  },
  { make:"Piper",         model:"M600/SLS (Piston ver)",   category:"Piston",          pax:4,  range_nm:1300, speed_ktas:210, ceiling_ft:25000, engines:1, engine_type:"Piston",      baggage_cuft:30,  hourly_est:450  },
  { make:"Piper",         model:"PA-46 Malibu Mirage",     category:"Piston",          pax:5,  range_nm:1343, speed_ktas:213, ceiling_ft:25000, engines:1, engine_type:"Piston",      baggage_cuft:30,  hourly_est:500  },
  { make:"Piper",         model:"PA-46 Malibu Matrix",     category:"Piston",          pax:5,  range_nm:1300, speed_ktas:213, ceiling_ft:25000, engines:1, engine_type:"Piston",      baggage_cuft:30,  hourly_est:480  },
  { make:"Beechcraft",    model:"Bonanza G36",             category:"Piston",          pax:5,  range_nm:920,  speed_ktas:174, ceiling_ft:18500, engines:1, engine_type:"Piston",      baggage_cuft:22,  hourly_est:350  },
  { make:"Beechcraft",    model:"Bonanza A36",             category:"Piston",          pax:5,  range_nm:850,  speed_ktas:168, ceiling_ft:18300, engines:1, engine_type:"Piston",      baggage_cuft:22,  hourly_est:320  },
  { make:"Cirrus",        model:"SR22T",                   category:"Piston",          pax:4,  range_nm:1050, speed_ktas:213, ceiling_ft:25000, engines:1, engine_type:"Piston",      baggage_cuft:18,  hourly_est:380  },
  { make:"Mooney",        model:"M20V Acclaim Ultra",      category:"Piston",          pax:3,  range_nm:1500, speed_ktas:242, ceiling_ft:25000, engines:1, engine_type:"Piston",      baggage_cuft:18,  hourly_est:350  },

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // PISTON ‚Äî TWIN ENGINE
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  { make:"Cessna",        model:"310R",                    category:"Piston",          pax:5,  range_nm:1100, speed_ktas:196, ceiling_ft:20600, engines:2, engine_type:"Piston",      baggage_cuft:30,  hourly_est:500  },
  { make:"Cessna",        model:"340A",                    category:"Piston",          pax:5,  range_nm:1100, speed_ktas:195, ceiling_ft:20000, engines:2, engine_type:"Piston",      baggage_cuft:30,  hourly_est:520  },
  { make:"Cessna",        model:"402C Utiliner",           category:"Piston",          pax:9,  range_nm:1350, speed_ktas:195, ceiling_ft:20000, engines:2, engine_type:"Piston",      baggage_cuft:40,  hourly_est:650  },
  { make:"Cessna",        model:"414A Chancellor",         category:"Piston",          pax:7,  range_nm:1200, speed_ktas:200, ceiling_ft:30000, engines:2, engine_type:"Piston",      baggage_cuft:30,  hourly_est:600  },
  { make:"Cessna",        model:"421C Golden Eagle",       category:"Piston",          pax:8,  range_nm:1490, speed_ktas:243, ceiling_ft:30200, engines:2, engine_type:"Piston",      baggage_cuft:40,  hourly_est:750  },
  { make:"Piper",         model:"PA-23 Aztec F",           category:"Piston",          pax:5,  range_nm:1010, speed_ktas:191, ceiling_ft:21000, engines:2, engine_type:"Piston",      baggage_cuft:30,  hourly_est:500  },
  { make:"Piper",         model:"PA-31 Chieftain",         category:"Piston",          pax:9,  range_nm:920,  speed_ktas:194, ceiling_ft:26300, engines:2, engine_type:"Piston",      baggage_cuft:35,  hourly_est:700  },
  { make:"Piper",         model:"PA-31 Navajo",            category:"Piston",          pax:8,  range_nm:920,  speed_ktas:211, ceiling_ft:26300, engines:2, engine_type:"Piston",      baggage_cuft:35,  hourly_est:650  },
  { make:"Piper",         model:"PA-34 Seneca V",          category:"Piston",          pax:6,  range_nm:900,  speed_ktas:167, ceiling_ft:25000, engines:2, engine_type:"Piston",      baggage_cuft:25,  hourly_est:580  },
  { make:"Beechcraft",    model:"Baron G58",               category:"Piston",          pax:5,  range_nm:1480, speed_ktas:202, ceiling_ft:20688, engines:2, engine_type:"Piston",      baggage_cuft:30,  hourly_est:650  },
  { make:"Beechcraft",    model:"Baron 55",                category:"Piston",          pax:5,  range_nm:1300, speed_ktas:195, ceiling_ft:19700, engines:2, engine_type:"Piston",      baggage_cuft:25,  hourly_est:580  },
  { make:"Beechcraft",    model:"Duke B60",                category:"Piston",          pax:5,  range_nm:1020, speed_ktas:235, ceiling_ft:30000, engines:2, engine_type:"Piston",      baggage_cuft:30,  hourly_est:700  },
  { make:"Diamond",       model:"DA62",                    category:"Piston",          pax:5,  range_nm:1078, speed_ktas:192, ceiling_ft:18000, engines:2, engine_type:"Piston",      baggage_cuft:20,  hourly_est:500  },

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // HELICOPTERS ‚Äî LIGHT SINGLE
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  { make:"Robinson",      model:"R44 Raven II",            category:"Helicopter",      pax:3,  range_nm:300,  speed_ktas:109, ceiling_ft:14000, engines:1, engine_type:"Piston",      baggage_cuft:10,  hourly_est:500  },
  { make:"Robinson",      model:"R66 Turbine",             category:"Helicopter",      pax:4,  range_nm:350,  speed_ktas:120, ceiling_ft:14000, engines:1, engine_type:"Turboshaft",  baggage_cuft:12,  hourly_est:750  },
  { make:"Bell",          model:"Bell 206B JetRanger III", category:"Helicopter",      pax:4,  range_nm:365,  speed_ktas:115, ceiling_ft:13500, engines:1, engine_type:"Turboshaft",  baggage_cuft:15,  hourly_est:900  },
  { make:"Bell",          model:"Bell 206L LongRanger IV", category:"Helicopter",      pax:6,  range_nm:350,  speed_ktas:110, ceiling_ft:13200, engines:1, engine_type:"Turboshaft",  baggage_cuft:15,  hourly_est:1100 },
  { make:"Bell",          model:"Bell 407GXi",             category:"Helicopter",      pax:6,  range_nm:327,  speed_ktas:133, ceiling_ft:18500, engines:1, engine_type:"Turboshaft",  baggage_cuft:20,  hourly_est:1400 },
  { make:"Bell",          model:"Bell 407GX",              category:"Helicopter",      pax:6,  range_nm:327,  speed_ktas:133, ceiling_ft:18500, engines:1, engine_type:"Turboshaft",  baggage_cuft:20,  hourly_est:1300 },
  { make:"Airbus",        model:"H120 Colibri",            category:"Helicopter",      pax:4,  range_nm:300,  speed_ktas:110, ceiling_ft:18000, engines:1, engine_type:"Turboshaft",  baggage_cuft:10,  hourly_est:800  },
  { make:"Airbus",        model:"H125 (AS350 B3e)",        category:"Helicopter",      pax:5,  range_nm:330,  speed_ktas:130, ceiling_ft:23000, engines:1, engine_type:"Turboshaft",  baggage_cuft:15,  hourly_est:1200 },
  { make:"Airbus",        model:"H130 T2",                 category:"Helicopter",      pax:7,  range_nm:350,  speed_ktas:130, ceiling_ft:16000, engines:1, engine_type:"Turboshaft",  baggage_cuft:15,  hourly_est:1300 },
  { make:"MD Helicopters",model:"MD 500E",                 category:"Helicopter",      pax:4,  range_nm:230,  speed_ktas:130, ceiling_ft:16000, engines:1, engine_type:"Turboshaft",  baggage_cuft:8,   hourly_est:900  },
  { make:"MD Helicopters",model:"MD 520N (NOTAR)",         category:"Helicopter",      pax:4,  range_nm:250,  speed_ktas:128, ceiling_ft:16000, engines:1, engine_type:"Turboshaft",  baggage_cuft:8,   hourly_est:900  },
  { make:"Leonardo",      model:"AW119 Koala",             category:"Helicopter",      pax:7,  range_nm:635,  speed_ktas:140, ceiling_ft:20000, engines:1, engine_type:"Turboshaft",  baggage_cuft:25,  hourly_est:1600 },

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // HELICOPTERS ‚Äî LIGHT TWIN
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  { make:"Bell",          model:"Bell 429",                category:"Helicopter",      pax:7,  range_nm:397,  speed_ktas:150, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:30,  hourly_est:2200 },
  { make:"Bell",          model:"Bell 430",                category:"Helicopter",      pax:9,  range_nm:440,  speed_ktas:140, ceiling_ft:17000, engines:2, engine_type:"Turboshaft",  baggage_cuft:30,  hourly_est:2400 },
  { make:"Bell",          model:"Bell 505 Jet Ranger X",   category:"Helicopter",      pax:4,  range_nm:360,  speed_ktas:125, ceiling_ft:18000, engines:1, engine_type:"Turboshaft",  baggage_cuft:15,  hourly_est:1100 },
  { make:"Airbus",        model:"H135",                    category:"Helicopter",      pax:6,  range_nm:350,  speed_ktas:140, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:20,  hourly_est:2000 },
  { make:"Airbus",        model:"H145",                    category:"Helicopter",      pax:9,  range_nm:407,  speed_ktas:145, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:25,  hourly_est:2800 },
  { make:"Airbus",        model:"H145M",                   category:"Helicopter",      pax:9,  range_nm:407,  speed_ktas:145, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:25,  hourly_est:2800 },
  { make:"Leonardo",      model:"AW109 Power",             category:"Helicopter",      pax:6,  range_nm:535,  speed_ktas:155, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:20,  hourly_est:2200 },
  { make:"Leonardo",      model:"AW109 Trekker",           category:"Helicopter",      pax:7,  range_nm:545,  speed_ktas:155, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:25,  hourly_est:2500 },
  { make:"Leonardo",      model:"AW109 GrandNew",          category:"Helicopter",      pax:8,  range_nm:595,  speed_ktas:155, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:25,  hourly_est:2600 },
  { make:"Leonardo",      model:"AW169",                   category:"Helicopter",      pax:10, range_nm:488,  speed_ktas:155, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:35,  hourly_est:3200 },
  { make:"MD Helicopters",model:"MD 902 Explorer",         category:"Helicopter",      pax:8,  range_nm:390,  speed_ktas:140, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:25,  hourly_est:2200 },
  { make:"Enstrom",       model:"480B",                    category:"Helicopter",      pax:4,  range_nm:290,  speed_ktas:100, ceiling_ft:12000, engines:1, engine_type:"Turboshaft",  baggage_cuft:10,  hourly_est:700  },

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // HELICOPTERS ‚Äî MEDIUM / HEAVY
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  { make:"Bell",          model:"Bell 412EPI",             category:"Helicopter",      pax:13, range_nm:402,  speed_ktas:140, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:50,  hourly_est:3500 },
  { make:"Bell",          model:"Bell 525 Relentless",     category:"Helicopter",      pax:16, range_nm:460,  speed_ktas:155, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:60,  hourly_est:5000 },
  { make:"Airbus",        model:"H155 (EC155 B1)",         category:"Helicopter",      pax:13, range_nm:430,  speed_ktas:165, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:45,  hourly_est:3500 },
  { make:"Airbus",        model:"H160",                    category:"Helicopter",      pax:12, range_nm:460,  speed_ktas:160, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:45,  hourly_est:4000 },
  { make:"Airbus",        model:"H175",                    category:"Helicopter",      pax:16, range_nm:460,  speed_ktas:155, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:60,  hourly_est:5000 },
  { make:"Airbus",        model:"H215 Super Puma",         category:"Helicopter",      pax:19, range_nm:440,  speed_ktas:150, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:80,  hourly_est:6000 },
  { make:"Airbus",        model:"H225 Super Puma",         category:"Helicopter",      pax:19, range_nm:450,  speed_ktas:155, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:80,  hourly_est:6500 },
  { make:"Leonardo",      model:"AW139",                   category:"Helicopter",      pax:15, range_nm:573,  speed_ktas:165, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:55,  hourly_est:4500 },
  { make:"Leonardo",      model:"AW189",                   category:"Helicopter",      pax:18, range_nm:750,  speed_ktas:155, ceiling_ft:20000, engines:2, engine_type:"Turboshaft",  baggage_cuft:70,  hourly_est:5500 },
  { make:"Sikorsky",      model:"S-76C++",                 category:"Helicopter",      pax:12, range_nm:450,  speed_ktas:155, ceiling_ft:15000, engines:2, engine_type:"Turboshaft",  baggage_cuft:45,  hourly_est:3800 },
  { make:"Sikorsky",      model:"S-76D",                   category:"Helicopter",      pax:12, range_nm:411,  speed_ktas:155, ceiling_ft:15000, engines:2, engine_type:"Turboshaft",  baggage_cuft:45,  hourly_est:4000 },
  { make:"Sikorsky",      model:"S-92A+",                  category:"Helicopter",      pax:19, range_nm:594,  speed_ktas:155, ceiling_ft:15000, engines:2, engine_type:"Turboshaft",  baggage_cuft:80,  hourly_est:7000 },

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // SEAPLANES / AMPHIBIOUS
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  { make:"De Havilland",  model:"Beaver DHC-2",            category:"Seaplane",        pax:6,  range_nm:455,  speed_ktas:108, ceiling_ft:18000, engines:1, engine_type:"Piston",      baggage_cuft:30,  hourly_est:800  },
  { make:"De Havilland",  model:"Turbine Beaver DHC-2T",   category:"Seaplane",        pax:6,  range_nm:600,  speed_ktas:130, ceiling_ft:22000, engines:1, engine_type:"Turboprop",  baggage_cuft:30,  hourly_est:1000 },
  { make:"De Havilland",  model:"Otter DHC-3",             category:"Seaplane",        pax:10, range_nm:945,  speed_ktas:130, ceiling_ft:18000, engines:1, engine_type:"Turboprop",  baggage_cuft:40,  hourly_est:1200 },
  { make:"De Havilland",  model:"Twin Otter DHC-6 Floats", category:"Seaplane",        pax:19, range_nm:700,  speed_ktas:150, ceiling_ft:25000, engines:2, engine_type:"Turboprop",  baggage_cuft:60,  hourly_est:1600 },
  { make:"Cessna",        model:"208 Caravan Amphib",      category:"Seaplane",        pax:9,  range_nm:900,  speed_ktas:174, ceiling_ft:25000, engines:1, engine_type:"Turboprop",  baggage_cuft:50,  hourly_est:1400 },
  { make:"Quest",         model:"Kodiak 100 Floats",       category:"Seaplane",        pax:9,  range_nm:880,  speed_ktas:160, ceiling_ft:25000, engines:1, engine_type:"Turboprop",  baggage_cuft:45,  hourly_est:1200 },
  { make:"Grumman",       model:"Goose G-21A",             category:"Seaplane",        pax:6,  range_nm:640,  speed_ktas:150, ceiling_ft:21000, engines:2, engine_type:"Piston",      baggage_cuft:30,  hourly_est:900  },
  { make:"ICON",          model:"A5",                      category:"Seaplane",        pax:1,  range_nm:300,  speed_ktas:95,  ceiling_ft:10000, engines:1, engine_type:"Piston",      baggage_cuft:5,   hourly_est:400  },
];




// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SUPABASE CONFIG
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const SUPABASE_URL = 'https://hkjldgjvxgrutnqzwfql.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhramxkZ2p2eGdydXRucXp3ZnFsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwNDMwOTYsImV4cCI6MjA4NzYxOTA5Nn0.aNICtFHRMeP5Xu9ssgLlziC6cbR6-WXcTCbM1UY1q3g';

// ‚ïê‚ïê COMMISSION ENGINE ‚ïê‚ïê
const COMMISSION_RATE = 0.02; // 2% flat rate ‚Äî subject to change per agreement

function calcCommission(price) {
  var fee  = Math.round(price * COMMISSION_RATE * 100) / 100;
  var net  = Math.round((price - fee) * 100) / 100;
  return { fee: fee, net: net, rate: (COMMISSION_RATE * 100).toFixed(0) };
}

// Simple Supabase client
const sb = {
  async query(method, table, body = null, params = '') {
    const url = `${SUPABASE_URL}/rest/v1/${table}${params}`;
    const session = auth.load();
    const token = (session && (session.access_token || (session.session && session.session.access_token))) || SUPABASE_KEY;
    const headers = {
      'apikey': SUPABASE_KEY,
      'Authorization': `Bearer ${token}`,
      'Content-Type': 'application/json',
      'Prefer': method === 'POST' ? 'return=representation' : 'return=representation'
    };
    const res = await fetch(url, { method, headers, body: body ? JSON.stringify(body) : null });
    if (!res.ok) {
      const err = await res.json();
      throw new Error(err.message || err.hint || 'Database error');
    }
    return method === 'DELETE' ? null : res.json();
  },
  async insert(table, data) { return this.query('POST', table, data); },
  async select(table, params = '') { return this.query('GET', table, null, params); },
  async update(table, data, params) { return this.query('PATCH', table, data, params); },
  async delete(table, params) { return this.query('DELETE', table, null, params); },
  async upsert(table, data) {
    const url = `${SUPABASE_URL}/rest/v1/${table}`;
    const session = auth.load();
    const token = (session && (session.access_token || (session.session && session.session.access_token))) || SUPABASE_KEY;
    const res = await fetch(url, {
      method: 'POST',
      headers: { 'apikey': SUPABASE_KEY, 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json', 'Prefer': 'resolution=merge-duplicates,return=representation' },
      body: JSON.stringify(data)
    });
    if (!res.ok) { const e = await res.json(); throw new Error(e.message || 'Upsert failed'); }
    return res.json();
  }
};



// ‚ïê‚ïê SUPABASE REALTIME ‚ïê‚ïê
let _realtimeWS = null;
function subscribeRealtimePilotRequests(operatorId) {
  if (_realtimeWS) { try { _realtimeWS.close(); } catch(e){} }
  const wsUrl = SUPABASE_URL.replace('https://', 'wss://') + '/realtime/v1/websocket?apikey=' + SUPABASE_KEY + '&vsn=1.0.0';
  try {
    _realtimeWS = new WebSocket(wsUrl);
    _realtimeWS.onopen = function() {
      _realtimeWS.send(JSON.stringify({ topic: 'realtime:public:pilot_requests:operator_id=eq.' + operatorId, event: 'phx_join', payload: {}, ref: '1' }));
    };
    _realtimeWS.onmessage = function(msg) {
      try {
        var data = JSON.parse(msg.data);
        if (data.event === 'UPDATE' || data.event === 'INSERT') {
          var rec = data.payload && data.payload.record;
          if (rec && rec.status === 'countered') {
            showToast('info', 'üí¨', 'Pilot countered your offer', 'Offered $' + rec.counter_rate + '/day ‚Äî review in Pilot Roster');
            renderPilotRoster();
          } else if (rec && rec.status === 'accepted') {
            showToast('success', '‚úì', 'Pilot accepted!', 'Check assignment confirmed');
          }
        }
      } catch(e) {}
    };
    _realtimeWS.onerror = function() { /* silent fail */ };
  } catch(e) { /* WebSocket not available in all contexts */ }
}

// Auth via Supabase Auth API
const auth = {
  async signUp(email, password, metadata = {}) {
    const res = await fetch(`${SUPABASE_URL}/auth/v1/signup`, {
      method: 'POST',
      headers: { 'apikey': SUPABASE_KEY, 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password, data: metadata })
    });
    const data = await res.json();
    if (data.error) throw new Error(data.error.message || data.msg);
    return data;
  },
  async signIn(email, password) {
    const res = await fetch(`${SUPABASE_URL}/auth/v1/token?grant_type=password`, {
      method: 'POST',
      headers: { 'apikey': SUPABASE_KEY, 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password })
    });
    const data = await res.json();
    if (data.error) throw new Error(data.error.message || data.error_description || 'Sign in failed');
    return data;
  },
  save(session) { localStorage.setItem('aa_session', JSON.stringify(session)); },
  load() { try { return JSON.parse(localStorage.getItem('aa_session')); } catch { return null; } },
  clear() { localStorage.removeItem('aa_session'); localStorage.removeItem('aa_operator'); localStorage.removeItem('aa_client'); }
};

// ‚ïê‚ïê STATE ‚ïê‚ïê
let currentStep = 0;
let selectedRole = 'owner';
let checks = { c1: false, c2: false, c3: false, c4: false };
let osaScrolled = false;
let activeReqId = null;
let activeReqData = null;
let quoteCount = 0;
let settleTotal = 0;
let currentOperator = null;
let currentClient = null;
let toastTimer;

// ‚ïê‚ïê INIT ‚ïê‚ïê
// All DOM-dependent code runs after DOMContentLoaded (see bottom of script)

// ‚ïê‚ïê VIEWS ‚ïê‚ïê
function showView(id) {
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  const target = document.getElementById(id);
  if (!target) { console.warn('showView: view not found:', id); return; }
  target.classList.add('active');
  const labels = {
    'view-landing': 'Private Charter Marketplace',
    'view-operator-onboard': 'Operator Onboarding',
    'view-operator-login': 'Operator Sign In',
    'view-client-login': 'Client Sign In',
    'view-client-signup': 'Create Account',
    'view-dashboard': 'Operator Dashboard',
    'view-client-dashboard': 'Client Portal'
  };
  document.getElementById('nav-section-label').textContent = labels[id] || 'Aviate Atelier';
}

// ‚ïê‚ïê ONBOARDING STEPS ‚ïê‚ïê
function goStep(n) {
  // Validate step 0 before moving on
  if (n > 0 && currentStep === 0) {
    const company = document.getElementById('f-company').value.trim();
    const ein = document.getElementById('f-ein').value.trim();
    const email = document.getElementById('f-email').value.trim();
    const pass = document.getElementById('f-password').value.trim();
    const err = document.getElementById('step0-error');
    if (!company || !ein || !email || !pass) {
      err.textContent = 'Please fill in all required fields before continuing.';
      err.classList.add('show'); return;
    }
    if (pass.length < 8) {
      err.textContent = 'Password must be at least 8 characters.';
      err.classList.add('show'); return;
    }
    err.classList.remove('show');
  }
  document.querySelectorAll('.ob-step').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.step-item').forEach((s, i) => {
    s.classList.remove('active', 'done');
    if (i < n) s.classList.add('done');
    if (i === n) s.classList.add('active');
  });
  document.getElementById('step-' + n).classList.add('active');
  currentStep = n;
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function markUploaded(id, type) {
  const el = document.getElementById(id);
  if (!el.classList.contains('done')) {
    el.classList.add('done');
    el.innerHTML = `<div class="upload-icon">‚úÖ</div><div class="upload-title">${type === 'argus' ? 'ARGUS Certificate' : 'Wyvern Certificate'} Uploaded</div><div class="upload-done-badge">‚úì File received</div>`;
  }
}

function addAircraft() {
  const n = document.querySelectorAll('#fleet-list > div').length + 1;
  const div = document.createElement('div');
  div.style.cssText = 'background:var(--card);border:1.5px solid var(--border2);border-radius:16px;padding:18px;margin-bottom:12px';
  div.innerHTML = `<div style="font-size:12px;font-weight:700;color:var(--gold2);letter-spacing:.06em;text-transform:uppercase;margin-bottom:14px">Aircraft #${n}</div>
    <div class="field-row" style="margin-bottom:12px">
      <div class="field-group"><div class="field-label">Tail Number</div><input class="field-input fleet-tail" placeholder="N0000" style="font-family:'DM Mono',monospace;font-size:16px"></div>
      <div class="field-group"><div class="field-label">Aircraft Type</div><select class="field-select fleet-type"><option>Citation CJ3+</option><option>Phenom 300E</option><option>Hawker 800XP</option><option>Gulfstream G450</option><option>Other</option></select></div>
    </div>
    <div class="field-row-3">
      <div class="field-group"><div class="field-label">Year</div><input class="field-input fleet-year" placeholder="2021"></div>
      <div class="field-group"><div class="field-label">Max Pax</div><input class="field-input fleet-pax" placeholder="6"></div>
      <div class="field-group"><div class="field-label">Home FBO</div><input class="field-input fleet-fbo" placeholder="OPF"></div>
    </div>`;
  document.getElementById('fleet-list').appendChild(div);
}

function selectRole(r) {
  selectedRole = r;
  ['owner','director_ops','chief_pilot','dispatcher'].forEach(function(k) {
    var el = document.getElementById('role-' + k);
    if (el) el.classList.remove('selected');
  });
  var selected = document.getElementById('role-' + r);
  if (selected) selected.classList.add('selected');
}

// ‚ïê‚ïê OSA ‚ïê‚ïê
function checkScroll() {
  const el = document.getElementById('osa-scroll');
  if (!osaScrolled && el.scrollTop + el.clientHeight >= el.scrollHeight - 30) {
    osaScrolled = true;
    document.getElementById('scroll-prompt').style.display = 'none';
    document.getElementById('agreement-checks').style.opacity = '1';
  }
}

function toggleCheck(id) {
  if (!osaScrolled) { document.getElementById('osa-scroll').scrollBy({ top: 200, behavior: 'smooth' }); return; }
  checks[id] = !checks[id];
  document.getElementById(id).classList.toggle('checked', checks[id]);
  checkSigReady();
}

function checkSigReady() {
  const allChecked = Object.values(checks).every(Boolean);
  const hasSig = (document.getElementById('sig-name').value || '').trim().length > 2;
  document.getElementById('sign-btn').disabled = !(allChecked && hasSig);
}

// ‚ïê‚ïê EXECUTE AGREEMENT ‚Äî SAVE TO SUPABASE ‚ïê‚ïê
async function executeAgreement() {
  const btn = document.getElementById('sign-btn');
  btn.classList.add('loading');
  btn.textContent = 'Creating your account...';

  const email = document.getElementById('f-email').value.trim();
  const password = document.getElementById('f-password').value.trim();
  const company = document.getElementById('f-company').value.trim();

  try {
    // 1. Create auth account
    const authData = await auth.signUp(email, password, { company_name: company });
    auth.save(authData);

    // 2. Save operator record to database
    const operatorData = {
      company_name: company,
      trading_name: document.getElementById('f-trading').value.trim() || company,
      ein: document.getElementById('f-ein').value.trim(),
      faa_cert: document.getElementById('f-cert').value.trim(),
      argus_rating: document.getElementById('f-argus').value,
      isbao_stage: document.getElementById('f-isbao').value,
      insurance_level: document.getElementById('f-insurance').value,
      state: document.getElementById('f-state').value,
      home_fbo: document.getElementById('f-fbo').value.trim(),
      address: document.getElementById('f-address').value.trim(),
      city: document.getElementById('f-city').value.trim(),
      zip: document.getElementById('f-zip').value.trim(),
      owner_name: document.getElementById('f-owner-name').value.trim(),
      owner_title: document.getElementById('f-owner-title').value.trim(),
      email: email,
      role: selectedRole,
      status: 'pending_verification',
      osa_signed: true,
      osa_signed_at: new Date().toISOString()
    };

    const [savedOperator] = await sb.insert('operators', operatorData);
    currentOperator = savedOperator;
    localStorage.setItem('aa_operator', JSON.stringify(savedOperator));

    // 3. Save fleet
    const fleetCards = document.querySelectorAll('#fleet-list > div');
    for (const card of fleetCards) {
      const tail = card.querySelector('.fleet-tail')?.value?.trim();
      const type = card.querySelector('.fleet-type')?.value;
      if (tail && type) {
        await sb.insert('fleet', {
          operator_id: savedOperator.id,
          tail_number: tail,
          aircraft_type: type,
          year: parseInt(card.querySelector('.fleet-year')?.value) || null,
          max_passengers: parseInt(card.querySelector('.fleet-pax')?.value) || null,
          home_fbo: card.querySelector('.fleet-fbo')?.value?.trim() || null,
          status: 'available'
        });
      }
    }

    document.getElementById('success-company').textContent = company;
    goStep(5);
    showToast('success', '‚úì', 'Account created', 'Your operator profile is saved to the database.');

  } catch (err) {
    btn.classList.remove('loading');
    btn.disabled = false;
    btn.innerHTML = '<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M2 8l4 4 8-8"/></svg> Execute Agreement & Activate Account';
    showToast('error', '‚úï', 'Account creation failed', err.message);
  }
}

function goToDashboard() {
  if (currentOperator) loadDashboard(currentOperator);
}

// ‚ïê‚ïê OPERATOR LOGIN ‚ïê‚ïê
async function operatorLogin() {
  var email = document.getElementById('op-login-email') ? document.getElementById('op-login-email').value.trim() : '';
  var pw    = document.getElementById('op-login-pw') ? document.getElementById('op-login-pw').value : '';
  if (!email || !pw) { showToast && showToast('warning','‚ö†','Missing fields','Enter email and password'); return; }
  const { data, error } = await _sb.auth.signInWithPassword({ email, password: pw });
  if (error) { alert('Login failed: ' + error.message); return; }
  const { data: op } = await _sb.from('operators').select('*').eq('user_id', data.user.id).single();
  if (!op) { alert('No operator account found for this email. Please register first.'); return; }
  _opRecord = op;
  _opUser = data.user;
  loadDashboard();
}

// ‚ïê‚ïê CLIENT SIGNUP ‚ïê‚ïê
async function clientSignup() {
  const first = document.getElementById('cl-first').value.trim();
  const last = document.getElementById('cl-last').value.trim();
  const email = document.getElementById('cl-email').value.trim();
  const phone = document.getElementById('cl-phone').value.trim();
  const company = document.getElementById('cl-company').value.trim();
  const pass = document.getElementById('cl-pass').value.trim();
  const errEl = document.getElementById('cl-signup-error');
  const btn = document.getElementById('cl-signup-btn');

  if (!first || !last || !email || !pass) { errEl.textContent = 'Please fill in all required fields.'; errEl.style.display = 'block'; return; }
  if (pass.length < 8) { errEl.textContent = 'Password must be at least 8 characters.'; errEl.style.display = 'block'; return; }

  btn.classList.add('loading'); btn.textContent = 'Creating account...';
  errEl.style.display = 'none';

  try {
    const session = await auth.signUp(email, pass, { first_name: first, last_name: last });
    auth.save(session);

    const [savedClient] = await sb.insert('clients', {
      first_name: first, last_name: last,
      email, phone, company, status: 'active'
    });

    currentClient = savedClient;
    localStorage.setItem('aa_client', JSON.stringify(savedClient));
    loadClientDashboard(savedClient);
    showToast('success', '‚úì', 'Account created', `Welcome, ${first}!`);

  } catch (err) {
    btn.classList.remove('loading'); btn.textContent = 'Create Account & Start Booking';
    errEl.textContent = err.message; errEl.style.display = 'block';
  }
}

// ‚ïê‚ïê CLIENT LOGIN ‚ïê‚ïê
async function clientLogin() {
  const email = document.getElementById('cl-login-email').value.trim();
  const pass = document.getElementById('cl-login-pass').value.trim();
  const errEl = document.getElementById('cl-login-error');
  const btn = document.getElementById('cl-login-btn');

  if (!email || !pass) { errEl.textContent = 'Please enter your email and password.'; errEl.style.display = 'block'; return; }

  btn.classList.add('loading'); btn.textContent = 'Signing in...';
  errEl.style.display = 'none';

  try {
    const session = await auth.signIn(email, pass);
    auth.save(session);

    const clients = await sb.select('clients', `?email=eq.${encodeURIComponent(email)}`);
    if (!clients || clients.length === 0) throw new Error('No client account found for this email.');

    currentClient = clients[0];
    localStorage.setItem('aa_client', JSON.stringify(currentClient));
    loadClientDashboard(currentClient);
    showToast('success', '‚úì', 'Welcome back', `${currentClient.first_name} ${currentClient.last_name}`);

  } catch (err) {
    btn.classList.remove('loading'); btn.textContent = 'Sign In';
    errEl.textContent = err.message; errEl.style.display = 'block';
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DEMO MODE ‚Äî instant dashboard preview, no auth needed
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function loadDemoMode() {
  var demoOp = {
    id: 'demo_001', company_name: 'Apex Air Charter LLC',
    owner_name: '', email: 'ops@yourcompany.com',
    role: 'owner', argus_rating: 'ARGUS Platinum', status: 'active'
  };
  window._demoMode = true;
  currentOperator = demoOp;

  FLEET_STATUS = {
    'N481SP': { status:'available',   aircraft:'Embraer Phenom 300E',       note:'' },
    'N720JB': { status:'inflight',    aircraft:'Cessna Citation CJ4 Gen2',  note:'MIA \u2192 TEB \u00b7 ETA 14:30' },
    'N38VT':  { status:'maintenance', aircraft:'Bombardier Challenger 350',  note:'C-check \u00b7 return 03/05' },
    'N55KR':  { status:'scheduled',   aircraft:'Gulfstream G550',            note:'Dep 09:00 tomorrow' },
    'N109AX': { status:'aog',         aircraft:'Dassault Falcon 2000LXS',   note:'Landing gear snag \u00b7 AOG KMIA' },
    'N330LF': { status:'available',   aircraft:'Beechcraft King Air 350',   note:'' }
  };

  TEAM_MEMBERS = [
    { id:'tm001', name:'Sarah Chen',   email:'s.chen@apexair.com',   role:'chief_pilot',  status:'active' },
    { id:'tm002', name:'James Okafor', email:'j.okafor@apexair.com', role:'director_ops', status:'active' },
    { id:'tm003', name:'Priya Nair',   email:'p.nair@apexair.com',   role:'dispatcher',   status:'active' },
    { id:'tm004', name:'Lucas Moreau', email:'l.moreau@apexair.com', role:'pilot',        status:'active' },
    { id:'tm005', name:'Dana Elliot',  email:'d.elliot@apexair.com', role:'dispatcher',   status:'suspended' }
  ];

  ACTIVITY_LOG = [
    { id:'l1', ts:new Date(Date.now()-480000).toISOString(),  category:'quote',   description:'Quote submitted \u2014 N481SP \u00b7 MIA \u2192 TEB \u00b7 $14,200', user:'',  role:'owner' },
    { id:'l2', ts:new Date(Date.now()-1320000).toISOString(), category:'fleet',   description:'N720JB status: Scheduled \u2192 In Flight',                           user:'Sarah Chen',   role:'chief_pilot' },
    { id:'l3', ts:new Date(Date.now()-2700000).toISOString(), category:'booking', description:'New request \u00b7 OPF \u2192 TEB \u00b7 4 pax',                      user:'System',       role:'unknown' },
    { id:'l4', ts:new Date(Date.now()-5400000).toISOString(), category:'team',    description:'Suspended D. Elliot \u2014 access revoked temporarily',               user:'',  role:'owner' },
    { id:'l5', ts:new Date(Date.now()-8400000).toISOString(), category:'fleet',   description:'N38VT status: Available \u2192 Maintenance',                          user:'James Okafor', role:'director_ops' },
    { id:'l6', ts:new Date(Date.now()-12000000).toISOString(),category:'quote',   description:'Quote submitted \u2014 N55KR \u00b7 VNY \u2192 KSUN \u00b7 $28,500', user:'Priya Nair',   role:'dispatcher' }
  ];

  var demoFleet = [
    { tail_number:'N481SP', aircraft_type:'Embraer Phenom 300E',      max_passengers:8,  year:2022, home_fbo:'OPF', status:'Available' },
    { tail_number:'N720JB', aircraft_type:'Cessna Citation CJ4 Gen2', max_passengers:9,  year:2021, home_fbo:'MIA', status:'In Flight' },
    { tail_number:'N38VT',  aircraft_type:'Bombardier Challenger 350',max_passengers:10, year:2019, home_fbo:'TEB', status:'Maintenance' },
    { tail_number:'N55KR',  aircraft_type:'Gulfstream G550',           max_passengers:16, year:2018, home_fbo:'VNY', status:'Scheduled' },
    { tail_number:'N109AX', aircraft_type:'Dassault Falcon 2000LXS',  max_passengers:10, year:2020, home_fbo:'MIA', status:'AOG' },
    { tail_number:'N330LF', aircraft_type:'Beechcraft King Air 350',  max_passengers:11, year:2023, home_fbo:'FXE', status:'Available' }
  ];

  var scMap = { Available:'var(--green2)', 'In Flight':'#58A6FF', Maintenance:'#FF6B6B', Scheduled:'var(--gold2)', AOG:'#FF3B30' };
  var display = document.getElementById('fleet-display');
  if (display) {
    display.innerHTML = demoFleet.map(function(f) {
      var sc = scMap[f.status] || 'var(--text3)';
      return '<div style="background:var(--card);border:1px solid var(--border);border-radius:16px;padding:18px;margin-bottom:12px;display:flex;align-items:center;gap:16px">' +
        '<div style="width:52px;height:52px;border-radius:14px;background:rgba(229,168,60,0.1);border:1px solid rgba(229,168,60,0.2);display:flex;align-items:center;justify-content:center;flex-shrink:0">' +
        '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--gold2)" stroke-width="1.8"><path d="M2 18L12 5L22 18"/><line x1="2" y1="20" x2="22" y2="20"/></svg></div>' +
        '<div style="flex:1"><div style="font-size:15px;font-weight:700;color:var(--text)">' + f.aircraft_type + '</div>' +
        '<div style="font-size:11px;color:var(--text3);margin-top:2px">' + f.tail_number + ' \u00b7 ' + f.max_passengers + ' seats \u00b7 ' + f.year + ' \u00b7 ' + f.home_fbo + '</div></div>' +
        '<div style="color:' + sc + ';font-size:10px;font-weight:800;padding:4px 10px;border-radius:8px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.08)">' + f.status + '</div></div>';
    }).join('');
  }

  var qmAc = document.getElementById('qm-ac');
  if (qmAc) {
    qmAc.innerHTML = demoFleet.map(function(f) {
      return '<option>' + f.aircraft_type + ' (' + f.tail_number + ')</option>';
    }).join('');
  }

  var demoReqs = [
    { id:'r1', from:'OPF', to:'TEB', fromCity:'Miami, FL',    toCity:'Teterboro, NJ', date:'2026-03-12', time:'08:00', pax:4, notes:'Catering: Continental breakfast. Ground transport at TEB.' },
    { id:'r2', from:'VNY', to:'ASE', fromCity:'Van Nuys, CA', toCity:'Aspen, CO',     date:'2026-03-14', time:'10:30', pax:6, notes:'Stand-up cabin required. 2x heavy ski bags.' },
    { id:'r3', from:'ADS', to:'SJD', fromCity:'Addison, TX',  toCity:'Los Cabos, MX', date:'2026-03-15', time:'Flexible', pax:8, notes:'International. Pet on board: Labrador, 85lbs.' }
  ];
  window._demoReqMap = {};
  demoReqs.forEach(function(r) { window._demoReqMap[r.id] = r; });

  var reqList = document.getElementById('requests-list');
  if (reqList) {
    var sbBadge = document.getElementById('sb-badge');
    if (sbBadge) { sbBadge.textContent = demoReqs.length; sbBadge.style.display = 'block'; }
    var setEl = function(id, v) { var e = document.getElementById(id); if (e) e.textContent = v; };
    setEl('d-stat-req', demoReqs.length);
    setEl('d-stat-quotes', '7');
    setEl('d-stat-revenue', '$142,800');

    reqList.innerHTML = demoReqs.map(function(r) {
      var ds = new Date(r.date).toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'});
      var nh = r.notes ? '<div style="font-size:12px;color:var(--text3);padding:8px 12px;background:var(--bg3);border-radius:8px;margin-bottom:12px">\uD83D\uDCDD ' + r.notes + '</div>' : '';
      return '<div class="req-card new-req" id="rc-' + r.id + '">' +
        '<div class="req-top"><div><div class="req-route">' + r.from + ' \u2192 ' + r.to + '</div>' +
        '<div class="req-meta">' + r.fromCity + ' \u2192 ' + r.toCity + '</div></div>' +
        '<div class="req-badge new-b"><div style="width:5px;height:5px;border-radius:50%;background:#58A6FF;animation:pulse 1.2s infinite"></div>New</div></div>' +
        '<div class="req-details">' +
        '<div><div class="req-detail-label">Date</div><div class="req-detail-value">' + ds + '</div></div>' +
        '<div><div class="req-detail-label">Time</div><div class="req-detail-value">' + r.time + '</div></div>' +
        '<div><div class="req-detail-label">Passengers</div><div class="req-detail-value">' + r.pax + ' pax</div></div>' +
        '<div><div class="req-detail-label">Submitted</div><div class="req-detail-value">Just now</div></div>' +
        '</div>' + nh +
        '<div class="req-actions">' +
        '<button class="req-btn quote-btn" onclick="openDemoModal(' + JSON.stringify(r.id) + ')">Submit Quote</button>' +
        '<button class="req-btn decline-btn">Decline</button></div>' +
        '<div id="qstate-' + r.id + '"></div></div>';
    }).join('');
  }

  loadDashboard(demoOp);
  showToast('success', '\u2713', 'Demo loaded', 'Apex Air Charter \u00b7 Owner view');
}


function openDemoModal(reqId) {
  var r = window._demoReqMap && window._demoReqMap[reqId];
  if (!r) return;
  openModal(r.id, r.from, r.to, r.date, r.pax);
}

// ‚ïê‚ïê LOAD OPERATOR DASHBOARD ‚ïê‚ïê
function loadDashboard(operator) {
  if (operator && operator.id) { try { subscribeRealtimePilotRequests(operator.id); } catch(e){} }
  window._currentRole = operator.role || 'dispatcher';
  window._currentOperatorName = operator.owner_name || operator.email || 'Unknown';
  var setEl = function(id, val) { var el = document.getElementById(id); if (el) el.textContent = val; };
  setEl('db-company-name', operator.company_name);
  setEl('db-cert-badge', (operator.argus_rating || 'No ARGUS Rating'));

  var LEADERSHIP_ROLES = ['owner','Owner','director_ops','Director of Operations','chief_pilot','Chief Pilot'];
  var isOwner = LEADERSHIP_ROLES.indexOf(operator.role) > -1;

  // Role badge
  var roleEl = document.getElementById('db-role-badge');
  if (roleEl) {
    var roleBadges = {
      'owner':'üëë Owner', 'Owner':'üëë Owner',
      'director_ops':'‚ö° Director of Operations', 'Director of Operations':'‚ö° Director of Operations',
      'chief_pilot':'‚úà Chief Pilot', 'Chief Pilot':'‚úà Chief Pilot',
      'dispatcher':'üéß Dispatcher / Flight Scheduler',
      'scheduler':'üéß Dispatcher / Flight Scheduler',
      'pilot':'‚úà Pilot'
    };
    roleEl.textContent = roleBadges[operator.role] || operator.role;
  }

  // Non-owners: hide Agreement tab (no commission/fee info for staff)
  var osaItem = document.getElementById('sidebar-osa-item');
  var acctGroup = document.getElementById('sidebar-account-group');
  if (osaItem)   osaItem.style.display   = isOwner ? 'flex' : 'none';
  if (acctGroup) acctGroup.style.display = isOwner ? 'block' : 'none';

  // Hide + Add Aircraft button and insurance details for non-owners
  var fleetAddBtn = document.getElementById('fleet-add-btn');
  if (fleetAddBtn) fleetAddBtn.style.display = isOwner ? 'inline-flex' : 'none';

  // Hide insurance/pricing sections in aircraft cards for non-owners
  setTimeout(function() {
    var insWrap = document.querySelectorAll('.ac-insurance-wrap');
    insWrap.forEach(function(el) { el.style.display = isOwner ? 'block' : 'none'; });
  }, 100);

  var ownerEl = document.getElementById('db-owner-name');
  if (ownerEl) ownerEl.textContent = operator.owner_name || operator.email;

  var navStatus = document.getElementById('nav-status');
  if (navStatus) navStatus.style.display = 'flex';
  var navUser = document.getElementById('nav-user-name');
  if (navUser) navUser.textContent = operator.company_name;
  var navLogout = document.getElementById('nav-logout-btn');
  if (navLogout) navLogout.style.display = 'block';

  logActivity('system', 'Signed in to operator dashboard');
  showView('view-dashboard');
  loadRequests();
  loadFleet(operator.id);
}



// ‚ïê‚ïê LOAD CLIENT DASHBOARD ‚ïê‚ïê
function loadClientDashboard(client) {
  document.getElementById('cl-dash-name').textContent = client.first_name;
  document.getElementById('nav-status').style.display = 'flex';
  document.getElementById('nav-user-name').textContent = `${client.first_name} ${client.last_name}`;
  document.getElementById('nav-logout-btn').style.display = 'block';
  // view-client-dashboard not in operator app
}

// ‚ïê‚ïê LOAD REQUESTS (from Supabase) ‚ïê‚ïê
async function loadRequests() {
  try {
    const requests = await sb.select('booking_requests', '?status=eq.open&order=created_at.desc');
    const list = document.getElementById('requests-list');
    document.getElementById('d-stat-req').textContent = requests.length;

    if (!requests.length) {
      list.innerHTML = `<div class="empty-state"><div class="empty-icon"><svg width="28" height="28" viewBox="0 0 28 28" fill="none" stroke="var(--text3)" stroke-width="1.5"><path d="M4 20L14 6L24 20"/><line x1="4" y1="23" x2="24" y2="23"/></svg></div><div class="empty-title">No requests yet</div><div class="empty-sub">Client booking requests will appear here in real time.</div></div>`;
      return;
    }

    const badge = document.getElementById('sb-badge');
    badge.textContent = requests.length; badge.style.display = 'block';

    list.innerHTML = '';
    requests.forEach(r => {
      const card = document.createElement('div');
      card.className = 'req-card new-req';
      card.id = 'rc-' + r.id;
      card.innerHTML = `
        <div class="req-top">
          <div>
            <div class="req-route">${r.from_airport} ‚Üí ${r.to_airport}</div>
            <div class="req-meta">${r.from_city || ''} ‚Üí ${r.to_city || ''}</div>
          </div>
          <div class="req-badge new-b">
            <div style="width:5px;height:5px;border-radius:50%;background:#58A6FF;animation:pulse 1.2s infinite"></div>New
          </div>
        </div>
        <div class="req-details">
          <div><div class="req-detail-label">Date</div><div class="req-detail-value">${new Date(r.flight_date).toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'})}</div></div>
          <div><div class="req-detail-label">Time</div><div class="req-detail-value">${r.flight_time || 'Flexible'}</div></div>
          <div><div class="req-detail-label">Passengers</div><div class="req-detail-value">${r.passengers} pax</div></div>
          <div><div class="req-detail-label">Submitted</div><div class="req-detail-value">${new Date(r.created_at).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})}</div></div>
        </div>
        ${r.notes ? `<div style="font-size:12px;color:var(--text3);padding:8px 12px;background:var(--bg3);border-radius:8px;margin-bottom:12px">üìù ${r.notes}</div>` : ''}
        <div class="req-actions">
          <button class="req-btn quote-btn" onclick="openModal('${r.id}','${r.from_airport}','${r.to_airport}','${r.flight_date}','${r.passengers}')">Submit Quote</button>
          <button class="req-btn decline-btn">Decline</button>
        </div>
        <div id="qstate-${r.id}"></div>`;
      list.appendChild(card);
    });

  } catch (err) {
    showToast('error', '‚úï', 'Could not load requests', err.message);
  }
}

// ‚ïê‚ïê LOAD FLEET ‚ïê‚ïê
async function loadFleet(operatorId) {
  try {
    const fleet = await sb.select('fleet', `?operator_id=eq.${operatorId}`);
    const display = document.getElementById('fleet-display');
    if (!fleet.length) return;

    // Update quote modal aircraft options
    const qmAc = document.getElementById('qm-ac');
    if (qmAc) qmAc.innerHTML = fleet.map(f => `<option value="${f.id}">${f.aircraft_type} (${f.tail_number})</option>`).join('');

    // Seed Fleet Status Board with real aircraft
    fleet.forEach(function(f) {
      var tail = f.tail_number;
      if (tail && !FLEET_STATUS[tail]) {
        FLEET_STATUS[tail] = {
          status: f.status || 'available',
          aircraft: f.aircraft_type || 'Unknown',
          note: f.status_note || ''
        };
      }
    });
    renderFleetStatusBoard();

    display.innerHTML = fleet.map(f => `
      <div style="background:var(--card);border:1px solid var(--border);border-radius:16px;padding:18px;margin-bottom:12px;display:flex;align-items:center;gap:16px">
        <div style="width:52px;height:52px;border-radius:14px;background:rgba(229,168,60,0.1);border:1px solid rgba(229,168,60,0.2);display:flex;align-items:center;justify-content:center;flex-shrink:0">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--gold2)" stroke-width="1.8"><path d="M2 18L12 5L22 18"/><line x1="2" y1="20" x2="22" y2="20"/></svg>
        </div>
        <div style="flex:1">
          <div style="font-size:15px;font-weight:700;color:var(--text)">${f.aircraft_type}</div>
          <div style="font-size:11px;color:var(--text3);margin-top:2px">${f.tail_number} ¬∑ ${f.max_passengers || '‚Äî'} seats ¬∑ ${f.year || '‚Äî'} ¬∑ Base: ${f.home_fbo || '‚Äî'}</div>
        </div>
        <div style="background:rgba(79,208,128,0.12);border:1px solid rgba(79,208,128,0.3);color:var(--green2);font-size:10px;font-weight:800;padding:4px 10px;border-radius:8px">${f.status || 'Available'}</div>
      </div>`).join('');
  } catch (err) {
    console.error('Fleet load error:', err);
  }
}

// ‚ïê‚ïê LOAD CLIENT REQUESTS ‚ïê‚ïê
async function loadClientRequests(clientId) {
  try {
    var requests = await sb.select('booking_requests', '?client_id=eq.' + clientId + '&order=created_at.desc');
    var list = document.getElementById('cl-requests-list');
    if (!requests || !requests.length) {
      list.innerHTML = '<div style="font-size:12px;color:var(--text3);padding:32px;text-align:center">No trips yet. Submit your first booking above.</div>';
      return;
    }

    var statusDefs = {
      open:              { bg:'rgba(88,166,255,0.1)',   border:'rgba(88,166,255,0.3)',   color:'#58A6FF',        label:'üîµ Awaiting Quotes' },
      quoted:            { bg:'rgba(229,168,60,0.1)',   border:'rgba(229,168,60,0.3)',   color:'var(--gold2)',   label:'üíõ Quotes Received' },
      confirmed:         { bg:'rgba(79,208,128,0.1)',   border:'rgba(79,208,128,0.3)',   color:'var(--green2)',  label:'‚úÖ Confirmed' },
      manifest_complete: { bg:'rgba(79,208,128,0.1)',   border:'rgba(79,208,128,0.3)',   color:'var(--green2)',  label:'‚úÖ Ready to Fly' },
      departed:          { bg:'rgba(192,132,252,0.1)',  border:'rgba(192,132,252,0.3)',  color:'#C084FC',       label:'‚úà Departed' },
      completed:         { bg:'rgba(79,208,128,0.08)', border:'rgba(79,208,128,0.2)',   color:'var(--green2)',  label:'‚òë Completed' }
    };

    list.innerHTML = requests.map(function(r) {
      var isIntl = (r.notes || '').toLowerCase().includes('international');
      var s = statusDefs[r.status] || statusDefs.open;
      var tripType = r.trip_type === 'return' ? '‚Üî Return' : r.trip_type === 'multistop' ? '‚ú¶ Multi-Stop' : '‚Üí One Way';
      var dateStr = new Date(r.flight_date).toLocaleDateString('en-US',{weekday:'short',month:'short',day:'numeric',year:'numeric'});

      var actionBtn = '';
      if (r.status === 'quoted') {
        actionBtn = '<div style="display:flex;gap:8px;margin-top:12px">' +
          '<button onclick="openQuoteComparison(\'' + r.id + '\',' + r.passengers + ',' + (isIntl?'true':'false') + ')" ' +
          'style="flex:1;height:42px;border-radius:10px;border:none;background:linear-gradient(135deg,var(--gold),var(--gold2));color:var(--bg);font-family:\'DM Sans\',sans-serif;font-size:13px;font-weight:800;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px">' +
          '<svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><rect x="1" y="2" width="5" height="10" rx="2"/><rect x="8" y="2" width="5" height="10" rx="2"/></svg>' +
          'View & Compare Quotes</button></div>';
      } else if (r.status === 'manifest_complete') {
        actionBtn = '<div style="text-align:center;font-size:12px;color:var(--green2);font-weight:700;padding:10px;background:rgba(79,208,128,0.06);border-radius:8px;margin-top:10px">' +
          '‚úì Manifest complete ‚Äî awaiting operator confirmation</div>';
      } else if (r.status === 'completed') {
        actionBtn = '<div style="display:flex;gap:8px;margin-top:10px">' +
          '<button onclick="repeatBooking(\'' + r.id + '\')" ' +
          'style="flex:1;height:36px;border-radius:9px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:\'DM Sans\',sans-serif;font-size:12px;cursor:pointer">‚Ü© Repeat This Trip</button>' +
          '<button onclick="downloadReceipt(\'' + r.id + '\')" ' +
          'style="flex:1;height:36px;border-radius:9px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:\'DM Sans\',sans-serif;font-size:12px;cursor:pointer">‚¨á Receipt</button></div>';
      }

      return '<div style="background:var(--card);border:1px solid var(--border);border-radius:16px;padding:20px;margin-bottom:12px">' +
        '<div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px">' +
          '<div>' +
            '<div style="font-family:\'Playfair Display\',serif;font-size:24px;font-weight:600;color:var(--text)">' + r.from_airport + ' ‚Üí ' + r.to_airport + '</div>' +
            '<div style="font-size:11px;color:var(--text3);margin-top:3px">' + tripType + ' ¬∑ ' + dateStr + ' ¬∑ ' + r.passengers + ' pax</div>' +
          '</div>' +
          '<div style="background:' + s.bg + ';border:1px solid ' + s.border + ';color:' + s.color + ';font-size:10px;font-weight:800;padding:5px 12px;border-radius:8px;white-space:nowrap">' + s.label + '</div>' +
        '</div>' +
        (r.notes ? '<div style="font-size:11px;color:var(--text3);background:var(--bg3);border-radius:8px;padding:8px 12px;margin-bottom:10px;line-height:1.6">üìù ' + r.notes + '</div>' : '') +
        actionBtn +
      '</div>';
    }).join('');

  } catch (err) {
    console.error('Client requests load error:', err);
  }
}

// ‚îÄ‚îÄ Quote Comparison Modal ‚îÄ‚îÄ
async function openQuoteComparison(reqId, passengers, isIntl) {
  var modal = document.getElementById('quote-compare-modal');
  if (!modal) return;
  document.getElementById('qc-loading').style.display = 'block';
  document.getElementById('qc-cards').innerHTML = '';
  modal.classList.add('show');

  try {
    var quotes = await sb.select('quotes', '?booking_request_id=eq.' + reqId + '&status=eq.pending&order=price.asc');
    document.getElementById('qc-loading').style.display = 'none';

    if (!quotes || !quotes.length) {
      document.getElementById('qc-cards').innerHTML = '<div style="font-size:13px;color:var(--text3);text-align:center;padding:32px">No quotes available yet. Check back shortly.</div>';
      return;
    }

    document.getElementById('qc-cards').innerHTML = quotes.map(function(q, i) {
      var isBest = i === 0;
      var expiryText = '';
      if (q.expires_at) {
        var msLeft = new Date(q.expires_at) - Date.now();
        var hrsLeft = Math.max(0, Math.floor(msLeft / 3600000));
        expiryText = hrsLeft > 0 ? 'Expires in ' + hrsLeft + 'h' : 'Expiring soon';
      }
      return '<div style="background:var(--card);border:1.5px solid ' + (isBest ? 'var(--gold2)' : 'var(--border2)') + ';border-radius:16px;padding:20px;position:relative;' + (isBest ? 'box-shadow:0 0 0 1px rgba(229,168,60,0.25)' : '') + '">' +
        (isBest ? '<div style="position:absolute;top:-1px;left:16px;background:var(--gold2);color:var(--bg);font-size:9px;font-weight:900;letter-spacing:.1em;padding:3px 10px;border-radius:0 0 8px 8px">‚òÖ BEST PRICE</div>' : '') +
        '<div style="font-size:22px;font-weight:800;color:var(--text);margin-top:' + (isBest?'12px':'0') + ';margin-bottom:4px">$' + (q.price||0).toLocaleString() + '</div>' +
        '<div style="font-size:13px;font-weight:600;color:var(--text2);margin-bottom:12px">' + (q.aircraft_label || 'Aircraft not specified') + '</div>' +
        '<div style="display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-bottom:14px">' +
          '<div style="background:var(--bg3);border-radius:8px;padding:8px 10px"><div style="font-size:9px;font-weight:700;color:var(--text3);letter-spacing:.08em;text-transform:uppercase">Flight Time</div><div style="font-size:12px;font-weight:600;color:var(--text);margin-top:2px">' + (q.flight_time||'TBD') + '</div></div>' +
          '<div style="background:var(--bg3);border-radius:8px;padding:8px 10px"><div style="font-size:9px;font-weight:700;color:var(--text3);letter-spacing:.08em;text-transform:uppercase">Availability</div><div style="font-size:12px;font-weight:600;color:var(--green2);margin-top:2px">Confirmed</div></div>' +
        '</div>' +
        (q.notes ? '<div style="font-size:11px;color:var(--text3);background:var(--bg3);border-radius:8px;padding:8px 10px;margin-bottom:12px;line-height:1.5">üìù ' + q.notes + '</div>' : '') +
        (expiryText ? '<div style="font-size:10px;color:var(--text3);margin-bottom:10px">‚è± ' + expiryText + '</div>' : '') +
        '<button onclick="acceptQuote(\'' + q.id + '\',\'' + reqId + '\',' + passengers + ',' + (isIntl?'true':'false') + ')" ' +
        'style="width:100%;height:40px;border-radius:10px;border:none;background:' + (isBest?'linear-gradient(135deg,var(--gold),var(--gold2))':'var(--bg3)') + ';color:' + (isBest?'var(--bg)':'var(--text2)') + ';font-family:\'DM Sans\',sans-serif;font-size:13px;font-weight:800;cursor:pointer;border:1px solid ' + (isBest?'transparent':'var(--border2)') + '">' +
        'Select This Quote</button>' +
      '</div>';
    }).join('');
  } catch(err) {
    document.getElementById('qc-loading').style.display = 'none';
    document.getElementById('qc-cards').innerHTML = '<div style="color:#FF6B6B;font-size:12px;text-align:center;padding:20px">' + err.message + '</div>';
  }
}

function closeQuoteComparison() {
  var modal = document.getElementById('quote-compare-modal');
  if (modal) modal.classList.remove('show');
}

async function acceptQuote(quoteId, reqId, passengers, isIntl) {
  try {
    await sb.update('quotes', { status: 'accepted' }, '?id=eq.' + quoteId);
    await sb.update('booking_requests', { status: 'confirmed', accepted_quote_id: quoteId }, '?id=eq.' + reqId);
    closeQuoteComparison();
    showToast('success', '‚úì', 'Quote accepted!', 'Now please complete your passenger manifest.');
    setTimeout(function() { openManifest(null, passengers, isIntl); }, 500);
    if (currentClient) loadClientRequests(currentClient.id);
  } catch(err) {
    showToast('error', '‚úï', 'Could not accept quote', err.message);
  }
}

function repeatBooking(reqId) {
  showToast('success', '‚úì', 'Trip loaded', 'Pre-filled with your previous route. Adjust dates and submit.');
  showView('view-client-dashboard');
}

function downloadReceipt(reqId) {
  showToast('success', '‚úì', 'Receipt', 'Receipt download coming soon ‚Äî contact support@aviateatelier.com for now.');
}

// ‚îÄ‚îÄ PIC Pre-Departure Checklist ‚îÄ‚îÄ
function openPicChecklist(requestId, route) {
  var modal = document.getElementById('pic-checklist-modal');
  if (!modal) return;
  document.getElementById('pic-route-label').textContent = route || 'Scheduled Flight';
  modal.dataset.requestId = requestId || '';
  // Reset all checkboxes
  ['pic-chk-manifest','pic-chk-fuel','pic-chk-wx','pic-chk-notam','pic-chk-preflight','pic-chk-docs'].forEach(function(id) {
    var el = document.getElementById(id);
    if (el) { el.checked = false; el.dispatchEvent(new Event('change')); }
  });
  document.getElementById('pic-confirm-btn').disabled = true;
  modal.classList.add('show');
}

function closePicChecklist() {
  var modal = document.getElementById('pic-checklist-modal');
  if (modal) modal.classList.remove('show');
}

function checkPicReady() {
  var ids = ['pic-chk-manifest','pic-chk-fuel','pic-chk-wx','pic-chk-notam','pic-chk-preflight','pic-chk-docs'];
  var allChecked = ids.every(function(id) {
    var el = document.getElementById(id); return el && el.checked;
  });
  var btn = document.getElementById('pic-confirm-btn');
  if (btn) btn.disabled = !allChecked;
}

function confirmPicDeparture() {
  var modal = document.getElementById('pic-checklist-modal');
  var reqId = modal ? modal.dataset.requestId : '';
  var route = document.getElementById('pic-route-label') ? document.getElementById('pic-route-label').textContent : 'Flight';
  logActivity('booking', 'PIC pre-departure checklist confirmed: ' + route);
  showToast('success', '‚úì', 'Departure confirmed', 'PIC sign-off recorded. Safe flight!');
  closePicChecklist();
  // Update status board if tail known
  renderFleetStatusBoard();
}

// ‚ïê‚ïê CLIENT SUBMIT BOOKING REQUEST ‚ïê‚ïê
async function submitBookingRequest() {
  if (!currentClient) { showToast('error', '‚úï', 'Not signed in', 'Please sign in to submit a request.'); return; }

  const from = document.getElementById('req-from').value.trim();
  const to = document.getElementById('req-to').value.trim();
  const date = document.getElementById('req-date').value;
  const pax = document.getElementById('req-pax').value;
  const time = document.getElementById('req-time').value;
  const notes = document.getElementById('req-notes').value.trim();

  if (!from || !to || !date) { showToast('error', '‚úï', 'Missing details', 'Please fill in departure, destination, and date.'); return; }

  // Build preferences summary
  const prefList = Array.from(activePrefs);
  let prefNotes = '';
  if (prefList.includes('catering')) {
    const level = document.getElementById('req-catering-level')?.value || '';
    const diet = document.getElementById('req-dietary')?.value || '';
    prefNotes += `Catering: ${level}${diet !== 'None / Standard' ? ' ¬∑ ' + diet : ''}. `;
  }
  if (prefList.includes('transport')) {
    const type = document.getElementById('req-transport-type')?.value || '';
    const addr = document.getElementById('req-transport-addr')?.value || '';
    prefNotes += `Ground Transport: ${type}${addr ? ' from ' + addr : ''}. `;
  }
  if (prefList.includes('pet')) {
    const breed = document.getElementById('req-pet-breed')?.value || '';
    const weight = document.getElementById('req-pet-weight')?.value || '';
    prefNotes += `Pet on board: ${breed}${weight ? ' ' + weight + 'lbs' : ''}. `;
  }
  if (prefList.includes('luggage')) {
    const count = document.getElementById('req-luggage-count')?.value || '';
    const items = document.getElementById('req-luggage-items')?.value || '';
    prefNotes += `Heavy Luggage: ${count}${items ? ' ‚Äî ' + items : ''}. `;
  }
  if (prefList.includes('wifi')) prefNotes += 'WiFi required. ';
  if (prefList.includes('standup')) prefNotes += 'Stand-up cabin required. ';
  if (prefList.includes('wheelchair')) prefNotes += 'Accessibility accommodations needed. ';
  if (prefList.includes('international')) prefNotes += 'International flight. ';

  // Minor info
  let minorNotes = '';
  if (minorsOn) {
    const count = document.getElementById('req-minors-count')?.value || '';
    const accompanied = document.getElementById('req-minors-accompanied')?.value || '';
    const ages = document.getElementById('req-minors-ages')?.value || '';
    minorNotes = `MINORS ON BOARD: ${count} minor(s), ${accompanied === 'yes' ? 'accompanied' : 'UNACCOMPANIED'}${ages ? ', ages: ' + ages : ''}. `;
  }

  const tripTypeLabel = currentTripType === 'oneway' ? 'One Way' : currentTripType === 'return' ? 'Return' : 'Multi-Stop';
  const returnInfo = currentTripType === 'return' ? `Return date: ${document.getElementById('req-return-date')?.value || 'TBD'}. ` : '';
  const fullNotes = [minorNotes, prefNotes, returnInfo, notes].filter(Boolean).join(' ').trim();

  const btn = document.getElementById('req-submit-btn');
  btn.classList.add('loading'); btn.textContent = 'Getting quotes...';

  try {
    const [saved] = await sb.insert('booking_requests', {
      client_id: currentClient.id,
      trip_type: currentTripType,
      from_airport: from.split('‚Äî')[0].trim().toUpperCase(),
      from_city: from.includes('‚Äî') ? from.split('‚Äî')[1].trim() : from,
      to_airport: to.split('‚Äî')[0].trim().toUpperCase(),
      to_city: to.includes('‚Äî') ? to.split('‚Äî')[1].trim() : to,
      flight_date: date,
      flight_time: time || 'Flexible',
      passengers: parseInt(pax),
      notes: fullNotes || null,
      status: 'open'
    });

    btn.classList.remove('loading');
    btn.innerHTML = '<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2"><polygon points="8,1 10.5,6 16,6.8 12,10.7 12.9,16 8,13.5 3.1,16 4,10.7 0,6.8 5.5,6"/></svg> Get Instant Quotes';

    // Reset form
    document.getElementById('req-from').value = '';
    document.getElementById('req-to').value = '';
    document.getElementById('req-notes').value = '';
    activePrefs.forEach(p => {
      document.getElementById('pref-' + p)?.classList.remove('selected');
      if (prefDetails[p]) document.getElementById(prefDetails[p]).style.display = 'none';
    });
    activePrefs.clear();
    if (minorsOn) toggleMinors();

    showToast('success', '‚úì', 'Request sent to verified operators', `${saved.from_airport} ‚Üí ${saved.to_airport} ¬∑ ${pax} pax`);
    loadClientRequests(currentClient.id);

  } catch (err) {
    btn.classList.remove('loading');
    btn.innerHTML = '<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2"><polygon points="8,1 10.5,6 16,6.8 12,10.7 12.9,16 8,13.5 3.1,16 4,10.7 0,6.8 5.5,6"/></svg> Get Instant Quotes';
    showToast('error', '‚úï', 'Could not submit request', err.message);
  }
}


// ‚ïê‚ïê COMMISSION ENGINE ‚ïê‚ïê
// Internal only ‚Äî operators see net payout, not fee breakdown
function calcCommission(price) {
  if (price >= 75000)      return { rate: 0.025, label: '2.5%' };
  if (price >= 35000)      return { rate: 0.030, label: '3%'   };
  if (price >= 15000)      return { rate: 0.040, label: '4%'   };
  return                          { rate: 0.050, label: '5%'   };
}
function operatorNet(price) {
  var c = calcCommission(price);
  return Math.round(price * (1 - c.rate));
}

// ‚ïê‚ïê QUOTE MODAL ‚ïê‚ïê
function openModal(id, from, to, date, pax) {
  activeReqId = id;
  document.getElementById('qm-sub').textContent = `${from} ‚Üí ${to} ¬∑ ${new Date(date).toLocaleDateString('en-US',{month:'short',day:'numeric'})} ¬∑ ${pax} pax`;
  document.getElementById('quote-modal').classList.add('show');
  updateSettle();
}

function closeModal() { document.getElementById('quote-modal').classList.remove('show'); }

function updateSettle() {
  var price = parseFloat(document.getElementById('qm-price').value) || 0;
  var c = calcCommission(price);
  document.getElementById('sp-quote').textContent = '$' + price.toLocaleString();
  document.getElementById('sp-fee').textContent  = '-$' + c.fee.toLocaleString() + ' (' + c.rate + '%)';
  document.getElementById('sp-net').textContent  = '$' + c.net.toLocaleString();
}

// ‚ïê‚ïê SUBMIT QUOTE ‚Äî SAVE TO SUPABASE ‚ïê‚ïê
async function submitQuote() {
  var price = parseFloat(document.getElementById('qm-price').value) || 0;
  var aircraftSelect = document.getElementById('qm-ac');
  var aircraftLabel = aircraftSelect.options[aircraftSelect.selectedIndex].text;
  var flightTime = document.getElementById('qm-time').value;
  var notes = (document.getElementById('qm-notes') ? document.getElementById('qm-notes').value.trim() : '');
  var expiryHrs = (document.getElementById('qm-expiry') ? parseInt(document.getElementById('qm-expiry').value) : 24);
  var btn = document.getElementById('qm-submit-btn');
  var c = calcCommission(price);

  if (!price || price < 100) { showToast('error', '‚úï', 'Invalid price', 'Enter a quote amount greater than $100.'); return; }
  btn.classList.add('loading'); btn.textContent = 'Sending quote...';

  try {
    var expiresAt = new Date(Date.now() + expiryHrs * 3600000).toISOString();
    var saved = await sb.insert('quotes', {
      booking_request_id: activeReqId,
      operator_id: currentOperator.id,
      price: price,
      commission_fee: c.fee,
      operator_net: c.net,
      aircraft_label: aircraftLabel,
      flight_time: flightTime,
      notes: notes || null,
      expires_at: expiresAt,
      status: 'pending'
    });

    await sb.update('booking_requests', { status: 'quoted' }, '?id=eq.' + activeReqId);

    quoteCount++;
    settleTotal += c.net;
    document.getElementById('d-stat-quotes').textContent = quoteCount;
    document.getElementById('d-stat-revenue').textContent = '$' + settleTotal.toLocaleString();

    // Update request card UI
    var card = document.getElementById('rc-' + activeReqId);
    if (card) {
      card.classList.remove('new-req');
      var badge = card.querySelector('.req-badge');
      if (badge) { badge.className = 'req-badge quoted-b'; badge.innerHTML = '‚úì Quoted'; }
      var actions = card.querySelector('.req-actions');
      if (actions) actions.style.display = 'none';
      var qstate = document.getElementById('qstate-' + activeReqId);
      if (qstate) {
        qstate.innerHTML = '<div class="payout-clean">' +
          '<div class="payout-row"><div class="payout-label">Aircraft</div><div class="payout-value">' + aircraftLabel + '</div></div>' +
          '<div class="payout-row"><div class="payout-label">Quote to client</div><div class="payout-value">$' + price.toLocaleString() + '</div></div>' +
          '<div class="payout-row"><div class="payout-label">Platform fee (' + c.rate + '%)</div><div class="payout-value" style="color:var(--text3)">-$' + c.fee.toLocaleString() + '</div></div>' +
          '<div class="payout-row"><div class="payout-label">Your settlement</div><div class="payout-value green">$' + c.net.toLocaleString() + '</div></div>' +
          '<div class="payout-row"><div class="payout-label">Expires</div><div class="payout-value" style="color:var(--text3)">' + expiryHrs + 'h from now</div></div>' +
          '</div>';
      }
    }

    logActivity('quote', 'Quote submitted: ' + aircraftLabel + ' ¬∑ $' + price.toLocaleString() + ' ‚Üí net $' + c.net.toLocaleString());
    btn.classList.remove('loading');
    btn.innerHTML = '<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M2 8l4 4 8-8"/></svg> Send Quote to Client';
    closeModal();
    showToast('success', '‚úì', 'Quote sent to client', '$' + price.toLocaleString() + ' ¬∑ ' + aircraftLabel);

  } catch (err) {
    btn.classList.remove('loading');
    btn.innerHTML = '<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M2 8l4 4 8-8"/></svg> Send Quote to Client';
    showToast('error', '‚úï', 'Could not send quote', err.message);
  }
}

// ‚ïê‚ïê DASHBOARD TABS ‚ïê‚ïê
function switchDashTab(tab) {
  ['requests','bookings','fleet','status','activity','pilots'].forEach(function(t) {
    var el = document.getElementById('dtab-' + t);
    if (el) el.style.display = t === tab ? 'block' : 'none';
    var si = document.querySelector('.sidebar-item[onclick="switchDashTab(\'' + t + '\')"]');
    if (si) si.classList.toggle('active', t === tab);
  });
  if (tab === 'pilots') { setTimeout(function(){ loadPilotsFromDB ? loadPilotsFromDB() : renderPilotRoster(); }, 50); }
  var titles = {
    requests:  ['New Requests',       'Incoming booking requests matching your fleet'],
    bookings:  ['Active Bookings',    'Confirmed bookings and upcoming flights'],
    fleet:     ['Fleet & Certifications','Your aircraft and compliance status'],
    osa:       ['My Agreement',       'Your signed Operator Services Agreement'],
    status:    ['Fleet Status Board', 'Real-time aircraft availability and status'],
    activity:  ['Activity Log',       'Audit trail of all operator and staff actions'],
    pilots:    ['Pilot Roster',         'Available verified pilots ‚Äî request directly']
  };
  var entry = titles[tab] || ['Dashboard',''];
  document.getElementById('dash-page-title').textContent = entry[0];
  document.getElementById('dash-page-sub').textContent   = entry[1];
  if (tab === 'fleet'    && currentOperator) loadFleet(currentOperator.id);
  if (tab === 'requests')  loadRequests();
  if (tab === 'status')    setTimeout(renderFleetStatusBoard, 50);
  if (tab === 'activity')  setTimeout(renderActivityLog, 50);
  if (tab === 'fleet')     setTimeout(renderTeamTab, 50);
}

// ‚ïê‚ïê LOGOUT ‚ïê‚ïê
async function logout() {
  await _sb.auth.signOut();
  _opUser = null; _opRecord = null;
  showView('view-landing');
}

// ‚ïê‚ïê TOAST ‚ïê‚ïê
function showToast(type, icon, title, sub) {
  const t = document.getElementById('toast');
  const wrap = document.getElementById('toast-icon-wrap');
  t.className = 'toast ' + (type === 'error' ? 'error' : 'success');
  wrap.className = 'toast-icon-wrap' + (type === 'error' ? ' error' : '');
  const iconColor = type === 'error' ? '#FF6B6B' : 'var(--green2)';
  wrap.innerHTML = `<svg width="18" height="18" viewBox="0 0 18 18" fill="none" stroke="${iconColor}" stroke-width="2.5"><path d="${type === 'error' ? 'M4 4l10 10M14 4L4 14' : 'M3 9l5 5 7-8'}"/></svg>`;
  document.getElementById('toast-title').textContent = title;
  document.getElementById('toast-sub').textContent = sub;
  t.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => t.classList.remove('show'), 4500);
}



// ‚ïê‚ïê AIRCRAFT FLEET BUILDER ‚ïê‚ïê
let aircraftCount = 0;

function buildAircraftOptions() {
  const categories = ["VLJ","Light Jet","Midsize","Super Midsize","Heavy","Ultra Long Range","Turboprop","Piston","Helicopter","Seaplane"];
  let html = '<option value="">-- Select Aircraft --</option>';
  categories.forEach(cat => {
    const planes = AIRCRAFT_DB.filter(a => a.category === cat);
    if (planes.length) {
      html += '<optgroup label="' + cat + '">';
      planes.forEach(a => {
        html += '<option value="' + a.make + '|' + a.model + '">' + a.make + ' ' + a.model + '</option>';
      });
      html += '</optgroup>';
    }
  });
  return html;
}

function addAircraftCard() {
  aircraftCount++;
  var n = aircraftCount;
  var div = document.createElement('div');
  div.id = 'ac-card-' + n;
  div.style.cssText = 'background:var(--card);border:1.5px solid var(--border2);border-radius:16px;padding:22px;margin-bottom:16px';

  var removeBtn = n > 1
    ? '<button onclick="removeAircraftCard(' + n + ')" style="background:none;border:none;color:var(--text3);cursor:pointer;font-size:11px;font-weight:700">Remove</button>'
    : '';

  div.innerHTML =

    // ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ
    '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:18px">' +
      '<div style="font-size:12px;font-weight:700;color:var(--gold2);letter-spacing:.08em;text-transform:uppercase">Aircraft #' + n + '</div>' +
      removeBtn +
    '</div>' +

    // ‚îÄ‚îÄ AIRCRAFT TYPE SELECT ‚îÄ‚îÄ
    '<div style="margin-bottom:14px">' +
      '<div class="field-label">Aircraft Type <span class="field-required">Required</span></div>' +
      '<select class="field-select" id="ac-select-' + n + '">' + buildAircraftOptions() + '</select>' +
    '</div>' +

    // ‚îÄ‚îÄ AUTO-FILLED SPECS PANEL ‚îÄ‚îÄ
    '<div id="ac-specs-' + n + '" style="display:none;background:var(--bg3);border:1px solid var(--border2);border-radius:12px;padding:14px;margin-bottom:16px">' +
      '<div style="font-size:10px;font-weight:700;letter-spacing:.1em;text-transform:uppercase;color:var(--gold2);margin-bottom:10px">Type Specifications (auto-filled)</div>' +
      '<div id="ac-specs-grid-' + n + '" style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px"></div>' +
    '</div>' +

    // ‚îÄ‚îÄ SECTION: REGISTRATION ‚îÄ‚îÄ
    '<div class="aircraft-section-label">Registration</div>' +
    '<div class="aircraft-grid-4">' +
      '<div><div class="field-label">Tail / Registration No. <span class="field-required">Required</span></div>' +
        '<input class="field-input fleet-tail" id="ac-tail-' + n + '" placeholder="N481SP" style="font-family:monospace;font-size:15px;font-weight:700;text-transform:uppercase"></div>' +
      '<div><div class="field-label">Year of Manufacture</div>' +
        '<input class="field-input" id="ac-year-' + n + '" placeholder="2021" type="number" min="1950" max="2026"></div>' +
      '<div><div class="field-label">Serial Number</div>' +
        '<input class="field-input" id="ac-serial-' + n + '" placeholder="MSN-0000" style="font-family:monospace"></div>' +
      '<div><div class="field-label">Country of Registration</div>' +
        '<input class="field-input" id="ac-reg-country-' + n + '" placeholder="USA" value="USA"></div>' +
    '</div>' +

    // ‚îÄ‚îÄ SECTION: BASE & CAPACITY ‚îÄ‚îÄ
    '<div class="aircraft-section-label">Base &amp; Capacity</div>' +
    '<div class="aircraft-grid-4">' +
      '<div style="position:relative"><div class="field-label">Home Base Airport <span class="field-required">Required</span></div>' +
        '<input class="field-input fleet-fbo" id="ac-fbo-' + n + '" placeholder="Search airport..." autocomplete="off" style="font-family:monospace;font-weight:700">' +
        '<div id="ac-fbo-drop-' + n + '" class="airport-dropdown" style="display:none"></div></div>' +
      '<div><div class="field-label">Secondary Base</div>' +
        '<input class="field-input" id="ac-fbo2-' + n + '" placeholder="Optional FBO"></div>' +
      // Max Passengers ‚Äî shown in editable specs panel above
      '<div><div class="field-label">Max Payload (lbs)</div>' +
        '<input class="field-input" id="ac-payload-' + n + '" placeholder="Auto-filled" type="number"></div>' +
    '</div>' +

    // ‚îÄ‚îÄ SECTION: INTERIOR ‚îÄ‚îÄ
    '<div class="aircraft-section-label">Interior</div>' +
    '<div class="aircraft-grid-4">' +
      '<div><div class="field-label">Seating Configuration</div>' +
        '<select class="field-select" id="ac-config-' + n + '">' +
          '<option value="standard">Standard Forward-Facing</option>' +
          '<option value="club">Club / Facing Seats</option>' +
          '<option value="vip">VIP Executive Layout</option>' +
          '<option value="divan">Divan / Sofa Seating</option>' +
          '<option value="med">Medical / Medevac</option>' +
          '<option value="cargo">Cargo Configuration</option>' +
          '<option value="combi">Combi Pax + Cargo</option>' +
        '</select></div>' +
      '<div><div class="field-label">Interior Refurb Year</div>' +
        '<input class="field-input" id="ac-refurb-' + n + '" placeholder="e.g. 2023" type="number" min="1990" max="2026"></div>' +
      '<div><div class="field-label">Cabin Width (inches)</div>' +
        '<input class="field-input" id="ac-cabin-w-' + n + '" placeholder="Auto-filled" type="number"></div>' +
      '<div><div class="field-label">Cabin Height (inches)</div>' +
        '<input class="field-input" id="ac-cabin-h-' + n + '" placeholder="Stand-up if 60+" type="number"></div>' +
    '</div>' +
    '<div class="aircraft-grid-3">' +
      '<div><div class="field-label">Lavatory</div>' +
        '<select class="field-select" id="ac-lav-' + n + '">' +
          '<option value="none">None</option>' +
          '<option value="enclosed">Enclosed</option>' +
          '<option value="private">Private / Full Door</option>' +
          '<option value="multi">Multiple Lavatories</option>' +
        '</select></div>' +
      '<div><div class="field-label">Galley / Catering</div>' +
        '<select class="field-select" id="ac-galley-' + n + '">' +
          '<option value="none">None</option>' +
          '<option value="snack">Snack / Beverage Bar</option>' +
          '<option value="forward">Forward Galley</option>' +
          '<option value="full">Full Galley</option>' +
        '</select></div>' +
      // Baggage Volume ‚Äî shown in editable specs panel above
    '</div>' +

    // ‚îÄ‚îÄ SECTION: AVIONICS & TECH ‚îÄ‚îÄ
    '<div class="aircraft-section-label">Avionics &amp; Technology</div>' +
    '<div class="aircraft-grid-3">' +
      '<div><div class="field-label">Flight Deck / Avionics Suite</div>' +
        '<select class="field-select" id="ac-avionics-' + n + '">' +
          '<option value="">Unknown</option>' +
          '<option value="garmin-g1000">Garmin G1000</option>' +
          '<option value="garmin-g3000">Garmin G3000</option>' +
          '<option value="garmin-g5000">Garmin G5000</option>' +
          '<option value="garmin-g700">Garmin G700</option>' +
          '<option value="collins-pro-line">Collins Pro Line</option>' +
          '<option value="collins-pro-line-21">Collins Pro Line 21</option>' +
          '<option value="honeywell-primus">Honeywell Primus</option>' +
          '<option value="honeywell-apex">Honeywell Apex</option>' +
          '<option value="rockwell-collins">Rockwell Collins</option>' +
          '<option value="universal-avionics">Universal Avionics</option>' +
          '<option value="other">Other / Legacy</option>' +
        '</select></div>' +
      '<div><div class="field-label">Wifi Provider</div>' +
        '<select class="field-select" id="ac-wifi-type-' + n + '">' +
          '<option value="none">No WiFi</option>' +
          '<option value="viasat">Viasat</option>' +
          '<option value="gogo">Gogo</option>' +
          '<option value="iridium">Iridium</option>' +
          '<option value="starlink">Starlink</option>' +
          '<option value="honeywell-jetwave">Honeywell JetWave</option>' +
          '<option value="sievert">SievertNet</option>' +
          '<option value="satcom">Generic Satcom</option>' +
        '</select></div>' +
      '<div><div class="field-label">In-Flight Entertainment</div>' +
        '<select class="field-select" id="ac-ife-' + n + '">' +
          '<option value="none">None</option>' +
          '<option value="monitors">Cabin Monitors</option>' +
          '<option value="streaming">Streaming System</option>' +
          '<option value="full">Full IFE System</option>' +
        '</select></div>' +
    '</div>' +

    // ‚îÄ‚îÄ SECTION: MAINTENANCE & COMPLIANCE ‚îÄ‚îÄ
    '<div class="aircraft-section-label">Maintenance &amp; Compliance</div>' +
    '<div class="aircraft-grid-4">' +
      '<div><div class="field-label">Total Airframe Hours</div>' +
        '<input class="field-input" id="ac-tt-' + n + '" placeholder="e.g. 3200" type="number"></div>' +
      '<div><div class="field-label">Airworthiness Certificate</div>' +
        '<select class="field-select" id="ac-aw-type-' + n + '">' +
          '<option value="standard">Standard</option>' +
          '<option value="restricted">Restricted</option>' +
          '<option value="special">Special</option>' +
        '</select></div>' +
      '<div><div class="field-label">Last Heavy Maint. (C/D Check)</div>' +
        '<input class="field-input" id="ac-maint-last-' + n + '" type="date"></div>' +
      '<div><div class="field-label">Next Maint. Due</div>' +
        '<input class="field-input" id="ac-maint-next-' + n + '" type="date"></div>' +
    '</div>' +
    '<div class="aircraft-grid-4">' +
      '<div><div class="field-label">Engine 1 Hours</div>' +
        '<input class="field-input" id="ac-eng1-' + n + '" placeholder="e.g. 1800" type="number"></div>' +
      '<div><div class="field-label">Engine 2 Hours</div>' +
        '<input class="field-input" id="ac-eng2-' + n + '" placeholder="N/A if single" type="number"></div>' +
      '<div><div class="field-label">Engine Overhaul Due</div>' +
        '<input class="field-input" id="ac-eng-oh-' + n + '" type="date"></div>' +
      '<div><div class="field-label">Prop / APU Status</div>' +
        '<input class="field-input" id="ac-apu-' + n + '" placeholder="e.g. Serviceable"></div>' +
    '</div>' +

    // ‚îÄ‚îÄ SECTION: INSURANCE & PRICING ‚îÄ‚îÄ
    '<div class="ac-insurance-wrap">' +
    '<div class="aircraft-section-label">Insurance &amp; Pricing</div>' +
    '<div class="aircraft-grid-4">' +
      '<div><div class="field-label">Hull Value (USD)</div>' +
        '<input class="field-input" id="ac-hull-' + n + '" placeholder="e.g. 8,000,000"></div>' +
      '<div><div class="field-label">Liability Coverage (USD)</div>' +
        '<input class="field-input" id="ac-liability-' + n + '" placeholder="e.g. 100,000,000"></div>' +
      '<div><div class="field-label">Insurance Expiry</div>' +
        '<input class="field-input" id="ac-ins-exp-' + n + '" type="date"></div>' +
      // Hourly Rate ‚Äî shown in editable specs panel above
    '</div>' +
    '<div class="aircraft-grid-3">' +
      '<div><div class="field-label">Minimum Flight Time</div>' +
        '<select class="field-select" id="ac-min-hrs-' + n + '">' +
          '<option value="0">No minimum</option>' +
          '<option value="1">1 hour</option>' +
          '<option value="1.5">1.5 hours</option>' +
          '<option value="2">2 hours</option>' +
          '<option value="3">3 hours</option>' +
        '</select></div>' +
      '<div><div class="field-label">Positioning / Ferry Fee</div>' +
        '<select class="field-select" id="ac-ferry-' + n + '">' +
          '<option value="free">No ferry charge</option>' +
          '<option value="charged">Ferry charged to client</option>' +
          '<option value="negotiable">Negotiable</option>' +
        '</select></div>' +
      '<div><div class="field-label">Overnight Fee Policy</div>' +
        '<select class="field-select" id="ac-overnight-' + n + '">' +
          '<option value="included">Crew overnight included</option>' +
          '<option value="charged">Crew overnight charged</option>' +
          '<option value="negotiable">Negotiable</option>' +
        '</select></div>' +
    '</div>' +

    // ‚îÄ‚îÄ SECTION: AMENITIES CHECKBOXES ‚îÄ‚îÄ
    '</div>' +
    '<div class="aircraft-section-label">Amenities &amp; Capabilities</div>' +
    '<div class="aircraft-grid-4" style="gap:8px">' +
      '<label style="display:flex;align-items:center;gap:7px;font-size:12px;color:var(--text2);cursor:pointer;background:var(--bg3);border:1px solid var(--border2);border-radius:8px;padding:8px 10px"><input type="checkbox" id="ac-wifi-' + n + '"> WiFi On Board</label>' +
      '<label style="display:flex;align-items:center;gap:7px;font-size:12px;color:var(--text2);cursor:pointer;background:var(--bg3);border:1px solid var(--border2);border-radius:8px;padding:8px 10px"><input type="checkbox" id="ac-catering-' + n + '"> Catering Available</label>' +
      '<label style="display:flex;align-items:center;gap:7px;font-size:12px;color:var(--text2);cursor:pointer;background:var(--bg3);border:1px solid var(--border2);border-radius:8px;padding:8px 10px"><input type="checkbox" id="ac-pets-' + n + '"> Pets Allowed</label>' +
      '<label style="display:flex;align-items:center;gap:7px;font-size:12px;color:var(--text2);cursor:pointer;background:var(--bg3);border:1px solid var(--border2);border-radius:8px;padding:8px 10px"><input type="checkbox" id="ac-smk-' + n + '"> Smoking Permitted</label>' +
      '<label style="display:flex;align-items:center;gap:7px;font-size:12px;color:var(--text2);cursor:pointer;background:var(--bg3);border:1px solid var(--border2);border-radius:8px;padding:8px 10px"><input type="checkbox" id="ac-gpu-' + n + '"> GPU Available</label>' +
      '<label style="display:flex;align-items:center;gap:7px;font-size:12px;color:var(--text2);cursor:pointer;background:var(--bg3);border:1px solid var(--border2);border-radius:8px;padding:8px 10px"><input type="checkbox" id="ac-sat-' + n + '"> Satellite Phone</label>' +
      '<label style="display:flex;align-items:center;gap:7px;font-size:12px;color:var(--text2);cursor:pointer;background:var(--bg3);border:1px solid var(--border2);border-radius:8px;padding:8px 10px"><input type="checkbox" id="ac-aed-' + n + '"> AED / Defibrillator</label>' +
      '<label style="display:flex;align-items:center;gap:7px;font-size:12px;color:var(--text2);cursor:pointer;background:var(--bg3);border:1px solid var(--border2);border-radius:8px;padding:8px 10px"><input type="checkbox" id="ac-o2-' + n + '"> Medical Oxygen</label>' +
      '<label style="display:flex;align-items:center;gap:7px;font-size:12px;color:var(--text2);cursor:pointer;background:var(--bg3);border:1px solid var(--border2);border-radius:8px;padding:8px 10px"><input type="checkbox" id="ac-child-' + n + '"> Child Seat Compatible</label>' +
      '<label style="display:flex;align-items:center;gap:7px;font-size:12px;color:var(--text2);cursor:pointer;background:var(--bg3);border:1px solid var(--border2);border-radius:8px;padding:8px 10px"><input type="checkbox" id="ac-medevac-' + n + '"> Medevac Equipped</label>' +
      '<label style="display:flex;align-items:center;gap:7px;font-size:12px;color:var(--text2);cursor:pointer;background:var(--bg3);border:1px solid var(--border2);border-radius:8px;padding:8px 10px"><input type="checkbox" id="ac-cargo-door-' + n + '"> Cargo Door</label>' +
      '<label style="display:flex;align-items:center;gap:7px;font-size:12px;color:var(--text2);cursor:pointer;background:var(--bg3);border:1px solid var(--border2);border-radius:8px;padding:8px 10px"><input type="checkbox" id="ac-intl-' + n + '"> International Ops Approved</label>' +
    '</div>' +

    // ‚îÄ‚îÄ SECTION: ADDITIONAL NOTES ‚îÄ‚îÄ
    '<div style="margin-top:4px">' +
      '<div class="field-label">Additional Notes / Special Capabilities</div>' +
      '<textarea class="field-input" id="ac-notes-' + n + '" placeholder="e.g. Short runway capable, floats equipped, pressurized, hot-and-high certified, RVSM approved..." style="height:64px;resize:vertical;padding-top:10px"></textarea>' +
    '</div>';

  document.getElementById('fleet-list').appendChild(div);

  // Wire up select and airport search
  document.getElementById('ac-select-' + n).addEventListener('change', function() { onAircraftSelect(n); });
  var fboInput = document.getElementById('ac-fbo-' + n);
  var fboDropId = 'ac-fbo-drop-' + n;
  fboInput.addEventListener('input', function() { airportSearch(this, fboDropId); });
  fboInput.addEventListener('blur', function() { setTimeout(function() { hideDropdown(fboDropId); }, 200); });
}


function onAircraftSelect(n) {
  var val = document.getElementById('ac-select-' + n).value;
  if (!val) { document.getElementById('ac-specs-' + n).style.display = 'none'; return; }
  var parts = val.split('|');
  var ac = AIRCRAFT_DB.find(function(a) { return a.make === parts[0] && a.model === parts[1]; });
  if (!ac) return;

  // Auto-fill operator-editable fields (only if currently empty)
  var setIfEmpty = function(id, val) {
    var el = document.getElementById(id);
    if (el && !el.value) el.value = val;
  };
  setIfEmpty('ac-pax-' + n, ac.pax);
  setIfEmpty('ac-payload-' + n, Math.round(ac.pax * 190 + 150));
  setIfEmpty('ac-rate-' + n, ac.hourly_est);
  if (ac.baggage_cuft) setIfEmpty('ac-baggage-' + n, ac.baggage_cuft);

  // Build specs panel ‚Äî READ-ONLY facts on the left, EDITABLE operator fields on right
  var specGrid = document.getElementById('ac-specs-grid-' + n);
  if (!specGrid) return;

  // Read-only type specs
  var readOnly = [
    { label:'Category',     value: ac.category },
    { label:'Range',        value: ac.range_nm.toLocaleString() + ' nm' },
    { label:'Cruise Speed', value: ac.speed_ktas + ' ktas' },
    { label:'Ceiling',      value: 'FL' + Math.round(ac.ceiling_ft / 1000) + '0' },
    { label:'Engines',      value: ac.engines + 'x ' + ac.engine_type },
  ];
  var readOnlyHtml = readOnly.map(function(s) {
    return '<div style="background:var(--card);border-radius:8px;padding:8px 10px">' +
      '<div style="font-size:9px;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:var(--text3);margin-bottom:3px">' + s.label + '</div>' +
      '<div style="font-size:12px;font-weight:600;color:var(--text)">' + s.value + '</div></div>';
  }).join('');

  // Editable operator fields with pencil hint
  var editNote = '<div style="font-size:9px;color:var(--gold2);margin-bottom:2px">&#9998; Edit to match your aircraft</div>';
  var editableHtml =
    '<div style="background:var(--card);border:1.5px dashed var(--gold2);border-radius:8px;padding:8px 10px;grid-column:span 1">' +
      '<div style="font-size:9px;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:var(--text3);margin-bottom:2px">Max Passengers &#9998;</div>' +
      '<input id="ac-pax-' + n + '" type="number" min="1" max="80" value="' + ac.pax + '" style="width:100%;background:transparent;border:none;outline:none;font-size:14px;font-weight:700;color:var(--gold2);font-family:monospace">' +
    '</div>' +
    '<div style="background:var(--card);border:1.5px dashed var(--gold2);border-radius:8px;padding:8px 10px">' +
      '<div style="font-size:9px;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:var(--text3);margin-bottom:2px">Baggage (cu ft) &#9998;</div>' +
      '<input id="ac-baggage-' + n + '" type="number" min="0" value="' + (ac.baggage_cuft || '') + '" placeholder="Enter cu ft" style="width:100%;background:transparent;border:none;outline:none;font-size:14px;font-weight:700;color:var(--gold2);font-family:monospace">' +
    '</div>' +
    '<div style="background:var(--card);border:1.5px dashed var(--gold2);border-radius:8px;padding:8px 10px">' +
      '<div style="font-size:9px;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:var(--text3);margin-bottom:2px">Your Hourly Rate (USD) &#9998;</div>' +
      '<input id="ac-rate-' + n + '" type="number" min="0" value="' + ac.hourly_est + '" style="width:100%;background:transparent;border:none;outline:none;font-size:14px;font-weight:700;color:var(--gold2);font-family:monospace">' +
    '</div>';

  // Note about editable fields
  var noteHtml = '<div style="grid-column:1/-1;font-size:10px;color:var(--text3);padding:6px 2px;border-top:1px solid var(--border2);margin-top:2px">' +
    '&#9998; Gold fields are pre-filled from type data ‚Äî adjust to match your specific aircraft configuration.' +
    '</div>';

  specGrid.style.gridTemplateColumns = 'repeat(4,1fr)';
  specGrid.innerHTML = readOnlyHtml + editableHtml + noteHtml;
  document.getElementById('ac-specs-' + n).style.display = 'block';
}


function removeAircraftCard(n) {
  const card = document.getElementById('ac-card-' + n);
  if (card) card.remove();
}

function collectFleetData() {
  const fleet = [];
  for (let i = 1; i <= aircraftCount; i++) {
    const card = document.getElementById('ac-card-' + i);
    if (!card) continue;
    const val = document.getElementById('ac-select-' + i) ? document.getElementById('ac-select-' + i).value : '';
    const parts = val.split('|');
    const ac = AIRCRAFT_DB.find(a => a.make === parts[0] && a.model === parts[1]);
    fleet.push({
      make: parts[0] || '',
      model: parts[1] || '',
      category: ac ? ac.category : '',
      tail: document.getElementById('ac-tail-' + i) ? document.getElementById('ac-tail-' + i).value.trim().toUpperCase() : '',
      year: document.getElementById('ac-year-' + i) ? document.getElementById('ac-year-' + i).value : '',
      pax: document.getElementById('ac-pax-' + i) ? document.getElementById('ac-pax-' + i).value : (ac ? ac.pax : ''),
      fbo: document.getElementById('ac-fbo-' + i) ? document.getElementById('ac-fbo-' + i).value.split('--')[0].trim() : '',
      config: document.getElementById('ac-config-' + i) ? document.getElementById('ac-config-' + i).value : 'standard',
      wifi: document.getElementById('ac-wifi-' + i) ? document.getElementById('ac-wifi-' + i).checked : false,
      catering: document.getElementById('ac-catering-' + i) ? document.getElementById('ac-catering-' + i).checked : false,
      pets: document.getElementById('ac-pets-' + i) ? document.getElementById('ac-pets-' + i).checked : false,
      range_nm: ac ? ac.range_nm : '',
      speed_ktas: ac ? ac.speed_ktas : '',
      ceiling_ft: ac ? ac.ceiling_ft : ''
    });
  }
  return fleet;
}


// ‚ïê‚ïê FLEET & CERTS MANAGEMENT ‚ïê‚ïê
function showFleetSubTab(tab) {
  ['aircraft','certs','docs','crew'].forEach(function(t) {
    var btn = document.getElementById('fst-' + t);
    var panel = document.getElementById('fst-content-' + t);
    if (btn) {
      btn.style.borderBottomColor = t === tab ? 'var(--gold2)' : 'transparent';
      btn.style.color = t === tab ? 'var(--gold2)' : 'var(--text3)';
    }
    if (panel) panel.style.display = t === tab ? 'block' : 'none';
  });
}

function openAddAircraftModal() {
  showToast('info', '+', 'Add Aircraft', 'Aircraft management coming in next update.');
}

function uploadCert(certId) {
  var input = document.createElement('input');
  input.type = 'file';
  input.accept = '.pdf,.jpg,.jpeg,.png';
  input.onchange = function() {
    var file = input.files[0];
    if (!file) return;
    var badge = document.getElementById('cert-badge-' + certId);
    if (badge) {
      badge.style.background = 'rgba(79,208,128,0.1)';
      badge.style.borderColor = 'rgba(79,208,128,0.3)';
      badge.style.color = 'var(--green2)';
      badge.textContent = 'On File';
    }
    showToast('success', 'check', 'Certificate uploaded', file.name);
  };
  input.click();
}

function setCertExpiry(certId) {
  var badge = document.getElementById('cert-badge-' + certId);
  if (badge && badge.textContent === 'Not Filed') {
    showToast('error', '!', 'Upload first', 'Please upload the certificate first.');
    return;
  }
  var dateStr = prompt('Enter expiry date (MM/DD/YYYY):');
  if (!dateStr) return;
  if (badge) badge.textContent = 'Exp ' + dateStr;
  showToast('success', 'check', 'Expiry set', 'Certificate expiry updated.');
}

function uploadDoc() {
  var input = document.createElement('input');
  input.type = 'file';
  input.accept = '.pdf,.doc,.docx,.jpg,.png';
  input.onchange = function() {
    var file = input.files[0];
    if (!file) return;
    var list = document.getElementById('docs-list');
    if (list) {
      var empty = list.querySelector('[data-empty]');
      if (empty) empty.remove();
      var row = document.createElement('div');
      row.style.cssText = 'display:flex;align-items:center;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--border)';
      var nameDiv = document.createElement('div');
      nameDiv.innerHTML = '<div style="font-size:13px;font-weight:600;color:var(--text)">' + file.name + '</div><div style="font-size:11px;color:var(--text3)">Uploaded today</div>';
      var removeBtn = document.createElement('button');
      removeBtn.textContent = 'x';
      removeBtn.style.cssText = 'background:none;border:none;color:var(--text3);cursor:pointer;font-size:14px';
      removeBtn.onclick = function() { row.remove(); };
      row.appendChild(nameDiv);
      row.appendChild(removeBtn);
      list.appendChild(row);
    }
    showToast('success', 'check', 'Document uploaded', file.name);
  };
  input.click();
}

function inviteCrew() {
  var email = prompt('Enter crew member email address:');
  if (!email || email.indexOf('@') === -1) return;
  var role = prompt('Role (pilot / dispatcher / scheduler):') || 'dispatcher';
  var list = document.getElementById('crew-list');
  if (list) {
    var empty = list.querySelector('[data-empty]');
    if (empty) empty.remove();
    var roleColors = { pilot:'#58A6FF', dispatcher:'var(--gold2)', scheduler:'var(--green2)' };
    var color = roleColors[role.toLowerCase()] || 'var(--text3)';
    var row = document.createElement('div');
    row.style.cssText = 'display:flex;align-items:center;justify-content:space-between;background:var(--card);border:1px solid var(--border2);border-radius:12px;padding:14px 16px;margin-bottom:8px';
    row.innerHTML = '<div><div style="font-size:13px;font-weight:600;color:var(--text)">' + email + '</div><div style="font-size:11px;font-weight:700;color:' + color + ';text-transform:capitalize;margin-top:2px">' + role + '</div></div>' +
      '<div style="font-size:10px;font-weight:700;color:var(--gold2);background:rgba(229,168,60,0.1);border:1px solid rgba(229,168,60,0.2);padding:4px 10px;border-radius:7px">Invite Sent</div>';
    list.appendChild(row);
  }
  showToast('success', 'check', 'Invite sent', email + ' invited as ' + role + '.');
}




// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TEAM MANAGEMENT (Owner only)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
var TEAM_MEMBERS = []; // loaded from Supabase in real version

function renderTeamTab() {
  var isOwner = ['owner','director_ops','chief_pilot'].indexOf(window._currentRole) > -1;
  var container = document.getElementById('fst-content-crew');
  if (!container) return;

  var addBtnHtml = isOwner
    ? '<button onclick="inviteCrew()" style="height:36px;padding:0 14px;background:var(--gold2);color:var(--bg);border:none;border-radius:9px;font-family:\'DM Sans\',sans-serif;font-size:12px;font-weight:800;cursor:pointer">+ Invite Member</button>'
    : '';

  container.innerHTML =
    '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">' +
      '<div style="font-size:13px;color:var(--text2)">Manage access for your team</div>' +
      addBtnHtml +
    '</div>' +
    '<div id="crew-list">' + renderTeamRows(isOwner) + '</div>';
}

function renderTeamRows(isOwner) {
  if (TEAM_MEMBERS.length === 0) {
    return '<div style="font-size:12px;color:var(--text3);padding:24px 0;text-align:center">No team members added yet</div>';
  }
  return TEAM_MEMBERS.map(function(m) {
    var statusColor = m.status === 'active' ? 'var(--green2)' : m.status === 'suspended' ? '#FF6B6B' : 'var(--text3)';
    var statusLabel = m.status === 'active' ? 'Active' : m.status === 'suspended' ? 'Suspended' : 'Pending';
    var roleColors = { owner:'var(--gold2)', pilot:'#58A6FF', dispatcher:'var(--text2)', director_ops:'#C084FC', chief_pilot:'#58A6FF', scheduler:'var(--text2)' };
    var roleColor = roleColors[m.role] || 'var(--text3)';

    var actions = '';
    if (isOwner && m.role !== 'owner') {
      if (m.status === 'active') {
        actions =
          '<button onclick="suspendMember(\'' + m.id + '\')" style="height:30px;padding:0 10px;border-radius:7px;border:1px solid rgba(255,107,107,0.3);background:transparent;color:#FF6B6B;font-family:\'DM Sans\',sans-serif;font-size:11px;font-weight:700;cursor:pointer;margin-right:6px">Suspend</button>' +
          '<button onclick="revokeMember(\'' + m.id + '\')" style="height:30px;padding:0 10px;border-radius:7px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:\'DM Sans\',sans-serif;font-size:11px;cursor:pointer">Revoke</button>';
      } else if (m.status === 'suspended') {
        actions =
          '<button onclick="reactivateMember(\'' + m.id + '\')" style="height:30px;padding:0 10px;border-radius:7px;border:1px solid rgba(79,208,128,0.3);background:transparent;color:var(--green2);font-family:\'DM Sans\',sans-serif;font-size:11px;font-weight:700;cursor:pointer;margin-right:6px">Reactivate</button>' +
          '<button onclick="revokeMember(\'' + m.id + '\')" style="height:30px;padding:0 10px;border-radius:7px;border:1px solid var(--border2);background:transparent;color:var(--text3);font-family:\'DM Sans\',sans-serif;font-size:11px;cursor:pointer">Revoke</button>';
      }
    }

    return '<div style="display:flex;align-items:center;justify-content:space-between;background:var(--card);border:1px solid var(--border2);border-radius:12px;padding:14px 16px;margin-bottom:8px">' +
      '<div style="display:flex;align-items:center;gap:12px">' +
        '<div style="width:38px;height:38px;background:var(--bg3);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:15px;font-weight:700;color:' + roleColor + ';font-family:monospace">' + (m.name || m.email).charAt(0).toUpperCase() + '</div>' +
        '<div>' +
          '<div style="font-size:13px;font-weight:600;color:var(--text)">' + (m.name || m.email) + '</div>' +
          '<div style="font-size:11px;color:var(--text3);margin-top:1px">' + m.email + '</div>' +
          '<div style="display:flex;gap:6px;margin-top:4px">' +
            '<span style="font-size:10px;font-weight:700;color:' + roleColor + ';text-transform:capitalize">' + m.role + '</span>' +
            '<span style="font-size:10px;color:var(--text3)">¬∑</span>' +
            '<span style="font-size:10px;font-weight:700;color:' + statusColor + '">' + statusLabel + '</span>' +
          '</div>' +
        '</div>' +
      '</div>' +
      '<div style="display:flex;align-items:center;gap:6px">' + actions + '</div>' +
    '</div>';
  }).join('');
}

function suspendMember(id) {
  if (!confirm('Suspend this team member? They will lose dashboard access immediately.')) return;
  var m = TEAM_MEMBERS.find(function(x) { return x.id === id; });
  if (m) {
    m.status = 'suspended';
    logActivity('team', 'Suspended ' + (m.name || m.email) + ' (' + m.role + ')');
    renderTeamTab();
    showToast('success', 'check', 'Access suspended', (m.name || m.email) + ' can no longer sign in.');
  }
}

function reactivateMember(id) {
  var m = TEAM_MEMBERS.find(function(x) { return x.id === id; });
  if (m) {
    m.status = 'active';
    logActivity('team', 'Reactivated ' + (m.name || m.email) + ' (' + m.role + ')');
    renderTeamTab();
    showToast('success', 'check', 'Access restored', (m.name || m.email) + ' can sign in again.');
  }
}

function revokeMember(id) {
  var m = TEAM_MEMBERS.find(function(x) { return x.id === id; });
  if (!m) return;
  if (!confirm('Permanently revoke ' + (m.name || m.email) + '? This cannot be undone.')) return;
  TEAM_MEMBERS = TEAM_MEMBERS.filter(function(x) { return x.id !== id; });
  logActivity('team', 'Revoked access for ' + (m.name || m.email) + ' (' + m.role + ')');
  renderTeamTab();
  showToast('success', 'check', 'Access revoked', (m.name || m.email) + ' removed from your team.');
}

// Override inviteCrew to push to TEAM_MEMBERS
function inviteCrew() {
  var email = prompt('Enter email address:');
  if (!email || email.indexOf('@') === -1) return;
  var roleOptions = 'Assign role:\n1 = Director of Operations\n2 = Chief Pilot\n3 = Pilot\n4 = Dispatcher / Flight Scheduler';
  var roleMap = { '1':'director_ops','2':'chief_pilot','3':'pilot','4':'dispatcher' };
  var roleNum = prompt(roleOptions);
  var role = roleMap[roleNum] || 'dispatcher';
  var newMember = { id: 'tm_' + Date.now(), email: email, name: '', role: role, status: 'pending' };
  TEAM_MEMBERS.push(newMember);
  logActivity('team', 'Invited ' + email + ' as ' + role);
  renderTeamTab();
  showToast('success', 'check', 'Invite sent', email + ' invited as ' + role + '.');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ACTIVITY LOG
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
var ACTIVITY_LOG = [];

function logActivity(category, description) {
  var now = new Date();
  var user = window._currentOperatorName || 'System';
  var role = window._currentRole || 'unknown';
  ACTIVITY_LOG.unshift({
    id: 'log_' + Date.now(),
    ts: now.toISOString(),
    category: category,
    description: description,
    user: user,
    role: role
  });
  // Keep last 200 entries
  if (ACTIVITY_LOG.length > 200) ACTIVITY_LOG = ACTIVITY_LOG.slice(0, 200);
}

function renderActivityLog() {
  var container = document.getElementById('activity-log-list');
  if (!container) return;

  var catColors = { booking:'#58A6FF', fleet:'var(--gold2)', team:'#C084FC', cert:'var(--green2)', quote:'#FF9F43', system:'var(--text3)' };
  var catIcons = { booking:'‚úà', fleet:'üõ©', team:'üë§', cert:'üèÖ', quote:'üí∞', system:'‚öô' };

  if (ACTIVITY_LOG.length === 0) {
    container.innerHTML = '<div style="font-size:12px;color:var(--text3);padding:32px 0;text-align:center">No activity recorded yet</div>';
    return;
  }

  container.innerHTML = ACTIVITY_LOG.map(function(entry) {
    var d = new Date(entry.ts);
    var timeStr = d.toLocaleDateString() + ' ' + d.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
    var color = catColors[entry.category] || 'var(--text3)';
    var icon = catIcons[entry.category] || '¬∑';
    var roleColors = { owner:'var(--gold2)', director_ops:'#C084FC', chief_pilot:'#58A6FF', dispatcher:'var(--text2)', scheduler:'var(--text2)', pilot:'#58A6FF' };
    var rColor = roleColors[entry.role] || 'var(--text3)';
    return '<div style="display:flex;align-items:flex-start;gap:12px;padding:12px 0;border-bottom:1px solid var(--border2)">' +
      '<div style="width:30px;height:30px;border-radius:8px;background:rgba(255,255,255,0.04);border:1px solid var(--border2);display:flex;align-items:center;justify-content:center;font-size:13px;flex-shrink:0">' + icon + '</div>' +
      '<div style="flex:1">' +
        '<div style="font-size:13px;color:var(--text);margin-bottom:3px">' + entry.description + '</div>' +
        '<div style="display:flex;gap:8px;align-items:center">' +
          '<span style="font-size:10px;font-weight:700;color:' + rColor + ';text-transform:capitalize">' + entry.role + '</span>' +
          '<span style="font-size:10px;color:var(--text3)">¬∑</span>' +
          '<span style="font-size:10px;color:var(--text3)">' + timeStr + '</span>' +
        '</div>' +
      '</div>' +
      '<div style="font-size:10px;font-weight:800;padding:3px 8px;border-radius:6px;background:rgba(255,255,255,0.04);border:1px solid var(--border2);color:' + color + ';text-transform:capitalize;flex-shrink:0">' + entry.category + '</div>' +
    '</div>';
  }).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// AIRCRAFT STATUS BOARD
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
var FLEET_STATUS = {}; // keyed by tail number

var AC_STATUSES = [
  { value:'available',   label:'Available',     color:'var(--green2)',  bg:'rgba(79,208,128,0.1)',   dot:'#4FD080' },
  { value:'inflight',    label:'In Flight',     color:'#58A6FF',        bg:'rgba(88,166,255,0.1)',   dot:'#58A6FF' },
  { value:'scheduled',   label:'Scheduled',     color:'var(--gold2)',   bg:'rgba(229,168,60,0.1)',   dot:'var(--gold2)' },
  { value:'maintenance', label:'Maintenance',   color:'#FF6B6B',        bg:'rgba(255,107,107,0.1)',  dot:'#FF6B6B' },
  { value:'aog',         label:'AOG',           color:'#FF3B30',        bg:'rgba(255,59,48,0.12)',   dot:'#FF3B30' },
  { value:'ferry',       label:'Ferry / Repo',  color:'#FF9F43',        bg:'rgba(255,159,67,0.1)',   dot:'#FF9F43' },
  { value:'inspection',  label:'Inspection',    color:'#C084FC',        bg:'rgba(192,132,252,0.1)',  dot:'#C084FC' },
  { value:'unavailable', label:'Unavailable',   color:'var(--text3)',   bg:'rgba(255,255,255,0.04)', dot:'var(--text3)' },
];

function getStatusDef(value) {
  return AC_STATUSES.find(function(s) { return s.value === value; }) || AC_STATUSES[0];
}

function renderFleetStatusBoard() {
  var container = document.getElementById('fleet-status-board');
  if (!container) return;

  var tails = Object.keys(FLEET_STATUS);
  if (tails.length === 0) {
    container.innerHTML = '<div style="font-size:12px;color:var(--text3);padding:24px 0;text-align:center">No aircraft registered yet</div>';
    return;
  }

  container.innerHTML = tails.map(function(tail) {
    var entry = FLEET_STATUS[tail];
    var st = getStatusDef(entry.status);
    var LEADERSHIP = ['owner','director_ops','chief_pilot'];
    var OPS_TEAM  = ['dispatcher','scheduler','pilot'];
    var canEdit = (LEADERSHIP.indexOf(window._currentRole) > -1 || window._currentRole === 'dispatcher' || window._currentRole === 'scheduler');

    var statusDropdown = canEdit
      ? '<select onchange="updateAircraftStatus(\'' + tail + '\', this.value)" style="height:28px;padding:0 8px;background:' + st.bg + ';border:1px solid ' + st.dot + ';border-radius:7px;color:' + st.color + ';font-family:\'DM Sans\',sans-serif;font-size:11px;font-weight:700;cursor:pointer;outline:none">' +
          AC_STATUSES.map(function(s) {
            return '<option value="' + s.value + '"' + (s.value === entry.status ? ' selected' : '') + '>' + s.label + '</option>';
          }).join('') +
        '</select>'
      : '<div style="display:inline-flex;align-items:center;gap:6px;padding:4px 10px;background:' + st.bg + ';border:1px solid ' + st.dot + ';border-radius:7px">' +
          '<div style="width:6px;height:6px;border-radius:50%;background:' + st.dot + '"></div>' +
          '<span style="font-size:11px;font-weight:700;color:' + st.color + '">' + st.label + '</span>' +
        '</div>';

    var notesHtml = canEdit
      ? '<input placeholder="Add note (e.g. est. return date)..." onchange="updateAircraftNote(\'' + tail + '\', this.value)" value="' + (entry.note || '') + '" style="width:100%;background:transparent;border:none;border-top:1px solid var(--border2);padding:8px 0 0 0;font-family:\'DM Sans\',sans-serif;font-size:11px;color:var(--text3);outline:none;margin-top:8px">'
      : (entry.note ? '<div style="font-size:11px;color:var(--text3);padding-top:6px;border-top:1px solid var(--border2);margin-top:6px">' + entry.note + '</div>' : '');

    // Pulse animation for In Flight
    var pulse = entry.status === 'inflight' ? ' class="pulse-dot"' : '';

    return '<div style="background:var(--card);border:1.5px solid ' + (entry.status === 'aog' ? '#FF3B30' : entry.status === 'maintenance' ? 'rgba(255,107,107,0.3)' : 'var(--border2)') + ';border-radius:14px;padding:16px">' +
      '<div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:6px">' +
        '<div>' +
          '<div style="font-family:monospace;font-size:16px;font-weight:700;color:var(--text);letter-spacing:.05em">' + tail + '</div>' +
          '<div style="font-size:11px;color:var(--text3);margin-top:1px">' + (entry.aircraft || 'Unknown Type') + '</div>' +
        '</div>' +
        '<div style="display:flex;align-items:center;gap:6px">' +
          '<div' + pulse + ' style="width:8px;height:8px;border-radius:50%;background:' + st.dot + '"></div>' +
          statusDropdown +
        '</div>' +
      '</div>' +
      notesHtml +
    '</div>';
  }).join('');
}

function updateAircraftStatus(tail, newStatus) {
  if (!FLEET_STATUS[tail]) return;
  var oldStatus = FLEET_STATUS[tail].status;
  FLEET_STATUS[tail].status = newStatus;
  var st = getStatusDef(newStatus);
  logActivity('fleet', tail + ' status changed: ' + oldStatus + ' ‚Üí ' + st.label);
  renderFleetStatusBoard();
  showToast('success', 'check', 'Status updated', tail + ' is now ' + st.label + '.');
}

function updateAircraftNote(tail, note) {
  if (FLEET_STATUS[tail]) {
    FLEET_STATUS[tail].note = note;
    logActivity('fleet', tail + ': note updated');
  }
}

// Called after aircraft registration to seed status board
function seedFleetStatus(tail, aircraftType) {
  if (tail && !FLEET_STATUS[tail]) {
    FLEET_STATUS[tail] = { status: 'available', aircraft: aircraftType || '', note: '' };
    renderFleetStatusBoard();
  }
}




// Demo fleet seed for prototype testing
function seedDemoFleet() {
  FLEET_STATUS = {
    'N481SP': { status: 'available',   aircraft: 'Embraer Phenom 300E',    note: '' },
    'N720JB': { status: 'inflight',    aircraft: 'Cessna Citation CJ4',    note: 'MIA ‚Üí TEB, ETA 14:30' },
    'N38VT':  { status: 'maintenance', aircraft: 'Bombardier Challenger 350', note: 'Scheduled C-check, return 03/05' },
    'N55KR':  { status: 'scheduled',   aircraft: 'Gulfstream G550',         note: 'Dep 09:00 tomorrow' },
    'N109AX': { status: 'aog',         aircraft: 'Dassault Falcon 2000LXS', note: 'Landing gear snag, AOG KMIA' },
    'N330LF': { status: 'available',   aircraft: 'Beechcraft King Air 350', note: '' },
  };
  renderFleetStatusBoard();
  showToast('success', 'check', 'Demo fleet loaded', '6 aircraft added to status board.');
}

// Activity log filter
var _activityFilter = '';
function filterActivity(cat) {
  _activityFilter = cat;
  ['all','booking','fleet','team','quote'].forEach(function(c) {
    var btn = document.getElementById('alog-' + c);
    if (!btn) return;
    var active = (cat === '' && c === 'all') || cat === c;
    btn.style.borderColor = active ? 'var(--gold2)' : 'var(--border2)';
    btn.style.background  = active ? 'rgba(229,168,60,0.1)' : 'transparent';
    btn.style.color       = active ? 'var(--gold2)' : 'var(--text3)';
    btn.style.fontWeight  = active ? '700' : '400';
  });
  renderActivityLog();
}

// Override renderActivityLog to support filtering
var _origRenderActivityLog = renderActivityLog;
renderActivityLog = function() {
  var container = document.getElementById('activity-log-list');
  if (!container) return;
  var list = _activityFilter
    ? ACTIVITY_LOG.filter(function(e) { return e.category === _activityFilter; })
    : ACTIVITY_LOG;
  var catColors = { booking:'#58A6FF', fleet:'var(--gold2)', team:'#C084FC', cert:'var(--green2)', quote:'#FF9F43', system:'var(--text3)' };
  var catIcons  = { booking:'‚úà', fleet:'üõ©', team:'üë§', cert:'üèÖ', quote:'üí∞', system:'‚öô' };
  if (list.length === 0) {
    container.innerHTML = '<div style="font-size:12px;color:var(--text3);padding:32px 0;text-align:center">No activity in this category</div>';
    return;
  }
  container.innerHTML = list.map(function(entry) {
    var d = new Date(entry.ts);
    var timeStr = d.toLocaleDateString() + ' ' + d.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});
    var color = catColors[entry.category] || 'var(--text3)';
    var icon  = catIcons[entry.category]  || '¬∑';
    var roleColors = { owner:'var(--gold2)', director_ops:'#C084FC', chief_pilot:'#58A6FF', dispatcher:'var(--text2)', scheduler:'var(--text2)', pilot:'#58A6FF' };
    var rColor = roleColors[entry.role] || 'var(--text3)';
    return '<div style="display:flex;align-items:flex-start;gap:12px;padding:12px 0;border-bottom:1px solid var(--border2)">' +
      '<div style="width:30px;height:30px;border-radius:8px;background:rgba(255,255,255,0.04);border:1px solid var(--border2);display:flex;align-items:center;justify-content:center;font-size:13px;flex-shrink:0">' + icon + '</div>' +
      '<div style="flex:1"><div style="font-size:13px;color:var(--text);margin-bottom:3px">' + entry.description + '</div>' +
        '<div style="display:flex;gap:8px;align-items:center">' +
          '<span style="font-size:10px;font-weight:700;color:' + rColor + ';text-transform:capitalize">' + entry.role + '</span>' +
          '<span style="font-size:10px;color:var(--text3)">¬∑</span>' +
          '<span style="font-size:10px;color:var(--text3)">' + timeStr + '</span>' +
        '</div></div>' +
      '<div style="font-size:10px;font-weight:800;padding:3px 8px;border-radius:6px;background:rgba(255,255,255,0.04);border:1px solid var(--border2);color:' + color + ';text-transform:capitalize;flex-shrink:0">' + entry.category + '</div>' +
    '</div>';
  }).join('');
};


// ‚ïê‚ïê AIRPORT DATA ‚ïê‚ïê
const AIRPORTS = [
  // ‚îÄ‚îÄ USA: NORTHEAST ‚îÄ‚îÄ
  {code:"JFK",name:"John F. Kennedy International",city:"New York, NY",country:"USA"},
  {code:"LGA",name:"LaGuardia",city:"New York, NY",country:"USA"},
  {code:"EWR",name:"Newark Liberty International",city:"Newark, NJ",country:"USA"},
  {code:"TEB",name:"Teterboro",city:"Teterboro, NJ",country:"USA"},
  {code:"HPN",name:"Westchester County",city:"White Plains, NY",country:"USA"},
  {code:"BOS",name:"Logan International",city:"Boston, MA",country:"USA"},
  {code:"BED",name:"Hanscom Field",city:"Bedford, MA",country:"USA"},
  {code:"PHL",name:"Philadelphia International",city:"Philadelphia, PA",country:"USA"},
  {code:"PNE",name:"Northeast Philadelphia",city:"Philadelphia, PA",country:"USA"},
  {code:"DCA",name:"Reagan National",city:"Washington, DC",country:"USA"},
  {code:"IAD",name:"Dulles International",city:"Washington, DC",country:"USA"},
  {code:"BWI",name:"Baltimore-Washington International",city:"Baltimore, MD",country:"USA"},
  {code:"ACY",name:"Atlantic City International",city:"Atlantic City, NJ",country:"USA"},
  {code:"PIT",name:"Pittsburgh International",city:"Pittsburgh, PA",country:"USA"},
  {code:"RIC",name:"Richmond International",city:"Richmond, VA",country:"USA"},
  {code:"ORF",name:"Norfolk International",city:"Norfolk, VA",country:"USA"},
  {code:"BTV",name:"Burlington International",city:"Burlington, VT",country:"USA"},
  {code:"PWM",name:"Portland International Jetport",city:"Portland, ME",country:"USA"},
  {code:"BDL",name:"Bradley International",city:"Hartford, CT",country:"USA"},
  {code:"PVD",name:"T.F. Green Airport",city:"Providence, RI",country:"USA"},
  {code:"ALB",name:"Albany International",city:"Albany, NY",country:"USA"},
  {code:"SYR",name:"Syracuse Hancock International",city:"Syracuse, NY",country:"USA"},
  {code:"ROC",name:"Greater Rochester International",city:"Rochester, NY",country:"USA"},
  {code:"BUF",name:"Buffalo Niagara International",city:"Buffalo, NY",country:"USA"},
  // ‚îÄ‚îÄ USA: SOUTHEAST ‚îÄ‚îÄ
  {code:"ATL",name:"Hartsfield-Jackson Atlanta",city:"Atlanta, GA",country:"USA"},
  {code:"PDK",name:"DeKalb-Peachtree",city:"Atlanta, GA",country:"USA"},
  {code:"MIA",name:"Miami International",city:"Miami, FL",country:"USA"},
  {code:"OPF",name:"Opa-locka Executive",city:"Miami, FL",country:"USA"},
  {code:"TMB",name:"Miami Executive",city:"Miami, FL",country:"USA"},
  {code:"FLL",name:"Fort Lauderdale-Hollywood",city:"Fort Lauderdale, FL",country:"USA"},
  {code:"FXE",name:"Fort Lauderdale Executive",city:"Fort Lauderdale, FL",country:"USA"},
  {code:"PBI",name:"Palm Beach International",city:"West Palm Beach, FL",country:"USA"},
  {code:"BCT",name:"Boca Raton Airport",city:"Boca Raton, FL",country:"USA"},
  {code:"MCO",name:"Orlando International",city:"Orlando, FL",country:"USA"},
  {code:"ORL",name:"Orlando Executive",city:"Orlando, FL",country:"USA"},
  {code:"TPA",name:"Tampa International",city:"Tampa, FL",country:"USA"},
  {code:"PIE",name:"St. Pete-Clearwater International",city:"Clearwater, FL",country:"USA"},
  {code:"SRQ",name:"Sarasota-Bradenton",city:"Sarasota, FL",country:"USA"},
  {code:"RSW",name:"Southwest Florida International",city:"Fort Myers, FL",country:"USA"},
  {code:"EYW",name:"Key West International",city:"Key West, FL",country:"USA"},
  {code:"JAX",name:"Jacksonville International",city:"Jacksonville, FL",country:"USA"},
  {code:"TLH",name:"Tallahassee International",city:"Tallahassee, FL",country:"USA"},
  {code:"PNS",name:"Pensacola International",city:"Pensacola, FL",country:"USA"},
  {code:"CLT",name:"Charlotte Douglas International",city:"Charlotte, NC",country:"USA"},
  {code:"RDU",name:"Raleigh-Durham International",city:"Raleigh, NC",country:"USA"},
  {code:"CHS",name:"Charleston International",city:"Charleston, SC",country:"USA"},
  {code:"GSP",name:"Greenville-Spartanburg",city:"Greer, SC",country:"USA"},
  {code:"MYR",name:"Myrtle Beach International",city:"Myrtle Beach, SC",country:"USA"},
  {code:"SAV",name:"Savannah-Hilton Head International",city:"Savannah, GA",country:"USA"},
  {code:"BHM",name:"Birmingham-Shuttlesworth International",city:"Birmingham, AL",country:"USA"},
  {code:"MSY",name:"Louis Armstrong New Orleans",city:"New Orleans, LA",country:"USA"},
  {code:"MEM",name:"Memphis International",city:"Memphis, TN",country:"USA"},
  {code:"BNA",name:"Nashville International",city:"Nashville, TN",country:"USA"},
  {code:"TYS",name:"McGhee Tyson Airport",city:"Knoxville, TN",country:"USA"},
  {code:"SDF",name:"Louisville International",city:"Louisville, KY",country:"USA"},
  {code:"LEX",name:"Blue Grass Airport",city:"Lexington, KY",country:"USA"},
  // ‚îÄ‚îÄ USA: MIDWEST ‚îÄ‚îÄ
  {code:"ORD",name:"O'Hare International",city:"Chicago, IL",country:"USA"},
  {code:"MDW",name:"Midway International",city:"Chicago, IL",country:"USA"},
  {code:"PWK",name:"Chicago Executive",city:"Wheeling, IL",country:"USA"},
  {code:"DTW",name:"Detroit Metropolitan",city:"Detroit, MI",country:"USA"},
  {code:"PTK",name:"Oakland County International",city:"Pontiac, MI",country:"USA"},
  {code:"CLE",name:"Cleveland Hopkins International",city:"Cleveland, OH",country:"USA"},
  {code:"CMH",name:"John Glenn Columbus International",city:"Columbus, OH",country:"USA"},
  {code:"CVG",name:"Cincinnati Northern Kentucky",city:"Cincinnati, OH",country:"USA"},
  {code:"IND",name:"Indianapolis International",city:"Indianapolis, IN",country:"USA"},
  {code:"MKE",name:"Milwaukee Mitchell International",city:"Milwaukee, WI",country:"USA"},
  {code:"MSP",name:"Minneapolis Saint Paul",city:"Minneapolis, MN",country:"USA"},
  {code:"STL",name:"St. Louis Lambert International",city:"St. Louis, MO",country:"USA"},
  {code:"MCI",name:"Kansas City International",city:"Kansas City, MO",country:"USA"},
  {code:"OMA",name:"Eppley Airfield",city:"Omaha, NE",country:"USA"},
  {code:"DSM",name:"Des Moines International",city:"Des Moines, IA",country:"USA"},
  {code:"FSD",name:"Sioux Falls Regional",city:"Sioux Falls, SD",country:"USA"},
  {code:"FAR",name:"Hector International",city:"Fargo, ND",country:"USA"},
  // ‚îÄ‚îÄ USA: SOUTHWEST & MOUNTAIN ‚îÄ‚îÄ
  {code:"DFW",name:"Dallas Fort Worth International",city:"Dallas, TX",country:"USA"},
  {code:"DAL",name:"Dallas Love Field",city:"Dallas, TX",country:"USA"},
  {code:"ADS",name:"Addison Airport",city:"Addison, TX",country:"USA"},
  {code:"HOU",name:"William P. Hobby",city:"Houston, TX",country:"USA"},
  {code:"IAH",name:"George Bush Intercontinental",city:"Houston, TX",country:"USA"},
  {code:"SAT",name:"San Antonio International",city:"San Antonio, TX",country:"USA"},
  {code:"AUS",name:"Austin-Bergstrom International",city:"Austin, TX",country:"USA"},
  {code:"ELP",name:"El Paso International",city:"El Paso, TX",country:"USA"},
  {code:"PHX",name:"Phoenix Sky Harbor",city:"Phoenix, AZ",country:"USA"},
  {code:"DVT",name:"Phoenix Deer Valley",city:"Phoenix, AZ",country:"USA"},
  {code:"TUS",name:"Tucson International",city:"Tucson, AZ",country:"USA"},
  {code:"ABQ",name:"Albuquerque International",city:"Albuquerque, NM",country:"USA"},
  {code:"DEN",name:"Denver International",city:"Denver, CO",country:"USA"},
  {code:"APA",name:"Centennial Airport",city:"Denver, CO",country:"USA"},
  {code:"COS",name:"Colorado Springs Airport",city:"Colorado Springs, CO",country:"USA"},
  {code:"ASE",name:"Aspen-Pitkin County",city:"Aspen, CO",country:"USA"},
  {code:"HDN",name:"Yampa Valley Airport",city:"Steamboat Springs, CO",country:"USA"},
  {code:"SLC",name:"Salt Lake City International",city:"Salt Lake City, UT",country:"USA"},
  {code:"LAS",name:"Harry Reid International",city:"Las Vegas, NV",country:"USA"},
  {code:"HND",name:"Henderson Executive",city:"Las Vegas, NV",country:"USA"},
  {code:"RNO",name:"Reno-Tahoe International",city:"Reno, NV",country:"USA"},
  {code:"BOI",name:"Boise Airport",city:"Boise, ID",country:"USA"},
  {code:"BZN",name:"Bozeman Yellowstone International",city:"Bozeman, MT",country:"USA"},
  {code:"JAC",name:"Jackson Hole Airport",city:"Jackson, WY",country:"USA"},
  {code:"SUN",name:"Friedman Memorial",city:"Sun Valley, ID",country:"USA"},
  // ‚îÄ‚îÄ USA: WEST COAST ‚îÄ‚îÄ
  {code:"LAX",name:"Los Angeles International",city:"Los Angeles, CA",country:"USA"},
  {code:"VNY",name:"Van Nuys",city:"Los Angeles, CA",country:"USA"},
  {code:"BUR",name:"Hollywood Burbank",city:"Burbank, CA",country:"USA"},
  {code:"SNA",name:"John Wayne Airport",city:"Orange County, CA",country:"USA"},
  {code:"LGB",name:"Long Beach Airport",city:"Long Beach, CA",country:"USA"},
  {code:"SAN",name:"San Diego International",city:"San Diego, CA",country:"USA"},
  {code:"SFO",name:"San Francisco International",city:"San Francisco, CA",country:"USA"},
  {code:"SQL",name:"San Carlos Airport",city:"San Carlos, CA",country:"USA"},
  {code:"SJC",name:"Mineta San Jose International",city:"San Jose, CA",country:"USA"},
  {code:"OAK",name:"Oakland International",city:"Oakland, CA",country:"USA"},
  {code:"SMF",name:"Sacramento International",city:"Sacramento, CA",country:"USA"},
  {code:"SBA",name:"Santa Barbara Airport",city:"Santa Barbara, CA",country:"USA"},
  {code:"STS",name:"Charles M. Schulz-Sonoma County",city:"Santa Rosa, CA",country:"USA"},
  {code:"SEA",name:"Seattle-Tacoma International",city:"Seattle, WA",country:"USA"},
  {code:"BFI",name:"Boeing Field King County",city:"Seattle, WA",country:"USA"},
  {code:"PDX",name:"Portland International",city:"Portland, OR",country:"USA"},
  {code:"GEG",name:"Spokane International",city:"Spokane, WA",country:"USA"},
  {code:"ANC",name:"Ted Stevens Anchorage International",city:"Anchorage, AK",country:"USA"},
  {code:"HNL",name:"Honolulu Daniel K. Inouye International",city:"Honolulu, HI",country:"USA"},
  {code:"OGG",name:"Kahului Airport",city:"Maui, HI",country:"USA"},
  {code:"KOA",name:"Ellison Onizuka Kona International",city:"Kona, HI",country:"USA"},
  // ‚îÄ‚îÄ CANADA ‚îÄ‚îÄ
  {code:"YYZ",name:"Toronto Pearson International",city:"Toronto, ON",country:"Canada"},
  {code:"YTZ",name:"Billy Bishop Toronto City",city:"Toronto, ON",country:"Canada"},
  {code:"YUL",name:"Montreal Pierre Elliott Trudeau",city:"Montreal, QC",country:"Canada"},
  {code:"YVR",name:"Vancouver International",city:"Vancouver, BC",country:"Canada"},
  {code:"YYC",name:"Calgary International",city:"Calgary, AB",country:"Canada"},
  {code:"YEG",name:"Edmonton International",city:"Edmonton, AB",country:"Canada"},
  {code:"YOW",name:"Ottawa Macdonald-Cartier",city:"Ottawa, ON",country:"Canada"},
  {code:"YHZ",name:"Halifax Stanfield International",city:"Halifax, NS",country:"Canada"},
  {code:"YWG",name:"Winnipeg James Armstrong Richardson",city:"Winnipeg, MB",country:"Canada"},
  // ‚îÄ‚îÄ CARIBBEAN & BAHAMAS ‚îÄ‚îÄ
  {code:"NAS",name:"Lynden Pindling International",city:"Nassau, Bahamas",country:"Bahamas"},
  {code:"GGT",name:"Exuma International",city:"George Town, Bahamas",country:"Bahamas"},
  {code:"ELH",name:"North Eleuthera Airport",city:"Eleuthera, Bahamas",country:"Bahamas"},
  {code:"MHH",name:"Marsh Harbour Airport",city:"Abaco, Bahamas",country:"Bahamas"},
  {code:"SXM",name:"Princess Juliana International",city:"St. Maarten",country:"Sint Maarten"},
  {code:"AXA",name:"Clayton J. Lloyd International",city:"Anguilla",country:"Anguilla"},
  {code:"STT",name:"Cyril E. King Airport",city:"St. Thomas, USVI",country:"USA"},
  {code:"SJU",name:"Luis Munoz Marin International",city:"San Juan, PR",country:"USA"},
  {code:"BQN",name:"Rafael Hernandez Airport",city:"Aguadilla, PR",country:"USA"},
  {code:"PLS",name:"Providenciales International",city:"Turks and Caicos",country:"Turks & Caicos"},
  {code:"GCM",name:"Owen Roberts International",city:"Grand Cayman",country:"Cayman Islands"},
  {code:"MBJ",name:"Sangster International",city:"Montego Bay, Jamaica",country:"Jamaica"},
  {code:"KIN",name:"Norman Manley International",city:"Kingston, Jamaica",country:"Jamaica"},
  {code:"ANU",name:"V.C. Bird International",city:"Antigua",country:"Antigua"},
  {code:"BGI",name:"Grantley Adams International",city:"Bridgetown, Barbados",country:"Barbados"},
  {code:"TAB",name:"A.N.R. Robinson International",city:"Tobago",country:"Trinidad & Tobago"},
  {code:"POS",name:"Piarco International",city:"Port of Spain, Trinidad",country:"Trinidad & Tobago"},
  {code:"CUR",name:"Hato International",city:"Curacao",country:"Curacao"},
  {code:"AUA",name:"Queen Beatrix International",city:"Aruba",country:"Aruba"},
  {code:"PTP",name:"Pointe-a-Pitre International",city:"Guadeloupe",country:"Guadeloupe"},
  {code:"FDF",name:"Martinique Aime Cesaire",city:"Fort-de-France, Martinique",country:"Martinique"},
  {code:"HAV",name:"Jose Marti International",city:"Havana, Cuba",country:"Cuba"},
  {code:"VRA",name:"Juan Gualberto Gomez Airport",city:"Varadero, Cuba",country:"Cuba"},
  // ‚îÄ‚îÄ MEXICO & CENTRAL AMERICA ‚îÄ‚îÄ
  {code:"MEX",name:"Benito Juarez International",city:"Mexico City",country:"Mexico"},
  {code:"CUN",name:"Cancun International",city:"Cancun",country:"Mexico"},
  {code:"GDL",name:"Don Miguel Hidalgo y Costilla",city:"Guadalajara",country:"Mexico"},
  {code:"MTY",name:"General Mariano Escobedo",city:"Monterrey",country:"Mexico"},
  {code:"SJD",name:"Los Cabos International",city:"Los Cabos",country:"Mexico"},
  {code:"PVR",name:"Licenciado Gustavo Diaz Ordaz",city:"Puerto Vallarta",country:"Mexico"},
  {code:"ZIH",name:"Ixtapa-Zihuatanejo International",city:"Zihuatanejo",country:"Mexico"},
  {code:"MZT",name:"General Rafael Buelna International",city:"Mazatlan",country:"Mexico"},
  {code:"BOG",name:"El Dorado International",city:"Bogota",country:"Colombia"},
  {code:"MDE",name:"Jose Maria Cordova International",city:"Medellin",country:"Colombia"},
  {code:"CTG",name:"Rafael Nunez International",city:"Cartagena",country:"Colombia"},
  {code:"GUA",name:"La Aurora International",city:"Guatemala City",country:"Guatemala"},
  {code:"SAP",name:"Ramon Villeda Morales",city:"San Pedro Sula, Honduras",country:"Honduras"},
  {code:"PTY",name:"Tocumen International",city:"Panama City",country:"Panama"},
  {code:"SJO",name:"Juan Santamaria International",city:"San Jose, Costa Rica",country:"Costa Rica"},
  // ‚îÄ‚îÄ SOUTH AMERICA ‚îÄ‚îÄ
  {code:"GRU",name:"Sao Paulo Guarulhos International",city:"Sao Paulo",country:"Brazil"},
  {code:"CGH",name:"Congonhas Airport",city:"Sao Paulo",country:"Brazil"},
  {code:"GIG",name:"Rio de Janeiro Galeao International",city:"Rio de Janeiro",country:"Brazil"},
  {code:"SDU",name:"Santos Dumont Airport",city:"Rio de Janeiro",country:"Brazil"},
  {code:"EZE",name:"Ministro Pistarini International",city:"Buenos Aires",country:"Argentina"},
  {code:"AEP",name:"Jorge Newbery Airfield",city:"Buenos Aires",country:"Argentina"},
  {code:"SCL",name:"Arturo Merino Benitez International",city:"Santiago",country:"Chile"},
  {code:"LIM",name:"Jorge Chavez International",city:"Lima",country:"Peru"},
  {code:"UIO",name:"Mariscal Sucre International",city:"Quito",country:"Ecuador"},
  {code:"GYE",name:"Jose Joaquin de Olmedo",city:"Guayaquil",country:"Ecuador"},
  {code:"CCS",name:"Simon Bolivar International",city:"Caracas",country:"Venezuela"},
  // ‚îÄ‚îÄ UK & IRELAND ‚îÄ‚îÄ
  {code:"LHR",name:"Heathrow",city:"London",country:"UK"},
  {code:"LGW",name:"Gatwick",city:"London",country:"UK"},
  {code:"LCY",name:"London City",city:"London",country:"UK"},
  {code:"STN",name:"Stansted",city:"London",country:"UK"},
  {code:"LTN",name:"Luton",city:"London",country:"UK"},
  {code:"FAB",name:"Farnborough Airport",city:"Farnborough",country:"UK"},
  {code:"MAN",name:"Manchester Airport",city:"Manchester",country:"UK"},
  {code:"EDI",name:"Edinburgh Airport",city:"Edinburgh",country:"UK"},
  {code:"GLA",name:"Glasgow International",city:"Glasgow",country:"UK"},
  {code:"BHX",name:"Birmingham Airport",city:"Birmingham",country:"UK"},
  {code:"DUB",name:"Dublin Airport",city:"Dublin",country:"Ireland"},
  {code:"SNN",name:"Shannon Airport",city:"Shannon",country:"Ireland"},
  // ‚îÄ‚îÄ WESTERN EUROPE ‚îÄ‚îÄ
  {code:"CDG",name:"Charles de Gaulle",city:"Paris",country:"France"},
  {code:"ORY",name:"Paris Orly",city:"Paris",country:"France"},
  {code:"LBG",name:"Paris Le Bourget",city:"Paris",country:"France"},
  {code:"NCE",name:"Nice Cote d'Azur",city:"Nice",country:"France"},
  {code:"MRS",name:"Marseille Provence",city:"Marseille",country:"France"},
  {code:"LYS",name:"Lyon Saint-Exupery",city:"Lyon",country:"France"},
  {code:"AMS",name:"Amsterdam Schiphol",city:"Amsterdam",country:"Netherlands"},
  {code:"BRU",name:"Brussels Airport",city:"Brussels",country:"Belgium"},
  {code:"FRA",name:"Frankfurt Airport",city:"Frankfurt",country:"Germany"},
  {code:"MUC",name:"Munich Airport",city:"Munich",country:"Germany"},
  {code:"TXL",name:"Berlin Brandenburg",city:"Berlin",country:"Germany"},
  {code:"HAM",name:"Hamburg Airport",city:"Hamburg",country:"Germany"},
  {code:"DUS",name:"Dusseldorf Airport",city:"Dusseldorf",country:"Germany"},
  {code:"ZRH",name:"Zurich Airport",city:"Zurich",country:"Switzerland"},
  {code:"GVA",name:"Geneva Airport",city:"Geneva",country:"Switzerland"},
  {code:"VIE",name:"Vienna International",city:"Vienna",country:"Austria"},
  {code:"SZG",name:"Salzburg Airport",city:"Salzburg",country:"Austria"},
  {code:"MAD",name:"Adolfo Suarez Madrid-Barajas",city:"Madrid",country:"Spain"},
  {code:"BCN",name:"Barcelona El Prat",city:"Barcelona",country:"Spain"},
  {code:"AGP",name:"Malaga Airport",city:"Malaga",country:"Spain"},
  {code:"PMI",name:"Palma de Mallorca Airport",city:"Mallorca",country:"Spain"},
  {code:"IBZ",name:"Ibiza Airport",city:"Ibiza",country:"Spain"},
  {code:"LIS",name:"Lisbon Humberto Delgado",city:"Lisbon",country:"Portugal"},
  {code:"OPO",name:"Porto Airport",city:"Porto",country:"Portugal"},
  {code:"FCO",name:"Rome Fiumicino",city:"Rome",country:"Italy"},
  {code:"CIA",name:"Rome Ciampino",city:"Rome",country:"Italy"},
  {code:"MXP",name:"Milan Malpensa",city:"Milan",country:"Italy"},
  {code:"LIN",name:"Milan Linate",city:"Milan",country:"Italy"},
  {code:"VCE",name:"Venice Marco Polo",city:"Venice",country:"Italy"},
  {code:"FLR",name:"Florence Amerigo Vespucci",city:"Florence",country:"Italy"},
  {code:"NAP",name:"Naples International",city:"Naples",country:"Italy"},
  {code:"CPH",name:"Copenhagen Airport",city:"Copenhagen",country:"Denmark"},
  {code:"OSL",name:"Oslo Gardermoen",city:"Oslo",country:"Norway"},
  {code:"ARN",name:"Stockholm Arlanda",city:"Stockholm",country:"Sweden"},
  {code:"HEL",name:"Helsinki Vantaa",city:"Helsinki",country:"Finland"},
  // ‚îÄ‚îÄ EASTERN EUROPE ‚îÄ‚îÄ
  {code:"WAW",name:"Warsaw Chopin Airport",city:"Warsaw",country:"Poland"},
  {code:"PRG",name:"Vaclav Havel Prague",city:"Prague",country:"Czech Republic"},
  {code:"BUD",name:"Budapest Ferenc Liszt",city:"Budapest",country:"Hungary"},
  {code:"OTP",name:"Bucharest Henri Coanda",city:"Bucharest",country:"Romania"},
  {code:"SOF",name:"Sofia Airport",city:"Sofia",country:"Bulgaria"},
  {code:"ATH",name:"Athens Eleftherios Venizelos",city:"Athens",country:"Greece"},
  {code:"SKG",name:"Thessaloniki Macedonia Airport",city:"Thessaloniki",country:"Greece"},
  {code:"HER",name:"Heraklion Nikos Kazantzakis",city:"Crete",country:"Greece"},
  {code:"CFU",name:"Corfu International Airport",city:"Corfu",country:"Greece"},
  {code:"JMK",name:"Mykonos Airport",city:"Mykonos",country:"Greece"},
  {code:"JSI",name:"Skiathos Airport",city:"Skiathos",country:"Greece"},
  {code:"ZTH",name:"Zakynthos International",city:"Zakynthos",country:"Greece"},
  {code:"IST",name:"Istanbul Airport",city:"Istanbul",country:"Turkey"},
  {code:"SAW",name:"Istanbul Sabiha Gokcen",city:"Istanbul",country:"Turkey"},
  {code:"AYT",name:"Antalya Airport",city:"Antalya",country:"Turkey"},
  // ‚îÄ‚îÄ MIDDLE EAST ‚îÄ‚îÄ
  {code:"DXB",name:"Dubai International",city:"Dubai",country:"UAE"},
  {code:"DWC",name:"Al Maktoum International",city:"Dubai",country:"UAE"},
  {code:"AUH",name:"Abu Dhabi International",city:"Abu Dhabi",country:"UAE"},
  {code:"SHJ",name:"Sharjah International",city:"Sharjah",country:"UAE"},
  {code:"DOH",name:"Hamad International",city:"Doha",country:"Qatar"},
  {code:"BAH",name:"Bahrain International",city:"Manama",country:"Bahrain"},
  {code:"KWI",name:"Kuwait International",city:"Kuwait City",country:"Kuwait"},
  {code:"MCT",name:"Muscat International",city:"Muscat",country:"Oman"},
  {code:"RUH",name:"King Khalid International",city:"Riyadh",country:"Saudi Arabia"},
  {code:"JED",name:"King Abdulaziz International",city:"Jeddah",country:"Saudi Arabia"},
  {code:"TLV",name:"Ben Gurion International",city:"Tel Aviv",country:"Israel"},
  {code:"AMM",name:"Queen Alia International",city:"Amman",country:"Jordan"},
  {code:"BEY",name:"Beirut Rafic Hariri International",city:"Beirut",country:"Lebanon"},
  // ‚îÄ‚îÄ AFRICA ‚îÄ‚îÄ
  {code:"CAI",name:"Cairo International",city:"Cairo",country:"Egypt"},
  {code:"HRG",name:"Hurghada International",city:"Hurghada",country:"Egypt"},
  {code:"SSH",name:"Sharm el-Sheikh International",city:"Sharm el-Sheikh",country:"Egypt"},
  {code:"CMN",name:"Mohammed V International",city:"Casablanca",country:"Morocco"},
  {code:"RAK",name:"Marrakesh Menara",city:"Marrakesh",country:"Morocco"},
  {code:"TNG",name:"Ibn Batouta Airport",city:"Tangier",country:"Morocco"},
  {code:"TUN",name:"Tunis-Carthage International",city:"Tunis",country:"Tunisia"},
  {code:"JNB",name:"O.R. Tambo International",city:"Johannesburg",country:"South Africa"},
  {code:"CPT",name:"Cape Town International",city:"Cape Town",country:"South Africa"},
  {code:"DUR",name:"King Shaka International",city:"Durban",country:"South Africa"},
  {code:"NBO",name:"Jomo Kenyatta International",city:"Nairobi",country:"Kenya"},
  {code:"WIL",name:"Wilson Airport",city:"Nairobi",country:"Kenya"},
  {code:"ADD",name:"Bole International",city:"Addis Ababa",country:"Ethiopia"},
  {code:"LOS",name:"Murtala Muhammed International",city:"Lagos",country:"Nigeria"},
  {code:"ABV",name:"Nnamdi Azikiwe International",city:"Abuja",country:"Nigeria"},
  {code:"ACC",name:"Kotoka International",city:"Accra",country:"Ghana"},
  {code:"DAK",name:"Blaise Diagne International",city:"Dakar",country:"Senegal"},
  {code:"TNR",name:"Ivato International",city:"Antananarivo",country:"Madagascar"},
  {code:"MRU",name:"Sir Seewoosagur Ramgoolam",city:"Mauritius",country:"Mauritius"},
  {code:"SEZ",name:"Seychelles International",city:"Mahe",country:"Seychelles"},
  // ‚îÄ‚îÄ ASIA PACIFIC ‚îÄ‚îÄ
  {code:"HKG",name:"Hong Kong International",city:"Hong Kong",country:"Hong Kong"},
  {code:"SIN",name:"Singapore Changi",city:"Singapore",country:"Singapore"},
  {code:"BKK",name:"Suvarnabhumi Airport",city:"Bangkok",country:"Thailand"},
  {code:"DMK",name:"Don Mueang International",city:"Bangkok",country:"Thailand"},
  {code:"HKT",name:"Phuket International",city:"Phuket",country:"Thailand"},
  {code:"CNX",name:"Chiang Mai International",city:"Chiang Mai",country:"Thailand"},
  {code:"KUL",name:"Kuala Lumpur International",city:"Kuala Lumpur",country:"Malaysia"},
  {code:"CGK",name:"Soekarno-Hatta International",city:"Jakarta",country:"Indonesia"},
  {code:"DPS",name:"Ngurah Rai International",city:"Bali",country:"Indonesia"},
  {code:"MNL",name:"Ninoy Aquino International",city:"Manila",country:"Philippines"},
  {code:"CEB",name:"Mactan-Cebu International",city:"Cebu",country:"Philippines"},
  {code:"SGN",name:"Tan Son Nhat International",city:"Ho Chi Minh City",country:"Vietnam"},
  {code:"HAN",name:"Noi Bai International",city:"Hanoi",country:"Vietnam"},
  {code:"DAD",name:"Da Nang International",city:"Da Nang",country:"Vietnam"},
  {code:"REP",name:"Siem Reap International",city:"Siem Reap",country:"Cambodia"},
  {code:"PNH",name:"Phnom Penh International",city:"Phnom Penh",country:"Cambodia"},
  {code:"RGN",name:"Yangon International",city:"Yangon",country:"Myanmar"},
  {code:"PEK",name:"Beijing Capital International",city:"Beijing",country:"China"},
  {code:"PKX",name:"Beijing Daxing International",city:"Beijing",country:"China"},
  {code:"PVG",name:"Shanghai Pudong International",city:"Shanghai",country:"China"},
  {code:"SHA",name:"Shanghai Hongqiao",city:"Shanghai",country:"China"},
  {code:"CAN",name:"Guangzhou Baiyun International",city:"Guangzhou",country:"China"},
  {code:"SZX",name:"Shenzhen Bao'an International",city:"Shenzhen",country:"China"},
  {code:"CTU",name:"Chengdu Tianfu International",city:"Chengdu",country:"China"},
  {code:"NRT",name:"Tokyo Narita International",city:"Tokyo",country:"Japan"},
  {code:"HND",name:"Tokyo Haneda",city:"Tokyo",country:"Japan"},
  {code:"KIX",name:"Osaka Kansai International",city:"Osaka",country:"Japan"},
  {code:"ITM",name:"Osaka Itami",city:"Osaka",country:"Japan"},
  {code:"NGO",name:"Chubu Centrair International",city:"Nagoya",country:"Japan"},
  {code:"CTS",name:"New Chitose Airport",city:"Sapporo",country:"Japan"},
  {code:"OKA",name:"Naha Airport",city:"Okinawa",country:"Japan"},
  {code:"ICN",name:"Incheon International",city:"Seoul",country:"South Korea"},
  {code:"GMP",name:"Gimpo International",city:"Seoul",country:"South Korea"},
  {code:"PUS",name:"Gimhae International",city:"Busan",country:"South Korea"},
  {code:"TPE",name:"Taoyuan International",city:"Taipei",country:"Taiwan"},
  {code:"TSA",name:"Taipei Songshan",city:"Taipei",country:"Taiwan"},
  {code:"MFM",name:"Macau International",city:"Macau",country:"Macau"},
  {code:"DEL",name:"Indira Gandhi International",city:"New Delhi",country:"India"},
  {code:"BOM",name:"Chhatrapati Shivaji Maharaj",city:"Mumbai",country:"India"},
  {code:"BLR",name:"Kempegowda International",city:"Bangalore",country:"India"},
  {code:"MAA",name:"Chennai International",city:"Chennai",country:"India"},
  {code:"CCU",name:"Netaji Subhas Chandra Bose",city:"Kolkata",country:"India"},
  {code:"HYD",name:"Rajiv Gandhi International",city:"Hyderabad",country:"India"},
  {code:"COK",name:"Cochin International",city:"Kochi",country:"India"},
  {code:"GOI",name:"Dabolim Airport",city:"Goa",country:"India"},
  {code:"AMD",name:"Sardar Vallabhbhai Patel",city:"Ahmedabad",country:"India"},
  {code:"KTM",name:"Tribhuvan International",city:"Kathmandu",country:"Nepal"},
  {code:"CMB",name:"Bandaranaike International",city:"Colombo",country:"Sri Lanka"},
  {code:"DAC",name:"Hazrat Shahjalal International",city:"Dhaka",country:"Bangladesh"},
  {code:"KHI",name:"Jinnah International",city:"Karachi",country:"Pakistan"},
  {code:"LHE",name:"Allama Iqbal International",city:"Lahore",country:"Pakistan"},
  {code:"ISB",name:"Islamabad International",city:"Islamabad",country:"Pakistan"},
  // ‚îÄ‚îÄ AUSTRALIA & NEW ZEALAND ‚îÄ‚îÄ
  {code:"SYD",name:"Sydney Kingsford Smith",city:"Sydney",country:"Australia"},
  {code:"MEL",name:"Melbourne Airport",city:"Melbourne",country:"Australia"},
  {code:"BNE",name:"Brisbane Airport",city:"Brisbane",country:"Australia"},
  {code:"PER",name:"Perth Airport",city:"Perth",country:"Australia"},
  {code:"ADL",name:"Adelaide Airport",city:"Adelaide",country:"Australia"},
  {code:"DRW",name:"Darwin International",city:"Darwin",country:"Australia"},
  {code:"CNS",name:"Cairns Airport",city:"Cairns",country:"Australia"},
  {code:"OOL",name:"Gold Coast Airport",city:"Gold Coast",country:"Australia"},
  {code:"AKL",name:"Auckland Airport",city:"Auckland",country:"New Zealand"},
  {code:"CHC",name:"Christchurch International",city:"Christchurch",country:"New Zealand"},
  {code:"WLG",name:"Wellington International",city:"Wellington",country:"New Zealand"},
  {code:"ZQN",name:"Queenstown Airport",city:"Queenstown",country:"New Zealand"},
  {code:"NAN",name:"Nadi International",city:"Nadi",country:"Fiji"},
  {code:"PPT",name:"Tahiti Faaa International",city:"Papeete",country:"French Polynesia"},
  {code:"APW",name:"Faleolo International",city:"Apia",country:"Samoa"},
];

function airportSearch(input, dropId) {
  const q = input.value.toLowerCase().trim();
  const drop = document.getElementById(dropId);
  if (!q || q.length < 1) { drop.style.display = 'none'; return; }
  const matches = AIRPORTS.filter(a =>
    a.code.toLowerCase().startsWith(q) ||
    a.name.toLowerCase().includes(q) ||
    a.city.toLowerCase().includes(q)
  ).slice(0, 8);
  if (!matches.length) { drop.style.display = 'none'; return; }
  drop.innerHTML = matches.map(a =>
    `<div class="airport-option" onmousedown="selectAirport('${input.id}','${dropId}','${a.code}','${a.name.replace(/'/g,'')}','${a.city.replace(/'/g,'')}')">
      <div><span class="airport-code">${a.code}</span><span class="airport-name">${a.name}</span></div>
      <div class="airport-city">${a.city}</div>
    </div>`).join('');
  drop.style.display = 'block';
}

function selectAirport(inputId, dropId, code, name, city) {
  document.getElementById(inputId).value = code + ' ‚Äî ' + name;
  hideDropdown(dropId);
}

function hideDropdown(id) {
  const el = document.getElementById(id);
  if (el) el.style.display = 'none';
}

function swapAirports() {
  const from = document.getElementById('req-from');
  const to = document.getElementById('req-to');
  const tmp = from.value;
  from.value = to.value;
  to.value = tmp;
}

// ‚ïê‚ïê MINORS TOGGLE ‚ïê‚ïê
let minorsOn = false;
function toggleMinors() {
  minorsOn = !minorsOn;
  document.getElementById('minor-track').style.background = minorsOn ? 'var(--gold2)' : 'var(--border2)';
  document.getElementById('minor-thumb').style.left = minorsOn ? '21px' : '3px';
  document.getElementById('minor-toggle-label').textContent = minorsOn ? 'Yes' : 'No';
  document.getElementById('minors-fields').style.display = minorsOn ? 'block' : 'none';
}

function checkUnaccompanied() {
  const val = document.getElementById('req-minors-accompanied').value;
  document.getElementById('unaccompanied-notice').style.display = val === 'no' ? 'block' : 'none';
}

// ‚ïê‚ïê PREFERENCES ‚ïê‚ïê
const activePrefs = new Set();
const prefDetails = {
  catering: 'catering-detail',
  transport: 'transport-detail',
  pet: 'pet-detail',
  luggage: 'luggage-detail'
};

function togglePref(key) {
  const chip = document.getElementById('pref-' + key);
  if (activePrefs.has(key)) {
    activePrefs.delete(key);
    chip.classList.remove('selected');
    if (prefDetails[key]) document.getElementById(prefDetails[key]).style.display = 'none';
  } else {
    activePrefs.add(key);
    chip.classList.add('selected');
    if (prefDetails[key]) document.getElementById(prefDetails[key]).style.display = 'block';
  }
}


// ‚ïê‚ïê TRIP TYPE ‚ïê‚ïê
let currentTripType = 'oneway';
function setTripType(type) {
  currentTripType = type;
  ['oneway','return','multistop'].forEach(t => {
    const btn = document.getElementById('tt-' + t);
    if (t === type) {
      btn.style.borderColor = 'var(--gold2)';
      btn.style.background = 'rgba(229,168,60,0.1)';
      btn.style.color = 'var(--gold2)';
    } else {
      btn.style.borderColor = 'var(--border)';
      btn.style.background = 'transparent';
      btn.style.color = 'var(--text3)';
    }
  });
  document.getElementById('return-date-row').style.display = type === 'return' ? 'block' : 'none';
  document.getElementById('multistop-row').style.display = type === 'multistop' ? 'block' : 'none';
}

function addLeg() {
  const container = document.getElementById('extra-legs');
  const count = container.querySelectorAll('.extra-leg').length + 2;
  const div = document.createElement('div');
  div.className = 'extra-leg';
  div.style.cssText = 'display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:10px';
  div.innerHTML = `<div><div class="field-label">Stop ${count} ‚Äî From</div><input class="field-input" placeholder="Airport code..." style="font-size:13px"></div>
    <div><div class="field-label">Stop ${count} ‚Äî To</div><input class="field-input" placeholder="Airport code..." style="font-size:13px"></div>
    <div><div class="field-label">Date</div><input class="field-input" type="date" style="font-size:13px"></div>`;
  container.appendChild(div);
}


// ‚ïê‚ïê PASSENGER MANIFEST ‚ïê‚ïê
let manifestBookingId = null;
let manifestPaxCount = 1;
let manifestIsIntl = false;
let currentPaxTab = 0;

function openManifest(bookingId, paxCount, isInternational) {
  manifestBookingId = bookingId;
  manifestPaxCount = paxCount || 1;
  manifestIsIntl = isInternational || false;

  if (manifestIsIntl) {
    document.getElementById('intl-notice').style.display = 'block';
  }

  buildManifestForms();
  document.getElementById('manifest-modal').classList.add('show');
}

function buildManifestForms() {
  const tabsEl = document.getElementById('manifest-pax-tabs');
  const formsEl = document.getElementById('manifest-pax-forms');
  tabsEl.innerHTML = '';
  formsEl.innerHTML = '';

  for (let i = 0; i < manifestPaxCount; i++) {
    // Tab
    const tab = document.createElement('button');
    tab.id = `ptab-${i}`;
    tab.textContent = i === 0 ? 'üë§ Passenger 1 (Lead)' : `üë§ Passenger ${i + 1}`;
    tab.style.cssText = `height:36px;padding:0 14px;border-radius:9px;font-family:'DM Sans',sans-serif;font-size:12px;font-weight:700;cursor:pointer;transition:all .2s;border:1.5px solid ${i === 0 ? 'var(--gold2)' : 'var(--border)'};background:${i === 0 ? 'rgba(229,168,60,0.1)' : 'transparent'};color:${i === 0 ? 'var(--gold2)' : 'var(--text3)'}`;
    tab.onclick = () => switchPaxTab(i);
    tabsEl.appendChild(tab);

    // Form
    const form = document.createElement('div');
    form.id = `pform-${i}`;
    form.style.display = i === 0 ? 'block' : 'none';
    form.innerHTML = buildPaxForm(i);
    formsEl.appendChild(form);
  }
  currentPaxTab = 0;
}

function buildPaxForm(idx) {
  const isLead = idx === 0;
  return `
    <div style="background:var(--bg3);border:1px solid var(--border2);border-radius:14px;padding:18px;margin-bottom:4px">
      ${isLead ? '<div style="font-size:10px;font-weight:800;letter-spacing:.14em;text-transform:uppercase;color:var(--gold2);margin-bottom:14px">Lead Passenger ¬∑ Booking Contact</div>' : `<div style="font-size:10px;font-weight:800;letter-spacing:.14em;text-transform:uppercase;color:var(--text3);margin-bottom:14px">Passenger ${idx + 1}</div>`}

      <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;margin-bottom:12px">
        <div>
          <div class="field-label">First Name <span class="field-required">Required</span></div>
          <input class="field-input" id="pax-${idx}-first" placeholder="Legal first name" style="font-size:14px">
        </div>
        <div>
          <div class="field-label">Middle Name</div>
          <input class="field-input" id="pax-${idx}-middle" placeholder="If on ID" style="font-size:14px">
        </div>
        <div>
          <div class="field-label">Last Name <span class="field-required">Required</span></div>
          <input class="field-input" id="pax-${idx}-last" placeholder="Legal last name" style="font-size:14px">
        </div>
      </div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px">
        <div>
          <div class="field-label">Date of Birth <span class="field-required">Required</span></div>
          <input class="field-input" type="date" id="pax-${idx}-dob">
        </div>
        <div>
          <div class="field-label">Gender</div>
          <select class="field-select" id="pax-${idx}-gender">
            <option value="">Prefer not to say</option>
            <option value="M">Male</option>
            <option value="F">Female</option>
            <option value="X">Non-binary / Other</option>
          </select>
        </div>
      </div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px">
        <div>
          <div class="field-label">Government ID Type <span class="field-required">Required</span></div>
          <select class="field-select" id="pax-${idx}-id-type" onchange="checkIdType(${idx})">
            <option value="dl">Driver's License</option>
            <option value="passport">Passport</option>
            <option value="state_id">State ID</option>
            <option value="military">Military ID</option>
          </select>
        </div>
        <div>
          <div class="field-label">ID Number <span class="field-required">Required</span></div>
          <input class="field-input" id="pax-${idx}-id-num" placeholder="ID number" style="font-family:'DM Mono',monospace;font-size:14px">
        </div>
      </div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px">
        <div>
          <div class="field-label">ID Issuing State / Country</div>
          <input class="field-input" id="pax-${idx}-id-state" placeholder="e.g. Florida, USA">
        </div>
        <div>
          <div class="field-label">ID Expiry Date</div>
          <input class="field-input" type="date" id="pax-${idx}-id-expiry">
        </div>
      </div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px">
        <div>
          <div class="field-label">TSA PreCheck / KTN</div>
          <input class="field-input" id="pax-${idx}-tsa" placeholder="Known Traveler Number" style="font-family:'DM Mono',monospace;font-size:14px">
          <div style="font-size:10px;color:var(--text3);margin-top:4px">Optional ‚Äî speeds up security screening</div>
        </div>
        <div>
          <div class="field-label">Nationality</div>
          <input class="field-input" id="pax-${idx}-nationality" placeholder="e.g. American, British">
        </div>
      </div>

      ${manifestIsIntl ? `
      <div style="background:rgba(88,166,255,0.05);border:1px solid rgba(88,166,255,0.2);border-radius:12px;padding:14px;margin-top:4px">
        <div style="font-size:11px;font-weight:700;color:#58A6FF;margin-bottom:12px">üåç Passport Details (International Flight)</div>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px">
          <div>
            <div class="field-label">Passport Number <span class="field-required">Required</span></div>
            <input class="field-input" id="pax-${idx}-passport" placeholder="Passport #" style="font-family:'DM Mono',monospace;font-size:14px">
          </div>
          <div>
            <div class="field-label">Passport Country</div>
            <input class="field-input" id="pax-${idx}-passport-country" placeholder="Issuing country">
          </div>
          <div>
            <div class="field-label">Passport Expiry <span class="field-required">Required</span></div>
            <input class="field-input" type="date" id="pax-${idx}-passport-expiry">
          </div>
        </div>
      </div>` : ''}

      ${isLead ? `
      <div style="margin-top:12px">
        <div class="field-label">Mobile Phone (for flight updates)</div>
        <input class="field-input" type="tel" id="pax-${idx}-phone" placeholder="+1 (305) 000-0000">
      </div>` : ''}

      <div style="margin-top:12px">
        <div class="field-label">Special Requirements / Medical Notes</div>
        <input class="field-input" id="pax-${idx}-special" placeholder="Wheelchair, oxygen, medication, allergies, dietary restrictions...">
      </div>
    </div>`;
}

function switchPaxTab(idx) {
  for (let i = 0; i < manifestPaxCount; i++) {
    const tab = document.getElementById(`ptab-${i}`);
    const form = document.getElementById(`pform-${i}`);
    if (tab) {
      tab.style.borderColor = i === idx ? 'var(--gold2)' : 'var(--border)';
      tab.style.background = i === idx ? 'rgba(229,168,60,0.1)' : 'transparent';
      tab.style.color = i === idx ? 'var(--gold2)' : 'var(--text3)';
    }
    if (form) form.style.display = i === idx ? 'block' : 'none';
  }
  currentPaxTab = idx;
}

function checkIdType(idx) {
  // Could expand later to show/hide passport fields based on selection
}

function closeManifest() {
  document.getElementById('manifest-modal').classList.remove('show');
}

async function submitManifest() {
  // Validate lead passenger at minimum
  const first = document.getElementById('pax-0-first')?.value?.trim();
  const last = document.getElementById('pax-0-last')?.value?.trim();
  const dob = document.getElementById('pax-0-dob')?.value;
  const idNum = document.getElementById('pax-0-id-num')?.value?.trim();

  if (!first || !last || !dob || !idNum) {
    showToast('error', '‚úï', 'Missing required fields', 'Please complete at least the lead passenger details.');
    return;
  }

  const btn = document.getElementById('manifest-submit-btn');
  btn.classList.add('loading');
  btn.textContent = 'Submitting manifest...';

  try {
    // Build manifest data for all passengers
    const passengers = [];
    for (let i = 0; i < manifestPaxCount; i++) {
      passengers.push({
        index: i + 1,
        first_name: document.getElementById(`pax-${i}-first`)?.value?.trim() || '',
        middle_name: document.getElementById(`pax-${i}-middle`)?.value?.trim() || '',
        last_name: document.getElementById(`pax-${i}-last`)?.value?.trim() || '',
        dob: document.getElementById(`pax-${i}-dob`)?.value || '',
        gender: document.getElementById(`pax-${i}-gender`)?.value || '',
        id_type: document.getElementById(`pax-${i}-id-type`)?.value || '',
        id_number: document.getElementById(`pax-${i}-id-num`)?.value?.trim() || '',
        id_state: document.getElementById(`pax-${i}-id-state`)?.value?.trim() || '',
        id_expiry: document.getElementById(`pax-${i}-id-expiry`)?.value || '',
        tsa_precheck: document.getElementById(`pax-${i}-tsa`)?.value?.trim() || '',
        nationality: document.getElementById(`pax-${i}-nationality`)?.value?.trim() || '',
        passport_number: document.getElementById(`pax-${i}-passport`)?.value?.trim() || '',
        passport_country: document.getElementById(`pax-${i}-passport-country`)?.value?.trim() || '',
        passport_expiry: document.getElementById(`pax-${i}-passport-expiry`)?.value || '',
        phone: document.getElementById(`pax-${i}-phone`)?.value?.trim() || '',
        special_requirements: document.getElementById(`pax-${i}-special`)?.value?.trim() || ''
      });
    }

    // Save manifest to bookings table as JSON
    if (manifestBookingId) {
      await sb.update('bookings',
        { passenger_manifest: JSON.stringify(passengers), status: 'manifest_complete' },
        `?id=eq.${manifestBookingId}`
      );
    }

    btn.classList.remove('loading');
    closeManifest();
    showToast('success', '‚úì', 'Manifest submitted', `${manifestPaxCount} passenger${manifestPaxCount > 1 ? 's' : ''} confirmed. Booking complete.`);
    if (currentClient) loadClientRequests(currentClient.id);

  } catch (err) {
    btn.classList.remove('loading');
    btn.innerHTML = '<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M2 8l4 4 8-8"/></svg> Confirm Booking & Submit Manifest';
    showToast('error', '‚úï', 'Could not submit manifest', err.message);
  }
}



// Init
document.addEventListener('DOMContentLoaded', function() {
  // Set OSA signing date
  const sigEl = document.getElementById('sig-date-display');
  if (sigEl) sigEl.textContent = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
  // Add first aircraft card
  addAircraftCard();
  try {
    const sess = auth.load();
    if (sess) {
      try {
        const savedOp = localStorage.getItem('aa_operator');
        if (savedOp) {
          currentOperator = JSON.parse(savedOp);
          loadDashboard(currentOperator);
        }
      } catch(e) {
        localStorage.removeItem('aa_operator');
        auth.clear();
      }
    }
  } catch(e) {
    console.warn('Init error:', e);
  }
})



// ‚ïê‚ïê PILOT ROSTER ‚Äî LIVE DATA ‚ïê‚ïê
async function loadPilotsFromDB() {
  var list = document.getElementById('pilot-roster-list');
  if (!list) return;
  list.innerHTML = '<div style="text-align:center;padding:40px;color:var(--text3);">Loading pilots...</div>';
  try {
    var pilots = await sb.select('pilots', '?verification_status=eq.verified&order=total_hours.desc');
    if (!pilots || pilots.length === 0) {
      // Fall back to demo data if no verified pilots yet
      renderPilotRoster(null);
      return;
    }
    var mapped = pilots.map(function(p) {
      var types = [];
      if (p.type_ratings) {
        try { var tr = typeof p.type_ratings === 'string' ? JSON.parse(p.type_ratings) : p.type_ratings; types = tr.map(function(r){ return r.aircraft || r; }); } catch(e){}
      }
      return {
        id: p.id,
        name: p.first_name + ' ' + p.last_name,
        initials: (p.first_name[0] + p.last_name[0]).toUpperCase(),
        bg: 'rgba(91,163,255,0.12)', fg: '#5BA3FF',
        location: (p.city || '') + (p.country ? ', ' + p.country : ''),
        auth: p.primary_authority + ' ' + (p.certificate_type || 'CPL'),
        pos: p.position || 'PIC',
        avail: p.availability || 'available',
        types: types.length ? types : ['Details on request'],
        hours: p.total_hours || 0,
        picHrs: p.pic_hours || 0,
        rate: p.daily_rate || 0,
        lastFlown: p.updated_at ? 'Recently updated' : '‚Äî',
        pilotId: p.id
      };
    });
    renderPilotRoster(mapped);
  } catch(e) {
    console.warn('loadPilotsFromDB failed, using demo data:', e);
    renderPilotRoster(null);
  }
}

async function submitPilotRequest(pilotId, offerData) {
  if (!currentOperator) return;
  try {
    var rec = {
      operator_id: currentOperator.id,
      pilot_id: pilotId,
      dep_airport: offerData.dep || 'TBD',
      arr_airport: offerData.arr || 'TBD',
      departure_date: offerData.date || new Date().toISOString().split('T')[0],
      days: offerData.days || 1,
      aircraft_type: offerData.aircraft || '',
      offered_rate: offerData.rate,
      status: 'pending'
    };
    await sb.insert('pilot_requests', rec);
    return true;
  } catch(e) {
    console.warn('submitPilotRequest failed:', e);
    return false;
  }
}

// ‚ïê‚ïê PILOT ROSTER ‚ïê‚ïê
var PILOT_DB = [
  { id:'p1', name:'James Whitfield',  initials:'JW', bg:'rgba(91,163,255,0.12)',   fg:'#5BA3FF',  location:'Miami, FL',    auth:'FAA ATP',   pos:'PIC', avail:'available', types:['Gulfstream G550','G650','Challenger 350'], hours:14200, picHrs:8400, rate:850, lastFlown:'G550 - 3 days ago' },
  { id:'p2', name:'Sophia Mueller',   initials:'SM', bg:'rgba(167,139,250,0.12)',  fg:'#A78BFA',  location:'Frankfurt, DE', auth:'EASA ATPL', pos:'PIC', avail:'available', types:['Falcon 7X','Falcon 2000LXS','Phenom 300E'],  hours:9800,  picHrs:5200, rate:780, lastFlown:'Falcon 7X - 1 week ago' },
  { id:'p3', name:'Rajesh Kumar',     initials:'RK', bg:'rgba(229,168,60,0.12)',   fg:'#E5A83C',  location:'Dubai, UAE',    auth:'DGCA/FAA',  pos:'SIC', avail:'open',      types:['Citation CJ4','King Air 350'],               hours:4400,  picHrs:1200, rate:420, lastFlown:'CJ4 - 2 weeks ago' },
  { id:'p4', name:'Amara Okonkwo',    initials:'AO', bg:'rgba(45,212,191,0.12)',   fg:'#2DD4BF',  location:'Sydney, AU',    auth:'CASA ATPL', pos:'PIC', avail:'available', types:['Challenger 350','Global 6000'],              hours:11300, picHrs:7100, rate:920, lastFlown:'Global 6000 - 5 days ago' },
  { id:'p5', name:'Marc Lefebvre',    initials:'ML', bg:'rgba(79,208,128,0.12)',   fg:'#4FD080',  location:'Montreal, CA',  auth:'TC ATP',    pos:'PIC', avail:'available', types:['Phenom 300E','Citation XLS+','King Air 350'],hours:6700,  picHrs:3900, rate:610, lastFlown:'Phenom 300E - Yesterday' },
  { id:'p6', name:'Priya Santos',     initials:'PS', bg:'rgba(255,159,67,0.12)',   fg:'#FF9F43',  location:'Manila, PH',    auth:'CAAP CPL',  pos:'SIC', avail:'open',      types:['King Air 200','ATR 72'],                     hours:2800,  picHrs:400,  rate:280, lastFlown:'ATR 72 - 3 days ago' },
];

function renderPilotRoster(pilots) {
  var list = document.getElementById('pilot-roster-list');
  if (!list) return;
  if (!pilots) pilots = PILOT_DB;
  var avColor = { available: 'var(--green2)', open: 'var(--gold2)', booked: 'var(--text3)' };
  var avLabel = { available: 'Available Now', open: 'Open to Offers', booked: 'Unavailable' };
  var html = '';
  for (var i = 0; i < pilots.length; i++) {
    var p = pilots[i];
    var typeTags = '';
    for (var t = 0; t < p.types.length; t++) {
      typeTags += '<span style="background:rgba(255,255,255,0.04);border:1px solid var(--border2);border-radius:6px;padding:3px 8px;font-size:10px;color:var(--text2);">' + p.types[t] + '</span>';
    }
    html += '<div style="background:var(--card);border:1px solid var(--border2);border-radius:16px;padding:18px;margin-bottom:12px;">' +
      '<div style="display:flex;align-items:flex-start;gap:14px;">' +
        '<div style="width:50px;height:50px;border-radius:14px;background:' + p.bg + ';border:1.5px solid rgba(255,255,255,0.07);display:flex;align-items:center;justify-content:center;font-size:17px;font-weight:700;color:' + p.fg + ';flex-shrink:0;">' + p.initials + '</div>' +
        '<div style="flex:1;min-width:0;">' +
          '<div style="display:flex;align-items:center;gap:7px;margin-bottom:3px;flex-wrap:wrap;">' +
            '<span style="font-size:15px;font-weight:700;color:var(--text);">' + p.name + '</span>' +
            '<span style="font-size:9px;font-weight:800;padding:2px 8px;border-radius:6px;background:rgba(255,255,255,0.05);border:1px solid var(--border2);color:var(--text2);">' + p.auth + '</span>' +
            '<span style="font-size:9px;font-weight:800;padding:2px 8px;border-radius:6px;background:rgba(229,168,60,0.1);border:1px solid rgba(229,168,60,0.25);color:var(--gold2);">' + p.pos + '</span>' +
            '<span style="font-size:9px;font-weight:800;padding:2px 8px;border-radius:6px;color:' + avColor[p.avail] + ';background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);">' + avLabel[p.avail] + '</span>' +
          '</div>' +
          '<div style="font-size:11px;color:var(--text3);margin-bottom:8px;">' + p.location + '  |  Last flown: ' + p.lastFlown + '</div>' +
          '<div style="display:flex;gap:5px;flex-wrap:wrap;margin-bottom:12px;">' + typeTags + '</div>' +
          '<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;">' +
            '<div style="background:var(--bg3);border-radius:9px;padding:9px 10px;text-align:center;"><div style="font-family:monospace;font-size:13px;font-weight:700;">' + p.hours.toLocaleString() + '</div><div style="font-size:9px;color:var(--text3);margin-top:2px;">TOTAL HRS</div></div>' +
            '<div style="background:var(--bg3);border-radius:9px;padding:9px 10px;text-align:center;"><div style="font-family:monospace;font-size:13px;font-weight:700;">' + p.picHrs.toLocaleString() + '</div><div style="font-size:9px;color:var(--text3);margin-top:2px;">PIC HRS</div></div>' +
            '<div style="background:var(--bg3);border-radius:9px;padding:9px 10px;text-align:center;"><div style="font-family:monospace;font-size:13px;font-weight:700;color:var(--gold2);">$' + p.rate + '</div><div style="font-size:9px;color:var(--text3);margin-top:2px;">PER DAY</div></div>' +
            '<div style="background:var(--bg3);border-radius:9px;padding:9px 10px;text-align:center;"><div style="font-family:monospace;font-size:13px;font-weight:700;color:var(--green2);">$' + Math.round(p.rate * 0.95) + '</div><div style="font-size:9px;color:var(--text3);margin-top:2px;">PILOT NET</div></div>' +
          '</div>' +
        '</div>' +
        '<button onclick="openPilotModal(' + "'" + p.id + "'" + ')" style="height:36px;padding:0 14px;border-radius:9px;border:none;background:linear-gradient(135deg,var(--gold),var(--gold2));color:#080D14;font-size:12px;font-weight:800;cursor:pointer;flex-shrink:0;">Request</button>' +
      '</div>' +
    '</div>';
  }
  list.innerHTML = html || '<div style="text-align:center;padding:40px;color:var(--text3);">No pilots match the current filters.</div>';
}

function filterPilots() {
  var tf = (document.getElementById('pilot-filter-type').value || '').toLowerCase();
  var af = document.getElementById('pilot-filter-avail').value;
  var filtered = PILOT_DB.filter(function(p) {
    var tm = !tf || p.types.some(function(t){ return t.toLowerCase().indexOf(tf) >= 0; });
    var am = !af || p.avail === af;
    return tm && am;
  });
  renderPilotRoster(filtered);
}

var _reqPilot = null;
function openPilotModal(pid) {
  _reqPilot = null;
  for (var i = 0; i < PILOT_DB.length; i++) { if (PILOT_DB[i].id === pid) { _reqPilot = PILOT_DB[i]; break; } }
  if (!_reqPilot) return;
  document.getElementById('prm-sub').textContent = _reqPilot.name + '  |  ' + _reqPilot.auth + '  |  ' + _reqPilot.pos;
  document.getElementById('prm-rate').value = _reqPilot.rate;
  updatePilotOffer();
  document.getElementById('pilot-req-modal').style.display = 'flex';
}
function closePilotModal() { document.getElementById('pilot-req-modal').style.display = 'none'; }
function updatePilotOffer() {
  var rate = parseFloat(document.getElementById('prm-rate').value) || 0;
  var days = parseInt(document.getElementById('prm-days').value) || 1;
  document.getElementById('prm-net').textContent = '$' + (rate * 0.95).toFixed(2);
  document.getElementById('prm-total').textContent = '$' + (rate * days).toLocaleString();
  var lbl = 'Total cost (' + days + ' day' + (days > 1 ? 's' : '') + ')';
  document.getElementById('prm-total-strip').children[0].textContent = lbl;
}


</script>
</body>
</html>